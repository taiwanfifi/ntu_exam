# 信號與系統 第八章：應用與綜合

---

## 🔰 本章基礎觀念（零基礎必讀）

### 學了這些工具，能做什麼？

前七章我們學了一整套信號分析的數學工具。本章要回答一個關鍵問題：

> **這些工具在真實世界中怎麼用？**

最重要的三大應用領域：
1. **通訊**：手機、WiFi、廣播如何傳遞信號？（調變與解調）
2. **音訊/影像處理**：等化器、降噪、壓縮怎麼做？（濾波器）
3. **控制系統**：無人機、自駕車如何穩定運作？（回授系統）

本章同時提供**各章公式速查表**和**題型鑑別指南**，方便考前複習。

---

## 關鍵術語表

| 中文 | 英文 | 白話解釋 | 例子 |
|------|------|----------|------|
| 調變 | Modulation | 把低頻信號「搬」到高頻載波上 | 廣播把聲音搬到 FM 頻段 |
| 解調 | Demodulation | 從高頻載波中取出原始信號 | 收音機接收 |
| 載波 | Carrier | 高頻正弦波，用來「搬運」信號 | cos(2π·100MHz·t) |
| AM | Amplitude Modulation | 振幅調變 | AM 廣播 |
| 同步檢波 | Coherent detection | 用相同頻率的載波來解調 | |
| 濾波器 | Filter | 選擇性通過某些頻率的系統 | 等化器的高低音調節 |
| 帶寬 | Bandwidth | 信號或系統佔用的頻率範圍 | |
| 頻分多工 | FDM (Freq. Division Multiplexing) | 不同信號用不同頻段傳輸 | 廣播電台各有頻段 |

---

## 一、調變（Modulation）

### 1.1 為什麼需要調變？

直接傳送低頻信號（如語音 0~4 kHz）有幾個問題：
- **天線太長**：天線長度 ∝ 波長 = c/f。4 kHz 的波長是 75 公里！
- **所有人都在同一頻段**：無法區分不同的廣播電台
- **傳輸效率低**

> **調變的核心思想**：把低頻信號「搬」到不同的高頻上傳送，接收端再「搬回來」。

### 1.2 AM 調變（Amplitude Modulation）

**調變**：

$$y(t) = x(t) \cdot \cos(\omega_c t)$$

x(t) 是要傳送的信號（基帶信號），ωc 是載波頻率。

**頻域效果**（利用頻移性質）：

$$Y(j\omega) = \frac{1}{2}[X(j(\omega - \omega_c)) + X(j(\omega + \omega_c))]$$

> **白話**：乘以 cos(ωct) = 把原頻譜左右各搬一份到 ±ωc 處。

```
原始信號頻譜（基帶）：
        ___
    ___/ X \___
       0

調變後頻譜：
 ___           ___
/ X \___   ___/ X \
   -ωc    0    ωc
```

### 1.3 解調：同步檢波（Coherent Detection）

接收端再乘一次相同的載波：

$$r(t) = y(t) \cdot \cos(\omega_c t) = x(t) \cos^2(\omega_c t)$$

利用 cos²(ωct) = 1/2 + (1/2)cos(2ωct)：

$$r(t) = \frac{1}{2}x(t) + \frac{1}{2}x(t)\cos(2\omega_c t)$$

- 第一項 (1/2)x(t)：原始信號！就在基帶
- 第二項：搬到了 2ωc 的高頻去了

> **用低通濾波器把高頻項濾掉**，就得到 (1/2)x(t)，完成解調！

### 數值例題 1.1：AM 調變

> **問題**：x(t) = cos(2π·1000·t)（1 kHz 音調）以 fc = 100 kHz 的載波做 AM 調變。求調變後信號 y(t) 的頻率成分。

**解答**：

$$y(t) = \cos(2\pi \cdot 1000 \cdot t) \cdot \cos(2\pi \cdot 100000 \cdot t)$$

利用積化和差：

$$= \frac{1}{2}\cos(2\pi \cdot 99000 \cdot t) + \frac{1}{2}\cos(2\pi \cdot 101000 \cdot t)$$

**答：調變後包含 99 kHz 和 101 kHz 兩個頻率分量。**

原本的 1 kHz 被「搬」到了 100 kHz 附近，形成上下邊帶（Upper/Lower Sideband）。

### 1.4 頻分多工（FDM）

多個信號用不同的載波頻率調變，就可以同時在同一個通道傳輸：

```
信號 1 → ×cos(ω₁t) → 佔用 ω₁ 附近
信號 2 → ×cos(ω₂t) → 佔用 ω₂ 附近
信號 3 → ×cos(ω₃t) → 佔用 ω₃ 附近
                        ↓
            全部加起來一起傳
                        ↓
            接收端用帶通濾波器選出各頻段
```

> 這就是廣播電台的原理：每個電台有自己的載波頻率。

---

## 二、濾波器設計概念

### 2.1 常見濾波器類型

| 類型 | 通過 | 阻擋 | 應用 |
|------|------|------|------|
| 低通 (LPF) | 低頻 | 高頻 | 音訊降噪、抗混疊 |
| 高通 (HPF) | 高頻 | 低頻 | 去除直流偏移 |
| 帶通 (BPF) | 中間頻段 | 兩側 | 收音機選台 |
| 帶拒 (BRF/Notch) | 兩側 | 中間頻段 | 去除 60 Hz 電源雜訊 |
| 全通 (APF) | 全部 | 無 | 相位校正 |

### 2.2 理想 vs 實際

理想濾波器（矩形頻率響應）**不可實現**（因為非因果）。

實際濾波器設計需要在以下參數間折衷：
- **通帶波紋**（Passband ripple）：通帶內的不平坦程度
- **阻帶衰減**（Stopband attenuation）：阻帶的抑制能力
- **過渡帶寬度**（Transition bandwidth）：從通帶到阻帶的過渡區域
- **濾波器階數**（Filter order）：越高越接近理想，但越複雜

### 2.3 常見濾波器設計方法

| 類型 | 特點 |
|------|------|
| **Butterworth** | 通帶最平坦，過渡帶較寬 |
| **Chebyshev Type I** | 通帶有波紋，但過渡帶較窄 |
| **Chebyshev Type II** | 阻帶有波紋 |
| **Elliptic (Cauer)** | 通帶和阻帶都有波紋，但過渡帶最窄 |
| **Bessel** | 相位響應最線性（群延遲最平坦）|

### 數值例題 2.1：濾波器頻率響應

> **問題**：一階 RC 低通濾波器的轉移函數為 H(s) = 1/(RCs+1)。若 R = 1 kΩ, C = 1 μF，求 -3dB 截止頻率和 f = 1 kHz 時的增益。

**解答**：

**截止頻率**：ωc = 1/(RC) = 1/(1000 × 10⁻⁶) = 1000 rad/s

fc = ωc/(2π) = **159.15 Hz**

**f = 1 kHz 時**：ω = 2π × 1000 = 6283 rad/s

$$H(j\omega) = \frac{1}{1 + j\omega/\omega_c} = \frac{1}{1 + j6.283}$$

$$|H| = \frac{1}{\sqrt{1 + 6.283^2}} = \frac{1}{\sqrt{40.48}} = 0.157$$

20 log₁₀(0.157) = **-16.1 dB**

> 在截止頻率的 6 倍多處，衰減了約 16 dB。一階濾波器的衰減斜率是 -20 dB/decade。

---

## 三、通訊系統中的信號處理

### 3.1 基本通訊系統架構

```
[訊息源] → [A/D] → [編碼/壓縮] → [調變] → [通道] → [解調] → [解碼] → [D/A] → [接收端]
```

每個環節都用到了信號與系統的概念：
- **A/D 轉換**：取樣定理（第七章）
- **編碼/壓縮**：頻域分析（傅立葉轉換）
- **調變/解調**：頻移、卷積定理（第四章）
- **通道**：LTI 系統模型（第二章）
- **濾波**：頻率響應（第四、五、六章）

### 3.2 通道效應與等化

通道（如電纜、無線電波）可以建模為 LTI 系統 Hc(jω)：

$$Y(j\omega) = H_c(j\omega) \cdot X(j\omega) + N(j\omega)$$

其中 N(jω) 是雜訊。

**等化器（Equalizer）** 的目標：設計 Heq(jω) 使得

$$H_{eq}(j\omega) \cdot H_c(j\omega) \approx 1 \quad \Rightarrow \quad H_{eq}(j\omega) \approx \frac{1}{H_c(j\omega)}$$

> 等化器「反轉」通道的影響，讓整體頻率響應變平坦。

---

## 四、各章公式速查表

### 第一章：信號基本運算

| 公式 | 意義 |
|------|------|
| x(t - t₀) | 時移（t₀>0 右移）|
| x(-t) | 反褶（鏡像）|
| x(at)，\|a\|>1 | 壓縮 |
| δ(t) 取樣性質：∫x(t)δ(t-a)dt = x(a) | |
| u(t) 的微分 = δ(t) | |
| 偶奇分解：xₑ = [x(t)+x(-t)]/2 | |

### 第二章：LTI 與卷積

| 公式 | 意義 |
|------|------|
| y(t) = x(t)*h(t) = ∫x(τ)h(t-τ)dτ | 連續卷積 |
| y[n] = x[n]*h[n] = Σx[k]h[n-k] | 離散卷積 |
| BIBO 穩定：∫\|h(t)\|dt < ∞ | |
| 因果：h(t) = 0 for t < 0 | |
| x(t)*δ(t-a) = x(t-a) | |
| 串聯 h = h₁*h₂，並聯 h = h₁+h₂ | |

### 第三章：傅立葉級數

| 公式 | 意義 |
|------|------|
| x(t) = Σ aₖ e^(jkω₀t) | 合成 |
| aₖ = (1/T) ∫ x(t) e^(-jkω₀t) dt | 分析 |
| 實信號：a₋ₖ = aₖ* | |
| Parseval：P = Σ\|aₖ\|² | |
| ω₀ = 2π/T | 基本角頻率 |

### 第四章：傅立葉轉換

| 公式/性質 | 意義 |
|-----------|------|
| X(jω) = ∫x(t)e^(-jωt)dt | 正轉換 |
| x(t) = (1/2π)∫X(jω)e^(jωt)dω | 反轉換 |
| 時移：x(t-t₀) ↔ X(jω)e^(-jωt₀) | |
| 頻移：x(t)e^(jω₀t) ↔ X(j(ω-ω₀)) | |
| 尺度：x(at) ↔ (1/\|a\|)X(jω/a) | |
| 微分：dx/dt ↔ jωX(jω) | |
| 卷積定理：x*h ↔ X·H | |
| 乘積：x·w ↔ (1/2π)(X*W) | |
| Parseval：∫\|x\|²dt = (1/2π)∫\|X\|²dω | |
| H(jω) = Y(jω)/X(jω) | 頻率響應 |

### 第五章：拉普拉斯轉換

| 公式/性質 | 意義 |
|-----------|------|
| X(s) = ∫x(t)e^(-st)dt | 定義 |
| dx/dt ↔ sX(s) - x(0⁻) | 微分性質 |
| x(t)*h(t) ↔ X(s)H(s) | 卷積 |
| e^(-at)x(t) ↔ X(s+a) | s 域平移 |
| x(0⁺) = lim_{s→∞} sX(s) | 初值定理 |
| x(∞) = lim_{s→0} sX(s) | 終值定理（需檢查條件）|
| 因果且穩定 ↔ 所有極點在左半平面 | |
| H(s) = Y(s)/X(s) | 轉移函數 |
| 回授：H = H₁/(1+H₁H₂) | |

### 第六章：Z 轉換

| 公式/性質 | 意義 |
|-----------|------|
| X(z) = Σ x[n]z⁻ⁿ | 定義 |
| x[n-k] ↔ z⁻ᵏX(z) | 時移 |
| x[n]*h[n] ↔ X(z)H(z) | 卷積 |
| aⁿx[n] ↔ X(z/a) | z 域尺度 |
| 因果且穩定 ↔ 所有極點在單位圓內 | |
| z = e^(jω) 時得到 DTFT | |
| aⁿu[n] ↔ z/(z-a)，\|z\|>\|a\| | 最常用轉換對 |
| δ[n] ↔ 1 | |
| u[n] ↔ z/(z-1)，\|z\|>1 | |

### 第七章：取樣

| 公式 | 意義 |
|------|------|
| fs ≥ 2fmax | 取樣定理 |
| f_alias = \|f - k·fs\| | 混疊頻率 |
| Xₛ(jω) = (1/T)Σ X(j(ω-kωₛ)) | 取樣後頻譜 |
| Δf = fs/N | DFT 頻率解析度 |
| SNR ≈ 6.02B + 1.76 dB | 量化 SNR |

---

## 五、題型鑑別指南：「看到什麼條件用什麼方法」

### 5.1 整體選擇策略

```
問題涉及什麼系統？
├── 連續時間系統
│   ├── 週期信號的頻率分析 → 傅立葉級數（第三章）
│   ├── 非週期信號的頻率分析 → 傅立葉轉換（第四章）
│   ├── 微分方程求解 → 拉普拉斯轉換（第五章）
│   ├── 系統穩定性（極點位置）→ 拉普拉斯轉換（第五章）
│   └── 頻率響應 H(jω) → 傅立葉轉換或拉氏代 s=jω
└── 離散時間系統
    ├── 差分方程求解 → Z 轉換（第六章）
    ├── 系統穩定性（極點位置）→ Z 轉換（第六章）
    ├── DTFT / 頻率響應 → Z 轉換代 z=e^(jω)
    └── 取樣相關問題 → 取樣定理（第七章）
```

### 5.2 詳細題型對照表

| 題目關鍵字/條件 | 使用工具 | 參考章節 |
|----------------|----------|---------|
| 判斷週期性 | 求各分量週期，看比值是否有理 | Ch.1 |
| 偶奇分解 | xₑ = [x(t)+x(-t)]/2 | Ch.1 |
| ∫f(t)δ(t-a)dt | 取樣性質，代 t=a | Ch.1 |
| 判斷線性/時不變/因果/穩定 | 按定義逐一檢驗 | Ch.2 |
| 求卷積 y=x*h（簡單信號）| 圖解法或公式法 | Ch.2 |
| 求卷積（複雜信號）| 轉到 s 域或 z 域用乘法 | Ch.4/5/6 |
| 週期信號的頻譜/功率 | 傅立葉級數 + Parseval | Ch.3 |
| 非週期信號的頻譜 | 傅立葉轉換 | Ch.4 |
| 通過濾波器的輸出 | Y = H·X（頻域相乘）| Ch.4 |
| cos(ωt) 通過 LTI 系統 | 代入 H(jω)：y = \|H\|cos(ωt+∠H) | Ch.4 |
| 解常微分方程 | 拉普拉斯轉換 | Ch.5 |
| 求轉移函數 H(s) | 由微分方程取拉氏，或 Y(s)/X(s) | Ch.5 |
| 判斷 CT 系統穩定性 | 極點在左半平面？ | Ch.5 |
| 反拉氏轉換 | 部分分式展開 + 查表 | Ch.5 |
| 解差分方程 | Z 轉換 | Ch.6 |
| 求 H(z) | 由差分方程取 Z 轉換 | Ch.6 |
| 判斷 DT 系統穩定性 | 極點在單位圓內？ | Ch.6 |
| 反 Z 轉換 | 部分分式 / 長除法 / 留數法 | Ch.6 |
| 最低取樣率 | 奈奎斯特率 2fmax | Ch.7 |
| 混疊頻率 | f_alias = \|f - kfs\| | Ch.7 |
| DFT 計算 | 直接用 DFT 公式 | Ch.7 |
| AM 調變/解調 | 頻移性質 | Ch.8 |

### 5.3 易混淆概念對照

| 概念 A | 概念 B | 關鍵差異 |
|--------|--------|---------|
| 傅立葉級數 | 傅立葉轉換 | 級數→週期信號/離散頻譜；轉換→非週期/連續頻譜 |
| 拉普拉斯轉換 | 傅立葉轉換 | 拉氏是 FT 的推廣，s = σ+jω（σ=0 時相同）|
| 拉普拉斯轉換 | Z 轉換 | 拉氏→連續時間；Z→離散時間 |
| 穩定性(CT) | 穩定性(DT) | CT：極點在左半平面；DT：極點在單位圓內 |
| 因果 | 穩定 | 兩者獨立；可以因果但不穩定，或穩定但不因果 |
| 卷積 | 相關 | 卷積有反褶，相關沒有 |
| 能量信號 | 功率信號 | 能量信號 E<∞ P=0；功率信號 E=∞ 0<P<∞ |

---

## 六、綜合自我檢測（跨章節）

### 問題 1（Ch.1 + Ch.2）
x(t) = e^(-2t)u(t)，h(t) = e^(-3t)u(t)。求 y(t) = x(t)*h(t)，並判斷整體系統是否穩定。

<details>
<summary>點擊查看答案</summary>

**卷積**（因為兩者都因果）：
$$y(t) = \int_0^t e^{-2\tau} e^{-3(t-\tau)} d\tau = e^{-3t}\int_0^t e^{\tau} d\tau = e^{-3t}(e^t - 1) = (e^{-2t} - e^{-3t})u(t)$$

**穩定性**：∫₀^∞ |h(t)| dt = ∫₀^∞ e^{-3t} dt = 1/3 < ∞ → 穩定 ✓

或用轉移函數：H(s) = 1/(s+3)，極點 s=-3 在左半平面 → 穩定 ✓

</details>

### 問題 2（Ch.3 + Ch.4）
方波（基本頻率 100 Hz）通過截止頻率 350 Hz 的理想低通濾波器。輸出包含哪些諧波？

<details>
<summary>點擊查看答案</summary>

方波只有奇次諧波：100 Hz, 300 Hz, 500 Hz, 700 Hz, ...

低通濾波器截止 350 Hz：
- 100 Hz（1次諧波）→ 通過 ✓
- 300 Hz（3次諧波）→ 通過 ✓
- 500 Hz（5次諧波）→ 被擋 ✗

**輸出只包含基頻 100 Hz 和 3 次諧波 300 Hz。**

輸出 ≈ a₁sin(200πt) + a₃sin(600πt)（不再是方波了）

</details>

### 問題 3（Ch.5）
H(s) = 10/((s+1)(s+5))。求單位步階響應 y(t)（即 x(t) = u(t) 時的輸出）。

<details>
<summary>點擊查看答案</summary>

$$Y(s) = H(s) \cdot \frac{1}{s} = \frac{10}{s(s+1)(s+5)}$$

部分分式：
$$\frac{10}{s(s+1)(s+5)} = \frac{A}{s} + \frac{B}{s+1} + \frac{C}{s+5}$$

- s=0: 10 = A(1)(5) → A = 2
- s=-1: 10 = B(-1)(4) → B = -5/2
- s=-5: 10 = C(-5)(-4) → C = 1/2

$$y(t) = \left(2 - \frac{5}{2}e^{-t} + \frac{1}{2}e^{-5t}\right)u(t)$$

**驗證**：
- y(0⁺) = 2 - 5/2 + 1/2 = 0 ✓（步階響應初始值應為 0）
- y(∞) = 2 ✓（終值定理：lim_{s→0} s·Y(s) = 10/5 = 2）

</details>

### 問題 4（Ch.6）
y[n] - 0.5y[n-1] = x[n]，x[n] = (0.8)ⁿu[n]，初始條件 y[-1] = 0。求 y[n]。

<details>
<summary>點擊查看答案</summary>

取 Z 轉換：Y(z) - 0.5z⁻¹Y(z) = X(z)

$$Y(z)(1-0.5z^{-1}) = \frac{z}{z-0.8}$$

$$Y(z) = \frac{z}{(z-0.8)(1-0.5z^{-1})} = \frac{z^2}{(z-0.8)(z-0.5)}$$

Y(z)/z = z/((z-0.8)(z-0.5))

部分分式：
$$\frac{z}{(z-0.8)(z-0.5)} = \frac{A}{z-0.8} + \frac{B}{z-0.5}$$

- z=0.8: 0.8 = A(0.3) → A = 8/3
- z=0.5: 0.5 = B(-0.3) → B = -5/3

$$Y(z) = \frac{8}{3}\cdot\frac{z}{z-0.8} - \frac{5}{3}\cdot\frac{z}{z-0.5}$$

$$y[n] = \left[\frac{8}{3}(0.8)^n - \frac{5}{3}(0.5)^n\right]u[n]$$

**驗證**：y[0] = 8/3 - 5/3 = 1 = x[0] ✓（因為 y[-1]=0）

</details>

### 問題 5（Ch.7 + Ch.8）
語音信號（0~4 kHz）以 8 kHz 取樣後做 AM 調變（載波 1 MHz）。接收端需要什麼頻寬的帶通濾波器？

<details>
<summary>點擊查看答案</summary>

語音信號帶寬 = 4 kHz。

AM 調變後，信號佔用 [fc - 4kHz, fc + 4kHz] = [996 kHz, 1004 kHz]。

所以帶通濾波器需要：
- 中心頻率：1000 kHz = 1 MHz
- 帶寬：2 × 4 kHz = **8 kHz**
- 通帶：996 kHz ~ 1004 kHz

取樣率 8 kHz ≥ 2 × 4 kHz = 8 kHz，恰好滿足奈奎斯特條件（但沒有餘量，實際上需要更高的取樣率或良好的抗混疊濾波器）。

</details>

### 問題 6（綜合判斷）
給定系統 H(s) = (s-1)/((s+2)(s+3))。
(a) 是否因果且穩定？
(b) 畫出極零圖。
(c) 求頻率響應 H(jω) 在 ω=0 的值。
(d) 這是高通還是低通？

<details>
<summary>點擊查看答案</summary>

**(a)** 假設因果 → ROC: Re(s) > -2。極點 s=-2, s=-3 都在左半平面 → **因果且穩定** ✓

**(b)** 極零圖：
- ○ 零點：s = 1（右半平面！）
- × 極點：s = -2, s = -3（左半平面）

**(c)** H(j0) = (0-1)/((0+2)(0+3)) = -1/6

|H(j0)| = 1/6 ≈ 0.167

**(d)** 在 ω→∞ 時：H(jω) ≈ jω/(jω)² = 1/(jω) → 0（也衰減）

在 ω=0 時 |H| = 1/6，但因為有右半平面零點 s=1，這不是標準的低通或高通。

實際上：當 ω 增大時，分子 |jω-1| = √(1+ω²) 增大速率低於分母，所以這更接近低通特性，但有一些特殊行為。

更精確地：|H(jω)| = √(1+ω²)/√((4+ω²)(9+ω²))

ω=0: 1/6 ≈ 0.167
ω=1: √2/√50 ≈ 0.2
ω=10: √101/√(104·109) ≈ 0.094

在 ω ≈ 1 附近有微小的峰值，然後衰減。整體接近**低通**特性。

</details>

### 問題 7（Ch.1 ~ Ch.7 概念）
以下陳述哪些是正確的？

(a) 所有因果系統都是穩定的。
(b) FIR 系統一定是穩定的。
(c) 連續正弦 sin(ω₀t) 一定是週期的。
(d) 離散正弦 sin(ω₀n) 一定是週期的。
(e) 理想低通濾波器是因果的。

<details>
<summary>點擊查看答案</summary>

**(a) 錯。** h(t) = e^(t)u(t) 是因果但不穩定的。

**(b) 對。** FIR 的 h[n] 有限長，Σ|h[n]| 一定有限。

**(c) 對。** 對任何 ω₀，sin(ω₀t) 的週期 T = 2π/ω₀ 都存在（都是正實數）。

**(d) 錯。** 只有 ω₀/(2π) 是有理數時才是週期的。例如 sin(n) 不是週期的（因為 1/(2π) 是無理數）。

**(e) 錯。** 理想低通的脈衝響應是 sinc 函數，在 t<0 也有值 → 非因果 → 不可物理實現。

</details>

---

## 結語

恭喜你完成了「信號與系統」的完整學習！

回顧一下整門課的核心脈絡：

1. **信號** 是資訊的載體，**系統** 是處理信號的工具
2. **LTI 系統** 是最重要的系統類型，完全由 **h(t)** 決定
3. **卷積** 是 LTI 系統的核心運算
4. **傅立葉分析** 讓我們從頻率的角度理解信號和系統
5. **拉普拉斯 / Z 轉換** 把微分 / 差分方程變成代數問題
6. **取樣定理** 架起了連續與離散世界的橋樑

> 掌握這些工具，你就有能力分析和設計各種信號處理系統——從手機通訊到醫學影像，從音訊處理到自動控制。

祝學習順利！
