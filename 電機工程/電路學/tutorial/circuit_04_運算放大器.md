# 第四章：運算放大器（Op-Amp）

> **適用對象**：零基礎大一大二學生
> **先修知識**：第一至三章（歐姆定律、KCL、KVL、戴維寧等效）
> **學習時間**：約 3-4 小時

---

## 🔰 **本章基礎觀念（零基礎必讀）**

想像你在對著一大群人說話，但你的聲音太小了。你需要一個**麥克風 + 擴音器**把聲音放大。

**運算放大器（Operational Amplifier, Op-Amp）** 就是電子世界的擴音器——它可以把微小的電壓訊號放大成幾十倍、幾百倍。

Op-Amp 是類比電路中最重要的元件之一。好消息是：在「理想」假設下，分析 Op-Amp 電路只需要兩個簡單的規則！

### Op-Amp 的長相

Op-Amp 有 5 個端子（但我們通常只畫 3 個）：

```
        Vcc (+電源)
         |
    +  |\|
  v⁺───|+ \
        |   >───── Vout（輸出）
  v⁻───|- /
    -  |/|
         |
        Vee (-電源)
```

- **v⁺**：非反相輸入端（Non-inverting input），標 "+"
- **v⁻**：反相輸入端（Inverting input），標 "-"
- **Vout**：輸出端
- Vcc 和 Vee：電源端（通常省略不畫）

---

## 一、理想 Op-Amp 的兩個黃金假設

### 假設 1：虛短路（Virtual Short）

$$
v^+ = v^-
$$

> 白話說：+端和-端的電壓**幾乎一樣**。（因為增益無窮大，所以輸入電壓差趨近零）

### 假設 2：虛斷路（Virtual Open）

$$
i^+ = i^- = 0
$$

> 白話說：**沒有電流流入** Op-Amp 的輸入端。（因為輸入阻抗無窮大）

### 為什麼這兩個假設成立？

理想 Op-Amp 的參數：
- 開迴路增益 A → ∞
- 輸入阻抗 → ∞
- 輸出阻抗 → 0

因為 Vout = A(v⁺ - v⁻)，而 A → ∞，所以 (v⁺ - v⁻) 必須 → 0，否則 Vout 會爆掉。

因為輸入阻抗 → ∞，所以沒有電流流入。

> 記住這兩條就夠了！接下來所有 Op-Amp 電路分析都是靠它們。

---

## 二、反相放大器（Inverting Amplifier）

### 2.1 電路結構

```
        Rf
  Vin──[R₁]──●──[Rf]──┐
              |         |
              |    |\   |
              └──|-  \  |
                 |    >─┘── Vout
            ┌──|+  /
            |  |/
            ⏚ (接地)
```

- v⁺ 接地 → v⁺ = 0
- 由虛短路：v⁻ = v⁺ = 0（稱為「虛地」, virtual ground）

### 2.2 推導

在 v⁻ 節點列 KCL（虛斷路：Op-Amp 輸入端無電流）：

$$
\frac{V_{in} - v^-}{R_1} + \frac{V_{out} - v^-}{R_f} = 0
$$

因為 v⁻ = 0：

$$
\frac{V_{in}}{R_1} + \frac{V_{out}}{R_f} = 0
$$

$$
\frac{V_{out}}{R_f} = -\frac{V_{in}}{R_1}
$$

$$
\boxed{\frac{V_{out}}{V_{in}} = -\frac{R_f}{R_1}}
$$

### 2.3 特點

- 增益 = -Rf/R₁（**負號代表反相**，輸出和輸入相位相反）
- 輸入阻抗 = R₁（從 Vin 看進去）
- 虛地：v⁻ = 0

### 2.4 數值例題 ①

> **題目**：反相放大器中 R₁ = 10kΩ，Rf = 50kΩ，Vin = 0.2V。求 Vout。

**解答**：

$$
\frac{V_{out}}{V_{in}} = -\frac{R_f}{R_1} = -\frac{50k}{10k} = -5
$$

$$
V_{out} = -5 \times 0.2 = -1 \text{ V}
$$

答：**Vout = -1V**（反相，所以是負值）。

---

## 三、非反相放大器（Non-inverting Amplifier）

### 3.1 電路結構

```
                   Rf
              ┌──[Rf]──┐
              |         |
         |\   |         |
  Vin──|+  \  |         |
       |    >─┘── Vout
  ┌──|-  /
  |  |/
  |
  ├──[R₁]──⏚
```

- v⁺ = Vin
- v⁻ 通過 R₁ 接地，通過 Rf 接到輸出

### 3.2 推導

由虛短路：v⁻ = v⁺ = Vin

v⁻ 點的電壓是 Vout 經由 Rf 和 R₁ 分壓的結果：

$$
v^- = V_{out} \cdot \frac{R_1}{R_1 + R_f}
$$

令 v⁻ = Vin：

$$
V_{in} = V_{out} \cdot \frac{R_1}{R_1 + R_f}
$$

$$
\boxed{\frac{V_{out}}{V_{in}} = 1 + \frac{R_f}{R_1}}
$$

### 3.3 特點

- 增益 = 1 + Rf/R₁（**恆為正**，同相放大）
- 增益最小值是 1（當 Rf = 0 時）
- 輸入阻抗非常高（理想情況為無窮大）

### 3.4 數值例題 ②

> **題目**：非反相放大器中 R₁ = 5kΩ，Rf = 20kΩ，Vin = 0.5V。求 Vout。

**解答**：

$$
\frac{V_{out}}{V_{in}} = 1 + \frac{R_f}{R_1} = 1 + \frac{20k}{5k} = 1 + 4 = 5
$$

$$
V_{out} = 5 \times 0.5 = 2.5 \text{ V}
$$

答：**Vout = 2.5V**（同相，正值）。

---

## 四、電壓隨耦器（Voltage Follower / Buffer）

### 4.1 電路結構

就是非反相放大器的特例：**Rf = 0，R₁ = ∞**（或者說，輸出直接接回 v⁻）

```
         |\
  Vin──|+  \
       |    >──┬── Vout
  ┌──|-  /     |
  |  |/        |
  └────────────┘
```

### 4.2 增益

$$
V_{out} = V_{in} \quad (\text{增益} = 1)
$$

### 4.3 用途

「增益是 1，有什麼用？」

用途在於**阻抗轉換**：
- 輸入阻抗極高（不會吸走前級電路的電流）
- 輸出阻抗極低（可以驅動後級電路）

> 白話比喻：就像一個超強搬運工，他不改變貨物（電壓不變），但能把貨物從很高的地方（高阻抗）搬到很低的地方（低阻抗）。

---

## 五、加法器（Summing Amplifier）

### 5.1 電路結構

反相放大器的延伸，多個輸入各自經過一個電阻連到 v⁻：

```
  V₁──[R₁]──┐
  V₂──[R₂]──●──[Rf]──┐
  V₃──[R₃]──┘         |
                  |\   |
             ┌──|-  \  |
             |  |    >─┘── Vout
             ⏚─|+  /
                |/
```

### 5.2 公式

$$
V_{out} = -R_f \left(\frac{V_1}{R_1} + \frac{V_2}{R_2} + \frac{V_3}{R_3}\right)
$$

若 R₁ = R₂ = R₃ = R：

$$
V_{out} = -\frac{R_f}{R}(V_1 + V_2 + V_3)
$$

### 5.3 數值例題 ③

> **題目**：加法器中 R₁ = R₂ = R₃ = 10kΩ，Rf = 10kΩ，V₁ = 1V，V₂ = 2V，V₃ = 3V。求 Vout。

**解答**：

$$
V_{out} = -\frac{10k}{10k}(1 + 2 + 3) = -1 \times 6 = -6 \text{ V}
$$

答：**Vout = -6V**。

---

## 六、差動放大器（Difference Amplifier）

### 6.1 電路結構

同時有反相和非反相輸入：

```
  V₁──[R₁]──●──[R₂]──┐
             |         |
             |    |\   |
             └──|-  \  |
                |    >─┘── Vout
  V₂──[R₃]──●─|+  /
             |  |/
            [R₄]
             |
             ⏚
```

### 6.2 公式

$$
V_{out} = \frac{R_2}{R_1}\left(V_2 \cdot \frac{R_4(R_1 + R_2)}{R_1(R_3 + R_4)} - V_1\right)
$$

若 R₁ = R₃ 且 R₂ = R₄（最常見的設計）：

$$
\boxed{V_{out} = \frac{R_2}{R_1}(V_2 - V_1)}
$$

### 6.3 數值例題 ④

> **題目**：差動放大器中 R₁ = R₃ = 10kΩ，R₂ = R₄ = 40kΩ，V₁ = 1V，V₂ = 3V。求 Vout。

**解答**：

$$
V_{out} = \frac{R_2}{R_1}(V_2 - V_1) = \frac{40k}{10k}(3 - 1) = 4 \times 2 = 8 \text{ V}
$$

答：**Vout = 8V**。

---

## 七、積分器與微分器

### 7.1 積分器（Integrator）

把反相放大器的 Rf 換成電容 C：

$$
V_{out}(t) = -\frac{1}{R_1 C} \int_0^t V_{in}(\tau) \, d\tau + V_{out}(0)
$$

> 輸出是輸入的**時間積分**（用途：波形整形、三角波產生器）

### 7.2 微分器（Differentiator）

把反相放大器的 R₁ 換成電容 C：

$$
V_{out}(t) = -R_f C \frac{dV_{in}(t)}{dt}
$$

> 輸出是輸入的**時間微分**（用途：邊緣偵測、脈衝產生）

### 7.3 對比整理

| 項目 | 積分器 | 微分器 |
|------|--------|--------|
| 輸入端元件 | R₁ | C |
| 回饋元件 | C | Rf |
| 功能 | 輸出 ∝ ∫Vin dt | 輸出 ∝ dVin/dt |
| 方波輸入 → 輸出 | 三角波 | 脈衝波 |

---

## 八、Op-Amp 電路分析的通用步驟

無論遇到什麼 Op-Amp 電路，都可以用以下步驟：

| 步驟 | 操作 |
|------|------|
| ① | 標出 v⁺ 和 v⁻ |
| ② | 寫下虛短路：v⁺ = v⁻ |
| ③ | 寫下虛斷路：i⁺ = i⁻ = 0 |
| ④ | 在 v⁻（或 v⁺）節點列 KCL |
| ⑤ | 解方程式得到 Vout |

> 這套 SOP 幾乎可以解所有理想 Op-Amp 的題目！

---

## 九、題型鑑別指南

| 電路特徵 | 類型 | 增益公式 |
|----------|------|---------|
| Vin 接 v⁻（透過 R₁）、v⁺ 接地 | 反相放大器 | -Rf/R₁ |
| Vin 接 v⁺、v⁻ 接 R₁ 到地 | 非反相放大器 | 1 + Rf/R₁ |
| 輸出直接接回 v⁻ | 電壓隨耦器 | 1 |
| 多個輸入接 v⁻ | 加法器 | -Rf(V₁/R₁ + V₂/R₂ + ...) |
| 一個輸入接 v⁻、一個接 v⁺ | 差動放大器 | (R₂/R₁)(V₂-V₁) |
| 回饋元件是電容 | 積分器 | -1/(RC)∫ |
| 輸入端元件是電容 | 微分器 | -RC(d/dt) |

---

## 十、關鍵術語表

| 中文 | 英文 | 白話解釋 | 例子 |
|------|------|---------|------|
| 運算放大器 | Operational Amplifier (Op-Amp) | 高增益的電壓放大器 | LM741、TL072 |
| 虛短路 | Virtual Short | v⁺ = v⁻（輸入端電壓相等） | 不是真的短路，只是電壓相同 |
| 虛斷路 | Virtual Open | 無電流流入輸入端 | 不是真的斷路，只是電流極小 |
| 反相放大器 | Inverting Amplifier | 輸出和輸入相位相反 | 增益 = -Rf/R₁ |
| 非反相放大器 | Non-inverting Amplifier | 輸出和輸入同相位 | 增益 = 1 + Rf/R₁ |
| 電壓隨耦器 | Voltage Follower / Buffer | 增益 = 1，做阻抗轉換 | 高阻抗→低阻抗 |
| 加法器 | Summing Amplifier | 將多個輸入電壓加起來 | 音訊混音器 |
| 差動放大器 | Difference Amplifier | 輸出和輸入差成正比 | 感測器訊號處理 |
| 積分器 | Integrator | 輸出 = 輸入的時間積分 | 方波→三角波 |
| 微分器 | Differentiator | 輸出 = 輸入的時間微分 | 邊緣偵測 |
| 開迴路增益 | Open-loop Gain | 沒有回饋時的增益（理想→∞） | 實際約 10⁵~10⁶ |
| 回饋 | Feedback | 把輸出的一部分接回輸入 | 負回饋穩定增益 |

---

## ✅ 自我檢測

### 題目 1
理想 Op-Amp 的兩個基本假設是什麼？

<details>
<summary>點擊查看解答</summary>

1. **虛短路**：v⁺ = v⁻（兩個輸入端電壓相等）
2. **虛斷路**：i⁺ = i⁻ = 0（沒有電流流入輸入端）

這兩個假設來自理想 Op-Amp 的無窮大開迴路增益和無窮大輸入阻抗。

</details>

### 題目 2
反相放大器中 R₁ = 2kΩ，Rf = 16kΩ，Vin = -0.5V。求 Vout。

<details>
<summary>點擊查看解答</summary>

增益 = -Rf/R₁ = -16k/2k = -8

Vout = -8 × (-0.5) = 4V

答：**Vout = 4V**

</details>

### 題目 3
非反相放大器的增益最小可以是多少？能不能設計一個增益為 0.5 的非反相放大器？

<details>
<summary>點擊查看解答</summary>

非反相放大器增益 = 1 + Rf/R₁

因為 Rf 和 R₁ 都是正值，所以 Rf/R₁ ≥ 0

增益最小值 = **1**（當 Rf = 0 時，即電壓隨耦器）

**不能**設計增益為 0.5 的非反相放大器，因為增益永遠 ≥ 1。

如果要衰減（增益 < 1），可以用分壓器或反相放大器（|Rf/R₁| < 1）。

</details>

### 題目 4
加法器中 R₁ = 20kΩ，R₂ = 10kΩ，Rf = 40kΩ，V₁ = 2V，V₂ = -1V。求 Vout。

<details>
<summary>點擊查看解答</summary>

$$V_{out} = -R_f\left(\frac{V_1}{R_1} + \frac{V_2}{R_2}\right) = -40k\left(\frac{2}{20k} + \frac{-1}{10k}\right)$$

$$= -40k\left(\frac{1}{10k} - \frac{1}{10k}\right) = -40k \times 0 = 0 \text{ V}$$

答：**Vout = 0V**

驗算：V₁/R₁ = 2/20k = 0.1mA，V₂/R₂ = -1/10k = -0.1mA，兩者相消。

</details>

---

> **下一章預告**：[第五章：一階電路](circuit_05_一階電路.md) — 進入動態電路的世界，看看電容和電感如何隨時間變化！
