# Vol 3 演算法教學藍圖：薛丁格的愛人（ch161-240）

> **設計原則**：延續 Vol 1-2 的 AB 線融合技術，並升級至「戰時教學」——Vol 1 在日常中教，Vol 2 在陰謀中教，Vol 3 在末日中教。演算法不再只是解題工具，它是生死之間的呼吸、存在與消散之間的繩索、愛與虛無之間的建築材料。
> **核心標準**：拿掉演算法，劇情就塌了。
> **與 Vol 1-2 的銜接**：Vol 1 從線性（Array）到非線性（LL）到效率（BS）；Vol 2 從結構化（Tree）到網絡（Graph）到最佳化（DP）；Vol 3 從末日決策（Greedy）到存在危機（DP 進階）到系統重建（System Design）。
> **教學風格演變**：Vol 1「物理類比」（河流、跑道、對折）→ Vol 2「人生類比」（背包、漣漪、孤島）→ Vol 3「存在類比」（六十秒、透明的手、二進制的家）。米亞的比喻從「解釋世界」進化到「定義存在」。

---

## 壹、六個演算法的 AB 線融合設計

---

### 1. Greedy（貪心演算法）

**出場章節**：ch163, ch164, ch168
**出場次數**：3（引入 → 生死實踐 → 變體回收）

| 出場 | 章節 | 角色 | 內容 |
|------|------|------|------|
| 第一次 | ch163 | 引入 | 米亞計算崩潰擴散速度：每秒三萬節點。六十秒。維倫必須每一秒選擇「當前能搶救的最高價值記憶」|
| 第二次 | ch164 | 生死實踐 | 維倫在修復台上以六十倍速度掃描。新手媽媽、退役軍人、少女初戀、老人亡妻——每秒只能救一個。手比大腦快 |
| 第三次 | ch168 | 變體 | 孕婦案——在搶救回的碎片中用 Greedy 策略找到「最核心的情感錨點」優先修復 |

**A 線概念完整度**：
- 核心教學：每一步選擇當下最優解，不回頭。局部最優 ≠ 全局最優，但時間不夠時局部最優是唯一選項
- 與 DP 的對比：Vol 2 ch149 嚴柏翰有時間慢慢挑「三樣東西」（全局最優）；Vol 3 ch163 維倫只有六十秒（每步最優）。DP 是和平時期的奢侈品，Greedy 是戰時的生存法則
- 概念純度：高。「六十秒」的物理約束讓 Greedy 的「不可回頭」屬性自然成立

**B 線情感場景設計**：
- ch163：維倫面對崩潰前沿閃過的無數記憶——每一段都是一個人的一生。他的手在發抖
- ch164：「不是因為理性。是因為他的手比大腦快。」身體記得的不是演算法，是「來不及」的恐懼
- ch168：孕婦不知道自己懷孕七個月。「這是什麼？」——指著自己的肚子

**AB 線同步點**：
ch164 最後一段：維倫的鼻血流到鍵盤上。米亞統計：40% 搶救成功，60% 永久失去。Greedy 的「每步最優」在這裡等於「每一秒都有人的一生在他指尖消失」。讀者理解的不是「貪心策略」，是「在末日中每一秒都在選擇讓誰活」。

**米亞的比喻**：
「你有六十秒。每一秒只能選一個。不是選最好的——是選**當下來得及**的。這不叫貪心。這叫——你只有六十秒。」

**比喻品質**：★★★★。打破了「貪心」的負面語義，用「來不及」替代「自私」。但不及 Vol 2 的「背包」那樣具有跨場景的普適性。

**與 Vol 1-2 演算法的銜接**：
- Vol 2 DP（ch149）→ Vol 3 Greedy（ch163）= 從「有時間做最優選擇」到「沒時間只能做當下最優選擇」= 從和平到戰爭
- Vol 1 Sliding Window（ch8-9）→ Vol 3 Greedy 也有「掃描」的意象（六十倍速掃描崩潰前沿），但 SW 是「在流動中找模式」，Greedy 是「在流動中搶人」

**教學密度**：高。ch163-164 連續兩章核心教學 + ch168 變體回收。崩潰篇開場即高密度。

---

### 2. Heap / Priority Queue（堆/優先佇列）

**出場章節**：ch165, ch169, ch176-177
**出場次數**：4（引入 → 情感排序 → 系統建立 → 動態維護）

| 出場 | 章節 | 角色 | 內容 |
|------|------|------|------|
| 第一次 | ch165 | 引入 | 米亞將崩潰前沿的記憶碎片按緊急程度和搶救成功率排入優先佇列。頂端永遠是「此刻最值得搶救」的那段 |
| 第二次 | ch169 | 情感排序 | 孕婦案——按「情感連結強度」重新排列碎片。最頂端的不是產檢報告，是第一次感受胎動時手放在肚子上的觸感 |
| 第三次 | ch176 | 系統建立 | 碎片拾荒者案——城市規模的記憶碎片歸還系統，每個碎片按緊急程度和匹配度排入 Heap |
| 第四次 | ch177 | 動態維護 | 持續插入新碎片、彈出最高優先級碎片。男孩母親的記憶排在第 3,721 位。男孩在門口等了一天 |

**A 線概念完整度**：
- 核心教學：動態維護最大/最小值。插入 O(log n)，取出 O(log n)。最高價值永遠在頂端
- 概念層次：ch165 引入結構 → ch169 展示排序標準可以是「情感」→ ch176-177 展示大規模動態系統
- 與 Greedy 的配合：Greedy 決定「每一步選最好的」，Heap 決定「什麼是最好的」。兩者是搶救的左右手

**B 線情感場景設計**：
- ch165：維倫「不看排序理由。只看最上面那一個。然後救它。」——Heap 被信任為比人腦更快的篩選器
- ch169：★ Heap 的頂端不是數據——是觸感。母親摸肚子的那個動作。「身體記得」母題在 Heap 排序中復活
- ch177：★★ 男孩的母親排在第 3,721 位。等待本身成為教學：「你在乎的人不一定排在最前面。但你可以等。」

**AB 線同步點**：
ch169 最後一段：維倫把觸感記憶碎片歸還給孕婦。孕婦看著面前的肚子，伸出手——不是因為記起了什麼，是手「記得」那個弧度。Heap 排到頂端的「最高優先級」= 身體記得的東西。技術排序 = 情感真相。

**米亞的比喻**：
「在末日中排隊。排在最前面的不是最痛苦的——是最有可能被救回的。」
（ch177 補充版）「三千七百二十一。他排在三千七百二十一。但他在門口等著。Heap 不懂等待。人懂。」

**比喻品質**：★★★★。ch165 的第一版清晰但平淡；ch177 的補充版「Heap 不懂等待。人懂。」是 Vol 3 前半的最佳米亞金句之一。

**與 Vol 1-2 演算法的銜接**：
- Vol 1 Array / Two Pointers（排序）→ Vol 3 Heap（動態排序）= 從「排好」到「持續排」
- Vol 2 BFS（ch103「漣漪」向外擴）→ Vol 3 Heap（向上浮）= 方向不同但都是「最重要的先到」
- Vol 2 ch121 米亞投影 123 座島嶼時的排序意象 → Vol 3 ch165 正式引入 Priority Queue

**教學密度**：中高。四次出場分布在 ch165-177 的 13 章中（含其他非演算法章節），平均密度適中。

---

### 3. Trie（前綴樹）

**出場章節**：ch182-184, ch194, ch207
**出場次數**：5（概念引入 → 構建教學 → 搜索結果 → 實戰應用 → 擴展搜尋）

| 出場 | 章節 | 角色 | 內容 |
|------|------|------|------|
| 第一次 | ch182 | 概念引入 | 米亞發現周明哲標記的記憶碎片有共同前綴編碼模式——像字典中所有以「周」字開頭的詞條 |
| 第二次 | ch183 | 構建教學 | 維倫在修復台上構建 Trie。每條路徑 = 一段記憶。萬條路徑在最深處匯聚 = 周明哲的意識核心 |
| 第三次 | ch184 | 搜索結果 | Trie 最深處不是數據——是一封信。「給我的另一個自己。」|
| 第四次 | ch194 | 實戰應用 | 在黑市記憶池中用前綴匹配搜尋「十一月二日＋地下街＋提取時間早於鸚鵡計畫」的記憶 |
| 第五次 | ch207 | 擴展搜尋 | 搜尋更多匹配阿嬤記憶的碎片——擴大前綴條件範圍 |

**A 線概念完整度**：
- 核心教學：前綴匹配。樹狀索引。共同路徑。從根到葉的搜尋
- 概念層次：ch182 概念（「共同前綴」）→ ch183 構建（「每條路徑是一段記憶」）→ ch184 結果（「終端節點藏著秘密」）→ ch194+207 應用（「在海量數據中精準定位」）
- 深度：五次出場讓 Trie 從「抽象數據結構」變成「在百萬人記憶中找一碗三十年前的豆漿」

**B 線情感場景設計**：
- ch182-184：追蹤周明哲的意識碎片 → 找到一封給維倫的信。Trie 的搜索終點不是數據，是父愛
- ch194-195：★★ 搜索結果指向阿嬤的記憶——全城唯一未被篡改的原始版本。「因為沒有人覺得一個賣豆漿的老婦人的記憶有任何價值。」Trie 的「精準定位」= 在所有人忽略的地方找到最重要的東西
- ch207：阿嬤記憶的擴展搜尋。「賣豆漿的女人看到的世界」

**AB 線同步點**：
ch184：Trie 的最深處 = 一封信 = 「給我的另一個自己」。搜索的技術終點 = 情感起點。讀者跟著維倫走完整棵前綴樹，到達的不是數據——是一個父親留給另一個版本自己的信。

ch195（延伸同步）：Trie 在黑市記憶池中定位到 JX-2079-10-28-003 = 阿嬤的記憶包裹。前綴匹配找到的不是情報——是一碗豆漿的重量。

**米亞的比喻**：
「想像所有記憶是一本字典。每個人的名字是一個詞條。前綴樹做的事情是——你只要知道開頭幾個字母，就能找到所有以這幾個字母開頭的詞條。在百萬人的記憶裡找一碗三十年前的豆漿——你需要的不是運氣。是正確的開頭。」

**比喻品質**：★★★★★。「在百萬人的記憶裡找一碗三十年前的豆漿」——這不只是比喻，是場景本身。比喻與劇情完全合一。**Vol 3 最佳米亞比喻候選。**

**與 Vol 1-2 演算法的銜接**：
- Vol 1 HashMap（ch14-15「指紋比對」）→ Vol 3 Trie（前綴匹配）= 從「精確匹配」到「模糊匹配」
- Vol 2 Graph（ch125「記憶考古」）→ Vol 3 Trie（ch194「黑市記憶搜尋」）= 從「在碎片中拼湊」到「在海量中定位」
- Vol 2 精修時需植入的種子：ch125 米亞提到「如果這些碎片有共同的前綴——同一個時間、同一個地點——我們可以用樹狀索引加速搜尋」

**教學密度**：中。五次出場分布在 ch182-207 的 26 章中，間距大，讀者有充分消化時間。

---

### 4. DP 進階（1D/2D 多維動態規劃）

**出場章節**：ch189, ch190, ch191
**出場次數**：3（問題定義 → 狀態轉移方程 → 分析結果）

| 出場 | 章節 | 角色 | 內容 |
|------|------|------|------|
| 第一次 | ch189 | 問題定義 | 維倫對自己使用修復台——他需要判斷每段記憶是「原生」還是「植入」。記憶形成依賴鏈 |
| 第二次 | ch190 | 狀態轉移方程 | 米亞的規則：如果上游依賴都是原生的，它就是原生的；如果上游有植入，它就被「汙染」了 |
| 第三次 | ch191 | 分析結果 | 57% 植入，43% 原生。原生記憶中——遇見語青之後的記憶占比最高。「原生的部分有她在。」|

**A 線概念完整度**：
- 核心教學：多維度最優子問題。狀態轉移方程。每段記憶的「真偽狀態」由其依賴鏈遞推決定
- 與 Vol 2 DP 的升級：Vol 2 是 0/1 Knapsack（二選一：保留或放棄）；Vol 3 是依賴鏈分析（每個狀態由前序狀態遞推而來）= 從一維選擇到多維狀態傳播
- 概念純度：極高。「記憶依賴鏈」是 DP 狀態轉移的完美現實映射——如果你五歲學鋼琴的記憶是植入的，那十歲參加比賽的記憶雖然「真的發生了」，但它的存在基於一個人為的起點

**B 線情感場景設計**：
- ch189：維倫躺在修復台上，掃描自己——他是全書第一個「把自己當委託人」的人
- ch190：狀態轉移方程在他的記憶中展開。每一段記憶旁邊亮起紅色（植入）或藍色（原生）。紅色像潮水一樣蔓延
- ch191：★★★★★ 「如果你 57% 是被製造的，那 43% 的你是什麼？」——「原生的部分有她在。」全書最溫柔的數據分析結果

**AB 線同步點**：
ch191：DP 分析結果 = 43% 原生記憶。技術結論 = 存在主義的回答。「57% 是植入的」是演算法的輸出；「原生的部分有她在」是維倫的解讀。同一組數據，技術層說「你大半是假的」，情感層說「真的部分全是她」。讀者在這裡學到的不是 DP——是「數據只是數據，意義由你賦予」。

**米亞的比喻**：
「每一段記憶都有上游。上游是原生的，它就是原生的。上游是植入的，它就帶著那個印記——不一定是假的，但它的根不是你自己種的。」
（ch191 追加）「43%。聽起來不多。但維倫——你那 43% 裡面有她。有阿嬤的豆漿。有我。我覺得這個比例已經很奢侈了。」

**比喻品質**：★★★★。「上游」的水流意象延續了 Vol 1 Sliding Window 的河流傳統。ch191 追加的那段帶有米亞獨特的「用數據表達溫柔」風格。

**與 Vol 1-2 演算法的銜接**：
- Vol 2 DP / Knapsack（ch149「三樣東西」）→ Vol 3 DP 進階（ch189-191「57% vs 43%」）= 從「選擇保留什麼」到「辨認什麼是真的」= 自然的複雜度提升
- Vol 1 Binary Search（ch35 茉莉花）→ Vol 3 DP（ch191「原生記憶」）= 兩者都是「在大量數據中找到真正重要的東西」，但 BS 是搜尋，DP 是分析
- **跨卷呼應**：Vol 2 ch149 嚴柏翰在記憶中選擇保留三樣 = 背包問題的「取捨」；Vol 3 ch191 維倫發現 43% 原生記憶 = DP 的「判斷」。Vol 2 問「你要帶走什麼」，Vol 3 問「什麼是真正屬於你的」

**教學密度**：高。三章連續 DP 教學（ch189-191），但前後有 ch186-188 的身世核彈緩衝（零演算法情感段）和 ch192-193 的情感消化期，形成「衝擊→分析→消化」的三段式呼吸。

---

### 5. Backtracking 進階（帶剪枝的回溯 + 約束傳播）

**出場章節**：ch215, ch216
**出場次數**：2（系統性搜索 → 狀態記憶化 + 剪枝）

| 出場 | 章節 | 角色 | 內容 |
|------|------|------|------|
| 第一次 | ch215 | 系統性搜索 | 語青意識碎片化。維倫用 Backtracking 在崩潰後的記憶空間中追蹤每一個碎片。碰到死路標記後回退 |
| 第二次 | ch216 | 狀態記憶化 + 剪枝 | 記住已收集的碎片位置，避免重複。每個碎片帶著語青的一小段意識：喝咖啡的習慣、星星偏了零點三度、第一次握手時手心的溫度 |

**A 線概念完整度**：
- 核心教學：帶剪枝的回溯——不只是「碰壁回退」，而是「預判哪些路不值得走」。約束傳播——每收集一個碎片，剩餘碎片的位置約束更新
- 與 Vol 2 Backtracking 的升級：Vol 2 ch115-117 是「走迷宮」（碰壁回退）；Vol 2 ch150-151 是「剝記憶」（逐層回退到原始版本）；Vol 3 是「追碎片」（在三維空間中追蹤閃爍消散的意識碎片）= 從「靜態回溯」到「動態追蹤」
- 情感驅動的剪枝：某些路徑的「剪枝」不是因為技術判斷無效，而是因為「追過去會觸發更多碎裂」——這讓剪枝有了道德維度

**B 線情感場景設計**：
- ch215：語青的存在在記憶網路中閃爍——這一秒在這裡，下一秒在那裡，有時同時在三個地方，有時哪裡都不在。維倫在黑暗中追光點
- ch216：★★★★★ 每一個碎片帶著語青的一小段意識。維倫收集的不是數據——是她的碎片化的「存在」。「一個都不想放棄」= Backtracking 的「窮舉所有路徑」的情感版

**AB 線同步點**：
ch216 中段：維倫在追蹤語青碎片時體力耗盡——但他的手在發燙。每一個碎片都是語青的一部分：一個記得他喝咖啡的習慣，一個記得星星偏了零點三度。Backtracking 的「不放棄任何一條路」= 他不願放棄語青的任何一部分。讀者在這裡理解 Backtracking 不是因為「效率」，是因為「愛不允許剪枝」。

**米亞的比喻**：
「Vol 2 的 Backtracking 是走迷宮——碰壁就退，試另一條。Vol 3 不一樣。這不是迷宮。這是一個人在碎裂。你追的不是路——是她。每一個碎片都是她的一部分。你不能『剪枝』掉任何一個。因為被你剪掉的那個碎片，可能記得你們第一次牽手。」

**比喻品質**：★★★★★。直接回收了 Vol 2 的比喻並升級。「你不能剪枝掉任何一個，因為被你剪掉的可能記得你們第一次牽手」——這句話讓「剪枝」這個抽象概念變成了讀者的心碎。**Vol 3 最佳米亞比喻候選之二。**

**與 Vol 1-2 演算法的銜接**：
- Vol 1 Stack（ch19-20「逐層剝開」）→ Vol 2 Backtracking（ch115-117「系統性剝開」+ ch150-151「記憶恢復」）→ Vol 3 Backtracking 進階（ch215-216「追蹤碎裂中的存在」）= 三卷三級升：被動剝→主動探→愛的追逐
- Vol 2 ch150-151 嚴柏翰記憶恢復 → Vol 3 ch215-216 語青意識搶救 = 對象從「他人」變成「愛人」，情感層級翻倍

**教學密度**：中低。只有 2 章，但密度極高——每一章都同時承載教學和全書最高情感強度。少即是多。

---

### 6. System Design（系統設計預演）

**出場章節**：ch220, ch221, ch224, ch225, ch230, ch234
**出場次數**：6（概念引入 → 分片/複製 → 一致性 → 容錯 → 負載平衡 → 上線實踐）

| 出場 | 章節 | 角色 | 內容 |
|------|------|------|------|
| 第一次 | ch220 | 概念引入 | 「我要為她建一座房子。」分散式安全堡壘的構想。米亞：「你說的是分散式架構？」維倫：「我說的是——家。」|
| 第二次 | ch221 | 分片/複製 | 語青的意識分成多個獨立可存活碎片（Sharding）。每碎片至少三個副本分散在不同節點（Replication）|
| 第三次 | ch224 | 一致性 | 分散的碎片之間保持一致性——輕量級共識協議，多數節點達成一致即可 |
| 第四次 | ch225 | 容錯 | 三分之一節點同時失效仍能運作。47 種故障場景通過 44 種 |
| 第五次 | ch230 | 負載平衡 | 語青的意識量需要 2,400 個節點同時承載，每個節點不超過 0.05% 負荷 |
| 第六次 | ch234 | 上線實踐 | 堡壘上線。碎片收集、分類、分片、複製、分散儲存。語青從透明凝聚回半實體 |

**A 線概念完整度**：
- 核心教學：分散式系統設計的五大支柱——分片、複製、一致性、容錯、負載平衡
- 概念層次：每一章教一個支柱，ch234 將五個支柱統一為一個運行的系統。讀者在 6 章中完整走過「系統設計從構想到上線」的全流程
- 與 Vol 4 的銜接：Vol 3 是「為一個人建堡壘」（個人級系統設計），Vol 4 是「為六百萬人建選項 C」（城市級系統設計）。Vol 3 是預演，Vol 4 是正式演出

**B 線情感場景設計**：
- ch220：★★★★★ 「用二進制造一個家」——全卷最核心的情感意象。維倫不是在「設計系統」，他是在「為愛人建造一個存在的場所」
- ch221-225：每一個技術決策都有情感動機。分片 = 「讓她不依賴單一節點」= 「讓她不因為一個地方被毀就消失」。容錯 = 「讓任何三分之一的世界崩塌她都還在」
- ch226：★ 維倫徹夜寫程式碼。語青看著他的背影。鍵盤聲和咖啡機嗡鳴。全書最安靜最浪漫的段落
- ch234：★★★★ 語青從透明凝聚回半實體。「像夜空中被風吹散又重新聚攏的螢火蟲」

**AB 線同步點**：
ch220：「分散式架構」= 「家」。這是全書最簡單也最有力的 AB 線同步——技術名詞和情感名詞在同一句台詞中合一。讀者從此刻起看到的所有分散式系統概念，都會自動翻譯為「他在為她造家」。

ch234：堡壘上線 = 語青重新凝聚。系統的每一個組件（分片、複製、容錯、一致性、負載平衡）在這一刻同時生效 = 她的存在在這一刻被「工程化地拯救」。技術方案 = 愛的表達方式。

**米亞的比喻**：
「你說的是分散式架構。語青的意識分散在多個節點上——只要節點還在，她就在。」
（ch231 追加）「維倫。她會活下來的。」「我知道。」「不。你不知道。你只是相信。但有時候相信比知道更有力量。這是我從你身上學到的。」

**比喻品質**：★★★★。System Design 的比喻不需要「翻譯」——因為場景本身就是最好的解釋。「為一個人建一座分散式的家」不是比喻，是事實。米亞在 ch231 的「相信比知道更有力量」則是超越技術層面的哲學升華。

**與 Vol 1-2 演算法的銜接**：
- Vol 2 Graph / CC（ch120-121「網絡碎裂」）→ Vol 3 System Design（ch220-234「重建網絡」）= 從「分析碎裂」到「設計重建」
- Vol 1 ch56 分散式意識概念 → Vol 2 ch120 碎裂 → Vol 3 ch220 重建 = 三卷貫穿的「分散式」母題
- Vol 2 Union-Find（ch131-132「所有線索歸併到同一個人」）→ Vol 3 System Design（ch221「把一個人分散到所有節點」）= 方向相反但邏輯互補：UF 是收束，SD 是散開

**教學密度**：中高。6 次出場分布在 ch220-234 的 15 章中，但中間穿插大量零演算法情感段（ch222-223 嚴柏翰/邱韻如、ch226-229 浪漫與回憶），節奏呼吸良好。

---

## 貳、AB 線品質排名

| 排名 | 演算法 | 品質 | 核心理由 | 最佳章節 |
|------|--------|------|---------|---------|
| 1 | System Design | ★★★★★ | 「用二進制造一個家」= 全卷最核心意象。技術方案 = 愛的表達。拿掉 SD，堡壘篇不存在 | ch220（「家」）+ ch234（上線）|
| 2 | DP 進階 | ★★★★★ | 「57% 植入，43% 原生，原生的部分有她在」= 全書最溫柔的數據分析。拿掉 DP，身世炸彈失去量化衝擊力 | ch191 |
| 3 | Backtracking 進階 | ★★★★★ | 「一個都不想放棄」= 愛驅動的窮舉搜索。拿掉 BT，語青的搶救變成空洞的「努力」而非「系統性追逐」| ch216 |
| 4 | Trie | ★★★★ | 「在百萬人的記憶裡找一碗三十年前的豆漿」= 場景與比喻完全合一。連接阿嬤弧線高潮 | ch195 |
| 5 | Heap / PQ | ★★★★ | 「Heap 不懂等待。人懂。」= 末日中的排隊哲學。四次遞進使用展示「同一結構的不同溫度」| ch169 + ch177 |
| 6 | Greedy | ★★★★ | 「不是最好的——是當下來得及的」= 戰時決策的核心。但概念相對直觀，AB 線同步的深度不及前五 | ch164 |

**與 Vol 2 的品質對比**：

| 維度 | Vol 2 | Vol 3 |
|------|-------|-------|
| 最高品質 | DP / Knapsack ★★★★★（ch149 三樣東西）| System Design ★★★★★（ch220 用二進制造一個家）|
| ★★★★★ 數量 | 3（DP + UF + Graph）| 3（SD + DP進階 + BT進階）|
| ★★★★ 數量 | 4（BFS + Tree + BT + TopSort）| 3（Trie + Heap + Greedy）|
| ★★★ 數量 | 2（DFS + Dijkstra）| 0 |
| 整體 | 平均 ★★★★ | 平均 ★★★★+ |

**結論**：Vol 3 的 AB 線融合品質整體略勝 Vol 2。沒有任何演算法低於 ★★★★，因為 Vol 3 的演算法數量較少（6 vs 9），每個都有更充分的情感場景承載。三個 ★★★★★ 中，System Design 的「家」意象有潛力超越 Vol 2 的 DP 背包——因為它不是一個場景，而是整篇（ch220-234）的基調。

---

## 參、教學密度分布

### 四篇各自的演算法密度

#### 崩潰篇（ch161-180）：演算法密度 ★★★★★

| 章節範圍 | 演算法 | 出場次數 | 密度評估 |
|---------|--------|---------|---------|
| ch161-162 | 無 | 0 | 正確。末日引爆不需要教學 |
| ch163-165 | Greedy(2), Heap(1) | 3 | **高密度紅區**。三章連續三個演算法出場 |
| ch166-167 | 無 | 0 | 喘息。空白城市的衝擊 |
| ch168-169 | Greedy(1), Heap(1) | 2 | 中。孕婦案的教學段 |
| ch170-175 | 無 | 0 | 情感段 + 邱韻如出場 |
| ch176-177 | Heap(2) | 2 | 中。碎片拾荒者案 |
| ch178-180 | 無 | 0 | 情感核彈。米亞恐懼。M.C. 確認 |

**問題**：ch163-165 是 Vol 3 演算法密度最高的三章——Greedy 兩章 + Heap 一章連續登場。讀者剛進入末日場景，注意力被崩潰吸引，能否同時消化兩個新演算法？
**解決**：可以。因為 Greedy 和 Heap 在這裡不是「教學」——是「搶救工具」。讀者的 100% 注意力在「救不救得到」，不在「這是什麼演算法」。概念內化是自然的：你在末日中跟維倫一起選擇該救誰，你就已經學會了 Greedy。

#### 溯源篇（ch181-200）：演算法密度 ★★★

| 章節範圍 | 演算法 | 出場次數 | 密度評估 |
|---------|--------|---------|---------|
| ch181 | 無 | 0 | 追蹤 M.C. |
| ch182-184 | Trie(3) | 3 | 中高。前綴樹集中教學 |
| ch185-188 | 無 | 0 | **正確的零密度**。身世核彈 + 情感消化 |
| ch189-191 | DP(3) | 3 | **核心教學段**。57% vs 43% |
| ch192-193 | 無 | 0 | 情感消化。偏移率 89% |
| ch194 | Trie(1) | 1 | 輕觸回收 |
| ch195-200 | 無 | 0 | ★★★★★ 全書最重要的喘息期。阿嬤弧線高潮 |

**評估**：溯源篇的密度設計最為精妙。Trie（ch182-184）和 DP（ch189-191）各占三章，中間隔著四章零演算法的身世核彈（ch185-188），後面跟著七章的全書最安靜段（ch194-200，其中 ch194 只有一次 Trie 輕觸）。讀者有充分的呼吸空間。

#### 薛丁格篇（ch201-220）：演算法密度 ★★

| 章節範圍 | 演算法 | 出場次數 | 密度評估 |
|---------|--------|---------|---------|
| ch201-206 | 無 | 0 | 嚴柏翰對峙 + 語青透明化 |
| ch207 | Trie(1) | 1 | 輕觸。阿嬤記憶擴展搜尋 |
| ch208-214 | 無 | 0 | ★ 全書最高情感強度連續段。零演算法 |
| ch215-216 | BT(2) | 2 | 核心教學 + 情感高峰 |
| ch217-220 | SD(1) | 1 | ch220 概念引入 |

**評估**：薛丁格篇是全卷演算法密度最低的篇章——20 章只有 4 次出場。這是正確的設計：ch201-214 承載全書最高情感強度（透明化→遞迴殘留揭露→刪除我吧→不），不能被技術細節干擾。ch215-216 的 Backtracking 和 ch220 的 System Design 引入分別在情感段的尾部和轉折處，讀者已經從最高峰下來，正好接受新的概念。

#### 堡壘篇（ch221-240）：演算法密度 ★★★★

| 章節範圍 | 演算法 | 出場次數 | 密度評估 |
|---------|--------|---------|---------|
| ch221 | SD(1) | 1 | 分片/複製 |
| ch222-223 | 無 | 0 | 嚴柏翰 + 邱韻如各自歸位 |
| ch224-225 | SD(2) | 2 | 一致性 + 容錯 |
| ch226-229 | 無 | 0 | ★ 全書最浪漫段 + 兩碗豆漿 |
| ch230 | SD(1) | 1 | 負載平衡 |
| ch231-233 | 無 | 0 | 上線前夜。最後的浪漫 |
| ch234 | SD(1) | 1 | 堡壘上線 |
| ch235-240 | 無 | 0 | 情感收尾 + 銜接 Vol 4 |

**評估**：堡壘篇的 System Design 五次出場（ch221, ch224, ch225, ch230, ch234）均勻分布在 20 章中，中間穿插大量零演算法段（情感、浪漫、角色歸位）。這是 System Design 教學的理想節奏——每次只教一個概念（分片→一致性→容錯→負載平衡→上線），讀者有時間消化。

### 教學密度分布 ASCII 圖

```
章節     161────170────180────190────200────210────220────230────240
演算法   ░░██████░░██░░░░██░░░████░░░████░░░░░░░░░░░░█░░░░░░░░██░░██░░░░█░░░░░░░░█░░░░░░
情感     ██░░░░░░██░░████████░░░░████░░░░████████████████████░░██░░░░██████░░████░░██████
         ╰末日╯╰搶救╯╰空白╯╰MC╯╰Trie╯╰核彈╯╰DP╯╰喘息期╯╰薛丁格╯╰BT╯╰SD╯╰浪漫╯╰上線╯╰Vol4╯

█ = 演算法出場    ░ = 零演算法
```

### 高密度紅區識別

| 紅區 | 章節 | 內容 | 風險 | 緩解策略 |
|------|------|------|------|---------|
| **紅區 1** | ch163-165 | Greedy(2) + Heap(1) 連續三章 | 認知過載 | 末日搶救的緊張感掩蓋教學感。讀者注意力在「救人」不在「學習」|
| **紅區 2** | ch189-191 | DP(3) 連續三章 | 教學集中 | 前有 ch185-188 身世核彈緩衝，後有 ch192-200 七章喘息。三章 DP 被包裹在情感段中間 |

### 喘息谷識別

| 喘息谷 | 章節 | 長度 | 功能 |
|--------|------|------|------|
| **谷 1** | ch170-175 | 6 章 | 偏移率 78% → 語青的暗示 → 嚴柏翰追蹤 → 邱韻如出場。情感驅動 |
| **谷 2** | ch185-188 | 4 章 | ★ 身世核彈引爆 + 情感消化。「觀測用備份」揭露 |
| **谷 3** | ch195-200 | 6 章 | ★★★★★ 全書最重要的喘息。阿嬤弧線高潮。全書最安靜最有重量的段落 |
| **谷 4** | ch201-214 | 14 章 | 全書最高情感強度連續段。嚴柏翰對峙 → 透明化 → 遞迴殘留 → 刪除我吧 → 不 |
| **谷 5** | ch226-229 | 4 章 | 全書最浪漫的段落。鍵盤聲 + 兩碗豆漿 + 紙鶴 |

---

## 肆、委託案 × 演算法交叉矩陣

|  | Greedy | Heap | Trie | DP進階 | BT進階 | SD |
|--|--------|------|------|--------|--------|-----|
| #18 六十秒的選擇（ch168-172）| ★★ | ★★ | | | | |
| #19 碎片拾荒者（ch176-178）| | ★★ | | | | |
| #20 鏡中的陌生人（ch189-193）| | | | ★★★ | | |
| #21 遊行的安靜版本（ch207-210）| | | ★★ | | | |
| #22 她不在任何地方（ch214-218）| | | | | ★★★ | |
| 堡壘建造（ch220-234，非委託案）| | | | | | ★★★ |

（★ = 輕觸；★★ = 核心教學；★★★ = AB 線融合最佳場景）

**觀察**：
- 委託案 #20（鏡中的陌生人）和 #22（她不在任何地方）是 Vol 3 AB 線融合密度最高的案子，各自承載一個 ★★★★★ 演算法
- 堡壘建造不是傳統「委託案」，但它是全卷最長的連續技術段，System Design 在其中完成了「從構想到上線」的全流程
- Greedy 和 Heap 共用委託案 #18 = 搶救的左右手。Trie 跨越 ch182-207 = 搜尋的長線。DP 和 BT 各自獨占一個委託案 = 每個都有充分的情感空間

---

## 伍、Vol 2 → Vol 3 銜接策略完整對照表

### 一、演算法概念銜接

| Vol 2 演算法 | Vol 3 演算法 | 銜接邏輯 | 銜接品質 |
|-------------|-------------|---------|---------|
| DP / Knapsack（ch149 三樣東西）| Greedy（ch163 六十秒）| 全局最優 → 每步最優 = 從和平到戰爭 | ★★★★★ |
| DP / Knapsack（ch149）| DP 進階（ch189-191）| 0/1 背包 → 多維依賴鏈 = 自然複雜度提升 | ★★★★★ |
| BFS（ch103 漣漪）| Heap（ch165 搶救佇列）| 橫向擴散 → 垂直排序。BFS 找碎片，Heap 排優先級 | ★★★★ |
| Graph / CC（ch120-121 碎裂）| System Design（ch220-234 重建）| 碎裂 → 重建。從分析到工程 | ★★★★★ |
| Backtracking（ch150-151 記憶恢復）| BT 進階（ch215-216 意識搶救）| 恢復他人記憶 → 拯救愛人存在 = 情感翻倍 | ★★★★ |
| Union-Find（ch132 歸併到根）| System Design（ch221 分散到節點）| 收束 → 散開。方向相反但邏輯互補 | ★★★★ |
| HashMap（Vol 1 精確匹配）| Trie（前綴匹配）| 一對一比對 → 前綴模糊搜尋 | ★★★ |

### 二、教學風格銜接

| 維度 | Vol 1 | Vol 2 | Vol 3 |
|------|-------|-------|-------|
| 比喻風格 | 物理類比（河流、跑道、對折）| 人生類比（背包、漣漪、孤島）| 存在類比（六十秒、透明的手、二進制的家）|
| 教學基調 | 好奇心驅動（「原來如此」）| 恐懼/真相驅動（「所以這就是真相」）| 生死/愛驅動（「不能失去她」）|
| 讀者角色 | 旁觀者（看維倫修記憶）| 共謀者（跟維倫追真相）| 同行者（跟維倫一起救人）|
| 演算法定位 | 修復工具 | 解謎武器 | 生存繩索 / 愛的建材 |

### 三、米亞比喻風格演變

| Vol 1 | Vol 2 | Vol 3 | 演變方向 |
|-------|-------|-------|---------|
| 「河流＋漁網」（SW）| 「撒網。漣漪。」（BFS）| 「排在最前面的不是最痛苦的——是最有可能被救回的」（Heap）| 水 → 網 → 隊列：從自然到人造 |
| 「跑道上的兩個人」（LL）| 「走迷宮的規則」（BT）| 「你追的不是路——是她」（BT 進階）| 競賽 → 探索 → 追逐：從遊戲到生死 |
| 「對折再對折」（BS）| 「背包只有這麼大」（DP）| 「原生的部分有她在」（DP 進階）| 操作 → 選擇 → 定義：從動作到意義 |
| 無 | 「人是點，記憶是線」（Graph）| 「你說的是分散式架構？——我說的是家。」（SD）| 結構 → 建築：從分析到建造 |

### 四、需要在 Vol 2 精修時植入的 Vol 3 種子

| 種子 | 建議植入章節 | 內容 | 優先級 |
|------|-----------|------|--------|
| Greedy 萌芽 | ch92（深潛後遺症）| 米亞：「如果記憶碎片持續增加，我們可能得用最快的方式做選擇——不是最好的，是當下最好的」| P1 |
| Heap 萌芽 | ch121（123 座島）| 米亞在排列 123 個島嶼時自動按「崩潰程度」排序，最嚴重的浮到最上面。「這叫優先佇列。」一句帶過 | P1 |
| Trie 萌芽 | ch125（記憶考古）| 維倫在碎片中搜尋時，米亞提到「如果這些碎片有共同的前綴——同一個時間、同一個地點——我們可以用樹狀索引加速搜尋」| P2 |
| System Design 萌芽 | ch56（Vol 1 分散式意識）+ ch120（Vol 2 碎裂）| 已有自然鋪墊，無需額外植入 | -- |

---

## 陸、Vol 3 → Vol 4 的演算法種子需求

### Vol 4 預計新演算法

| # | 演算法 | Vol 4 場景 | 需要的前置概念 |
|---|--------|-----------|-------------|
| 1 | Sorting（Quick / Merge / Heap Sort）| ch243-247 集體潛意識海洋中分類記憶碎片 | 「排序」概念（Vol 1 Array 已有）+ Heap 結構（Vol 3 已教）|
| 2 | Bit Manipulation | ch261-263 去中心化記憶協議的最底層——0/1 加密、位元遮罩、XOR | 「最小單位」概念。二進制思維 |
| 3 | System Design（完整展開）| ch253-256 架構戰爭 + ch265-268 選項 C 的全架構 | Vol 3 堡壘篇已完成預演（分片、複製、容錯、一致性、負載平衡）|

### 在 Vol 3 需要植入的種子

| 種子 | 建議植入章節 | 植入方式 | 優先級 |
|------|-----------|---------|--------|
| **Sorting 萌芽** | ch165（搶救佇列）| 米亞在 Heap 排序時提到：「如果有更多時間，我會先把所有碎片完整排好再挑——但現在只夠用 Heap 浮出最高優先級的。」暗示「完整排序」是 Heap 的升級版 | P2 |
| **Bit Manipulation 萌芽** | ch226（維倫徹夜寫程式碼）| 在堡壘的加密層設計中，維倫提到：「最底層的加密用二進制遮罩——0 是隱藏，1 是可見。最簡單的東西往往最難被破解。」一句帶過，不展開 | P1 |
| **System Design 銜接** | ch234（堡壘上線）| 米亞的上線報告中提到：「這個架構適用於一個人。如果要擴展到全城……需要重新設計。」直接為 Vol 4 的「選項 C」留口 | P1 |
| **蜂巢意識暗線** | ch180（M.C. 簽名）| 周明哲的註解 `// 這一次，做對了` 暗示他在引導崩潰的方向——但為什麼？Vol 3 不回答。留給 Vol 4 ch252 揭露「蜂巢意識」是他重寫記憶的另一個原因 | P2 |
| **集體潛意識暗示** | ch167（空白的城市）| 300 萬人同時失去記憶後，城市出現短暫的「同步行為」——數千人不約而同走向同一個方向。米亞記錄但無法解釋。Vol 4 ch247-252 回收 | P2 |

---

## 柒、讀者的演算法理解曲線（Vol 3）

```
ch163：    「六十秒。每秒救一個。不回頭。」           → 戰時決策
ch165：    「最值得救的浮到最上面。」                 → 動態排序
ch182-184：「共同的開頭。在百萬人裡找一碗豆漿。」    → 前綴搜尋
ch189-191：「57% 是假的。43% 有她在。」              → 依賴鏈分析
ch215-216：「追碎片。一個都不放棄。」                → 系統性追蹤
ch220-234：「為她建一座分散式的家。」                → 系統設計
```

**遞進邏輯**：末日決策（Greedy/Heap）→ 搜尋真相（Trie）→ 分析自我（DP）→ 拯救愛人（BT）→ 重建存在（SD）。

每一步都建立在前一步的基礎上：你必須先在末日中活下來（Greedy/Heap），才能去搜尋真相（Trie），才能面對自己（DP），才能去救她（BT），才能為她建一個家（SD）。

**與 Vol 1-2 的完整遞進**：

```
Vol 1：線性（Array）→ 掃描（SW）→ 比對（HM）→ 層次（Stack）→ 非線性（LL）→ 效率（BS）
Vol 2：結構（Tree）→ 搜索（DFS/BFS）→ 網絡（Graph）→ 溯源（TopSort/UF）→ 最佳化（DP）→ 探索（BT）
Vol 3：決策（Greedy/Heap）→ 定位（Trie）→ 辨識（DP進階）→ 追蹤（BT進階）→ 建造（SD）
Vol 4：分類（Sorting）→ 底層（Bit）→ 設計（SD完整）= 從建造一個人的家到設計全城的自由
```

---

## 捌、寫作檢查清單（10 條）

### AB 線融合類

- [ ] **1. 六十秒的 Greedy 是否讓讀者忘記自己在學？** ch163-164 的教學必須隱藏在「救不救得到」的緊張感中。如果讀者意識到「哦這是貪心演算法」，就失敗了。檢驗標準：朗讀 ch164，聽起來像動作片還是教科書？必須是動作片。

- [ ] **2. 堡壘篇的 System Design 是否每一步都有情感動機？** 分片（「讓她不依賴單一節點」）、複製（「三個副本」）、容錯（「任何三分之一崩塌她都在」）、一致性（「她的不同碎片知道彼此的存在」）、負載平衡（「沒有任何一個節點被壓垮」）——每一個技術術語背後都必須是「為了讓她活著」。

- [ ] **3.「拿掉演算法，劇情就塌了」逐一驗證。** Greedy：拿掉→六十秒搶救失去「每秒選擇」的物理約束。Heap：拿掉→碎片歸還失去排序邏輯。Trie：拿掉→在百萬記憶中找阿嬤變成「運氣好找到了」。DP：拿掉→57% vs 43% 失去量化衝擊。BT：拿掉→語青搶救失去「系統性追蹤」的可信度。SD：拿掉→堡壘篇不存在。**6/6 通過 = 合格。**

### 教學品質類

- [ ] **4. 米亞的六個比喻是否每個都有獨特辨識度？** Greedy「六十秒」/ Heap「排隊」/ Trie「找豆漿」/ DP「上游」/ BT「追碎片」/ SD「家」——六個比喻不重複、不衝突、各有記憶點。其中「找豆漿」和「追碎片」是 Vol 3 最佳比喻競賽的候選。

- [ ] **5. 每個演算法是否至少出場兩次？** Greedy 3次、Heap 4次、Trie 5次、DP 3次、BT 2次、SD 6次。全部通過。BT 只有 2 次，但 ch215-216 兩章的教學密度和情感強度足以補償次數不足。

- [ ] **6. ch163-165 的高密度紅區是否被末日緊張感包裹？** 三章連續三個演算法（Greedy×2 + Heap×1），但讀者此時的注意力在「六十秒搶救」而非「演算法教學」。確認精修時不要在這三章插入米亞的長段比喻——短句、斷行、節奏優先。

### 銜接類

- [ ] **7. Vol 2 → Vol 3 的六對演算法銜接是否在文本中有「提示點」？** 最重要的一對：DP→Greedy（ch149 全局最優 → ch163 每步最優）。建議在 ch163 加入一句米亞的台詞：「上一次我們有時間挑最好的。這一次——你只有六十秒。」讓讀者意識到從「背包」到「搶救」的升級。

- [ ] **8. Vol 3 → Vol 4 的三顆種子是否已植入？** Sorting 萌芽（ch165）、Bit Manipulation 萌芽（ch226）、System Design 銜接（ch234）。精修時逐一檢查。每顆種子只需要一句話——不需要教學，只需要暗示。

### 風格類

- [ ] **9.「身體記得」母題是否在至少三個教學場景中出現？** (a) ch164 維倫的「手比大腦快」= 身體記得搶救的本能 (b) ch169 孕婦的觸感記憶浮到 Heap 頂端 = 身體記得母愛 (c) ch216 維倫追蹤碎片時「手在發燙」= 身體記得語青。三處達標。

- [ ] **10. Vol 3 的教學風格是否完成了從 Vol 2 的升級？** Vol 2 的教學在「陰謀」中進行（偵探感、揭露感）；Vol 3 的教學在「末日」和「愛」中進行（生死感、建造感）。確認 ch163-165（搶救）和 ch220-234（堡壘）這兩個核心段的基調分別是「戰時緊急」和「愛的工程」，而非回退到 Vol 2 的偵探模式。

---

## 附錄：Vol 3 演算法出場章節速查表

```
ch163 ─── Greedy（六十秒搶救——每秒選擇當前最高價值記憶）
ch164 ─── Greedy（貪心策略的生死實踐——手比大腦快）
ch165 ─── Heap / Priority Queue（搶救優先佇列——最值得搶救的浮到頂端）
ch168 ─── Greedy（孕婦案——Greedy 策略找到最核心情感錨點）
ch169 ─── Heap / Priority Queue（按情感連結強度排序——觸感記憶浮到頂端）
ch176 ─── Heap / Priority Queue（城市規模碎片歸還系統——建立大型 Heap）
ch177 ─── Heap / Priority Queue（持續插入+彈出——Heap 的動態維護。第 3,721 位）
ch182 ─── Trie（前綴樹概念引入——共同前綴編碼模式）
ch183 ─── Trie（構建前綴樹——每條路徑是一段記憶，深處匯聚）
ch184 ─── Trie（搜索結果——前綴樹的終端節點藏著一封信）
ch189 ─── DP 進階（問題定義——記憶依賴鏈的真偽分析）
ch190 ─── DP 進階（狀態轉移方程——上游原生則原生，上游植入則汙染）
ch191 ─── DP 進階（分析結果——57% 植入，43% 原生。「原生的部分有她在」）
ch194 ─── Trie（黑市記憶池前綴搜尋——定位阿嬤的記憶包裹）
ch207 ─── Trie（擴展搜尋——阿嬤記憶的更多前綴匹配碎片）
ch215 ─── Backtracking 進階（系統性搜索語青碎片——碰到死路標記回退）
ch216 ─── Backtracking 進階（狀態記憶化+剪枝——追蹤閃爍消散的意識碎片）
ch220 ─── System Design（概念引入——「分散式架構？」「我說的是——家。」）
ch221 ─── System Design（分片 Sharding + 複製 Replication）
ch224 ─── System Design（一致性——輕量級共識協議）
ch225 ─── System Design（容錯——三分之一失效仍能運作）
ch230 ─── System Design（負載平衡——2,400 節點均勻承載）
ch234 ─── System Design（堡壘上線——五大支柱統一運行）
```

**共 23 個出場點，分布在 80 章中（ch161-240）。其中 57 章無演算法（71%）、23 個出場點分布在 23 章中（29%）。**

**與 Vol 2 的密度對比**：Vol 2 有 32 個出場點分布在 80 章中（40%）。Vol 3 降低到 29%。這是正確的——Vol 3 的情感密度遠高於 Vol 2（身世核彈 + 遞迴殘留揭露 + 刪除我吧 + 堡壘），需要更多零演算法段來承載情感。

---

> **總結**：Vol 3 的 6 個演算法在 AB 線融合品質上整體達到了全系列最高水準——沒有任何演算法低於 ★★★★。三個 ★★★★★（System Design、DP 進階、Backtracking 進階）分別承載了 Vol 3 的三個核心命題：「用二進制造一個家」（SD）、「什麼是真正屬於你的」（DP）、「一個都不想放棄」（BT）。教學密度比 Vol 2 降低了 11%（29% vs 40%），為全書最高情感強度的段落（ch201-214）留出了充分的呼吸空間。Vol 3 的教學風格完成了從「人生類比」到「存在類比」的升級：演算法不再只是解題的工具或追查的武器，它是在末日中活下去的方法、在虛無中定義存在的量尺、在愛人消散時為她建造家園的建材。
>
> **最終判定**：Vol 3 演算法教學藍圖通過設計審查。6/6 演算法均滿足「拿掉演算法，劇情就塌了」的最高標準。System Design 的「家」意象、DP 進階的「43%」、Backtracking 的「一個都不放棄」——它們證明了演算法教學的終極形態不是「把概念解釋清楚」，而是「讓讀者在故事結束後，因為一個數字、一個決定、一座建築，而理解了一個演算法——以及一種愛的方式」。
