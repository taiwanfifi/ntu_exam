# 機率 補充題庫 — 林守德教授考題

---

# 一、102下 林守德 期中考（新增 8 題）

---

## 題目 S3.1（林守德 102-2 期中考）

**[Independency]**
X, Y, and Z are three random variables. Can you propose a real-world example of them that satisfy the following conditions:

(a) X and Y are independent, but becomes dependent given Z (5pts)

(b) X and Y are dependent, but becomes independent given Z (5pts)

### 詳解

本題考察**條件獨立**與**邊際獨立**之間的微妙關係。

**(a) X, Y 獨立，但 given Z 後變成相依（Explaining Away / Berkson's Paradox）**

**例子：兩個獨立原因導致同一結果**
- X = 是否有讀書（0 或 1），Y = 考試題目是否簡單（0 或 1），Z = 考試是否通過（0 或 1）
- X 和 Y 彼此無關（獨立），但當已知 Z = 1（通過了考試），得知 X = 0（沒讀書）會讓我們更相信 Y = 1（題目很簡單），所以 given Z 後 X、Y 不再獨立。

**數學結構**：這就是 **V-structure（collider）** 在貝氏網路中的經典例子：
$$X \rightarrow Z \leftarrow Y$$
X ⊥ Y，但 X ⊥̸ Y | Z。

另一個常見例子：
- X = 硬幣 A 的結果，Y = 硬幣 B 的結果，Z = X + Y（兩硬幣之和）
- X, Y 獨立。但 given Z = 1，若知道 X = 1 則必知 Y = 0，故條件相依。

**(b) X, Y 相依，但 given Z 後變成獨立（Conditional Independence）**

**例子：共同原因**
- Z = 今天是否下雨（0 或 1），X = 路面是否濕滑（0 或 1），Y = 是否有人帶傘（0 或 1）
- X 和 Y 都受 Z 影響，所以 X、Y 邊際上是相依的（路濕通常也多人帶傘）。但 given Z（已知是否下雨），X 和 Y 的相關性消失，因為它們各自只取決於 Z。

**數學結構**：這是 **fork structure** 在貝氏網路中的經典例子：
$$X \leftarrow Z \rightarrow Y$$
X ⊥̸ Y，但 X ⊥ Y | Z。

$$\boxed{\text{(a) Collider/V-structure：兩獨立原因的共同結果 \quad (b) Fork：共同原因的兩個結果}}$$

---

## 題目 S3.2（林守德 102-2 期中考）

**[Application on Probability]**
There is a group of n students who occupied the Legislative Yuan (LY). The observation is that: at each minute, there is 1/2 chance one student will leave LY (i.e. n=n-1), and 1/2 chance one student enters LY (i.e. n=n+1). The police make a deal with the leader: If they reach 2n students before everybody leaves LY (n=0), then the leader will not be arrested. However, if the number reaches 0 before it becomes 2n, then the leader will be arrested immediately.

(a) Given t minutes passed, what is the chance that the leader has already been arrested? (12pts, if you cannot derive the closed form solution, please describe how to generate this probability)

### 詳解

這是**對稱隨機漫步（Symmetric Random Walk）** 在有限區間 [0, 2n] 上的吸收問題，起始位置 i = n。

**背景設定**：
- 狀態空間：{0, 1, 2, ..., 2n}，其中 0 和 2n 是**吸收態（absorbing states）**
- 起始狀態：n
- 每步 +1 或 -1，各機率 1/2

**(a) 在 t 分鐘內領導者已被逮捕（即在時間 t 前 process 已到達 0）的機率**

設 $P_i(t)$ = 從位置 i 出發，在 t 步內被吸收到狀態 0 的機率。

**方法一：遞迴法**

定義 $a_i(t)$ = 從位置 i 出發，在 t 步內先碰到 0（而非 2n）的機率。

遞迴關係：
$$a_i(t) = \frac{1}{2} a_{i-1}(t-1) + \frac{1}{2} a_{i+1}(t-1), \quad 1 \leq i \leq 2n-1$$

邊界條件：$a_0(t) = 1$（已到 0），$a_{2n}(t) = 0$（到 2n 則不會被逮捕）。

初始條件：$a_i(0) = 0$（對 $1 \leq i \leq 2n-1$）。

這可用**動態規劃**或**矩陣方法**來數值求解：

```
# Pseudocode
Initialize a[i][0] = 0 for i=1..2n-1, a[0][t]=1, a[2n][t]=0
For s = 1 to t:
    For i = 1 to 2n-1:
        a[i][s] = 0.5 * a[i-1][s-1] + 0.5 * a[i+1][s-1]
Answer = a[n][t]
```

**方法二：反射原理與組合方法**

對於離散對稱隨機漫步在 [0, 2n] 上的吸收問題，可以用**特徵值法**。transition matrix 的特徵值為：

$$\lambda_k = \cos\left(\frac{k\pi}{2n}\right), \quad k = 1, 2, \ldots, 2n-1$$

被狀態 0 吸收的機率可以表示為：

$$a_n(t) = \frac{1}{2} - \frac{1}{2n}\sum_{k=1}^{2n-1} \sin\left(\frac{kn\pi}{2n}\right) \cdot \frac{\sin\left(\frac{k\pi}{2n}\right)}{1 - \cos\left(\frac{k\pi}{2n}\right)} \cdot \left[\cos\left(\frac{k\pi}{2n}\right)\right]^t \cdot (-1)$$

這個公式相當複雜。實際考試中，描述遞迴方法或數值方法即可得到大部分分數。

**注意**：題庫中已收錄 (b) 部分（當 $t \gg n$ 時），答案為 $P = 1/2$（Gambler's Ruin 在對稱隨機漫步下的經典結果）。

$$\boxed{a_n(t) = \frac{1}{2}a_{n-1}(t-1) + \frac{1}{2}a_{n+1}(t-1), \text{ 用 DP 求解；當 } t \to \infty, \; a_n(\infty) = \frac{1}{2}}$$

---

## 題目 S3.3（林守德 102-2 期中考）

**[Probability and Expectation]**
A grocery store has available n watermelons to sell and makes \$1.00 on each sale. Say the number of consumers of these watermelons is a random variable that has a distribution that can be approximated by

$$f(x) = \frac{1}{200}, \quad 0 < x < 200$$

a p.d.f. of the continuous type. If the grocer does not have enough watermelons to sell to all consumers, she figures that she loses \$5.00 for each unhappy customer. But if she has surplus watermelons, she loses 50 cents on each extra watermelon. What should n be to maximize "profit"? (10pts)

### 詳解

設 X ~ Uniform(0, 200) 為顧客人數（連續型），n 為庫存量。

**利潤函數分析**：
- 若 X ≤ n：賣出 X 個西瓜，賺 \$1 × X，但有 n - X 個剩餘，每個虧 \$0.5
  - 利潤 = X - 0.5(n - X) = 1.5X - 0.5n
- 若 X > n：賣出 n 個西瓜，賺 \$1 × n，但有 X - n 個不滿意顧客，每人虧 \$5
  - 利潤 = n - 5(X - n) = 6n - 5X

**期望利潤**：
$$E[\text{Profit}] = \int_0^n (1.5x - 0.5n) \cdot \frac{1}{200}\,dx + \int_n^{200} (6n - 5x) \cdot \frac{1}{200}\,dx$$

**計算第一項**：
$$\int_0^n (1.5x - 0.5n) \cdot \frac{1}{200}\,dx = \frac{1}{200}\left[\frac{1.5x^2}{2} - 0.5nx\right]_0^n = \frac{1}{200}\left(0.75n^2 - 0.5n^2\right) = \frac{0.25n^2}{200}$$

**計算第二項**：
$$\int_n^{200} (6n - 5x) \cdot \frac{1}{200}\,dx = \frac{1}{200}\left[6nx - \frac{5x^2}{2}\right]_n^{200}$$

$$= \frac{1}{200}\left[\left(1200n - \frac{5 \times 40000}{2}\right) - \left(6n^2 - \frac{5n^2}{2}\right)\right]$$

$$= \frac{1}{200}\left[1200n - 100000 - \frac{7n^2}{2}\right]$$

**總期望利潤**：
$$E[\text{Profit}] = \frac{1}{200}\left[0.25n^2 + 1200n - 100000 - 3.5n^2\right]$$

$$= \frac{1}{200}\left[-3.25n^2 + 1200n - 100000\right]$$

**對 n 求導令其為零**：
$$\frac{dE}{dn} = \frac{1}{200}(-6.5n + 1200) = 0$$

$$n = \frac{1200}{6.5} = \frac{2400}{13} \approx 184.6$$

由於 n 需為整數，取 $n = 185$（也可比較 184 和 185 哪個利潤更高）。

**驗證這是最大值**：$\frac{d^2E}{dn^2} = \frac{-6.5}{200} < 0$ ✓（確實是最大值）

**直覺理解**：由於缺貨的損失（\$5/人）遠大於存貨的損失（\$0.5/個），最優庫存量偏高（184.6/200 ≈ 92%）。

$$\boxed{n \approx 185 \text{ 個西瓜}}$$

---

## 題目 S3.4（林守德 102-2 期中考）

**[Bayes Rule]**
Company1 announces a disease (occur rate = 20%) testing product T1. The performance looks like:
- $P(T_1 = \text{positive} \mid \text{Disease} = \text{true}) = 0.7$
- $P(T_1 = \text{negative} \mid \text{Disease} = \text{false}) = 0.7$

Company2 also announces a testing product T2 for the same disease. The performance looks like:
- $P(T_2 = \text{positive} \mid \text{Disease} = \text{true}) = 0.9$
- $P(T_2 = \text{negative} \mid \text{Disease} = \text{false}) = 0.6$

Q1: A careless doctor performs a test on a patient and found that the result is positive. However, this doctor forgot which testing product was chosen. Can you tell this doctor which product is more likely to be the one used given positive result? (5pts)

Q2: If a patient has been tested positive on both products, what is the probability that he/she really has the disease (assuming that the test results are conditionally independent given disease)? (5pts)

### 詳解

設 D = 有病 (disease = true), D' = 沒病。P(D) = 0.2, P(D') = 0.8。

**產品 T1**：
- 靈敏度 (sensitivity)：P(T1+ | D) = 0.7
- 特異度 (specificity)：P(T1- | D') = 0.7，故 P(T1+ | D') = 0.3

**產品 T2**：
- 靈敏度：P(T2+ | D) = 0.9
- 特異度：P(T2- | D') = 0.6，故 P(T2+ | D') = 0.4

---

**Q1：已知結果為陽性，哪個產品更可能被使用？**

假設醫生隨機選用 T1 或 T2 的機率各為 1/2。

先算各產品出現陽性的總機率：
$$P(\text{positive} \mid T_1) = P(T_1+ \mid D)P(D) + P(T_1+ \mid D')P(D') = 0.7 \times 0.2 + 0.3 \times 0.8 = 0.14 + 0.24 = 0.38$$

$$P(\text{positive} \mid T_2) = P(T_2+ \mid D)P(D) + P(T_2+ \mid D')P(D') = 0.9 \times 0.2 + 0.4 \times 0.8 = 0.18 + 0.32 = 0.50$$

用 Bayes' rule：
$$P(T_1 \mid \text{positive}) = \frac{P(\text{positive} \mid T_1) \cdot P(T_1)}{P(\text{positive})} = \frac{0.38 \times 0.5}{0.38 \times 0.5 + 0.50 \times 0.5} = \frac{0.19}{0.44} \approx 0.432$$

$$P(T_2 \mid \text{positive}) = \frac{0.50 \times 0.5}{0.44} = \frac{0.25}{0.44} \approx 0.568$$

$$\boxed{\text{T2 更可能是被使用的產品。}P(T_2 \mid +) \approx 56.8\% > P(T_1 \mid +) \approx 43.2\%}$$

**直覺**：T2 的 sensitivity 更高（0.9 > 0.7）但 specificity 更低（0.6 < 0.7），所以 T2 整體更容易出現陽性結果。

---

**Q2：兩個產品都測陽性，真正有病的機率？**

假設 given 疾病狀態，T1 和 T2 的結果**條件獨立**。

$$P(T_1+, T_2+ \mid D) = P(T_1+ \mid D) \cdot P(T_2+ \mid D) = 0.7 \times 0.9 = 0.63$$

$$P(T_1+, T_2+ \mid D') = P(T_1+ \mid D') \cdot P(T_2+ \mid D') = 0.3 \times 0.4 = 0.12$$

由 Bayes' rule：
$$P(D \mid T_1+, T_2+) = \frac{P(T_1+, T_2+ \mid D) \cdot P(D)}{P(T_1+, T_2+ \mid D) \cdot P(D) + P(T_1+, T_2+ \mid D') \cdot P(D')}$$

$$= \frac{0.63 \times 0.2}{0.63 \times 0.2 + 0.12 \times 0.8} = \frac{0.126}{0.126 + 0.096} = \frac{0.126}{0.222}$$

$$\boxed{P(D \mid T_1+, T_2+) = \frac{0.126}{0.222} = \frac{7}{12.333...} \approx 0.5676 \approx 56.8\%}$$

**注意**：即使兩個測試都是陽性，真正有病的機率也只有約 57%。這是因為疾病的先驗機率只有 20%，false positive 的影響仍然很大。

---

## 題目 S3.5（林守德 102-2 期中考）

**[Poisson]**
Given the following random experiments, please comment whether each of them is likely to produce a random variable that follows a Poisson distribution, and explain why:

(a) Observing the number of people entering CSIE R104 front door from 14:20-15:00 every Monday

(b) Observing the number of cars passing the guard booth on Chang-Xing Street every Monday from 10-11am

(c) Observing the number of cars passing the intersection of Xinsheng South Road and Zhongxiao East Road at 5-6pm every Monday

(9pts)

### 詳解

Poisson 分布適用的條件（Poisson process 的假設）：
1. **獨立性（Independence）**：不同時間段內的事件互相獨立
2. **稀有性（Rarity）**：在極短時間內發生兩個以上事件的機率趨近於 0
3. **均勻性（Homogeneity/Stationarity）**：事件發生的速率在觀察期間內大致穩定

---

**(a) 觀察每週一 14:20-15:00 進入 CSIE R104 前門的人數**

**不太可能是 Poisson 分布。**

原因：這個時間段通常是上課時間（14:20 正好是上課鈴響），學生會**集中在上課前幾分鐘**大量湧入，之後幾乎沒有人進來。事件發生率**不是均勻的**（violates stationarity），呈現強烈的時間聚集性，不滿足 Poisson process 的均勻性假設。

---

**(b) 觀察每週一 10-11am 長興街警衛亭前經過的車輛數**

**較可能近似 Poisson 分布。**

原因：
- 長興街是校園內的小路，車流量不大，各車輛之間的到達可以認為大致**獨立**
- 在 10-11am 這段時間內，交通流量相對**穩定**（不是上下班尖峰）
- 每輛車經過的時間很短，短時間內兩車同時經過的機率很小（**稀有性**滿足）

三個條件大致滿足，可以用 Poisson 分布近似。

---

**(c) 觀察每週一 5-6pm 新生南路與忠孝東路交叉口的車輛數**

**不太可能是 Poisson 分布。**

原因：
- 5-6pm 是下班**尖峰時段**，交叉口有**紅綠燈**控制，車輛到達不是隨機的而是**週期性的**（紅燈積車、綠燈放行），嚴重違反**獨立性**
- 車流量非常大且受前車影響（車隊效應），不滿足**稀有性**
- 紅綠燈造成的「批次到達」模式使事件發生率**不均勻**

$$\boxed{\text{(a) 不像 Poisson（聚集效應）\quad (b) 較像 Poisson \quad (c) 不像 Poisson（紅綠燈週期性）}}$$

---

## 題目 S3.6（林守德 102-2 期中考）

Amy wants to buy the May-Day concert ticket online. Since it is really hard to get one, she used five computers (C1~C5) in parallel to ensure she can get it. But there are different successful rates for each computer to get the ticket. The successful rate of Ci computer is:
$$P(i+1) = 1.05 \cdot P(i) - 0.05$$

A 'round' is defined as one trial for every computer. A random variable X is defined as the number of rounds required to get one ticket. We know the variance of X is 2. So what's P(1)? (7pts)

### 詳解

**分析成功率的遞迴關係**：

$$P(i+1) = 1.05 \cdot P(i) - 0.05$$

這是一階線性遞迴。先求不動點：$P^* = 1.05P^* - 0.05 \Rightarrow -0.05P^* = -0.05 \Rightarrow P^* = 1$

所以可以寫成：$P(i+1) - 1 = 1.05(P(i) - 1)$

令 $Q(i) = P(i) - 1$：
$$Q(i+1) = 1.05 \cdot Q(i) \implies Q(i) = Q(1) \cdot 1.05^{i-1}$$

$$P(i) = 1 + (P(1) - 1) \cdot 1.05^{i-1}$$

由於成功率必須在 [0,1] 範圍內，且 $1.05^{i-1}$ 隨 i 增長，需要 $P(1) - 1 < 0$，即 $P(1) < 1$。

列出 5 台電腦的成功率：
- $P(1) = P(1)$
- $P(2) = 1 + (P(1)-1)(1.05)$
- $P(3) = 1 + (P(1)-1)(1.05)^2$
- $P(4) = 1 + (P(1)-1)(1.05)^3$
- $P(5) = 1 + (P(1)-1)(1.05)^4$

**每輪中至少一台成功的機率**：

每輪中所有電腦都失敗的機率為：
$$q = \prod_{i=1}^{5}(1 - P(i)) = \prod_{i=1}^{5}\left[-(P(1)-1) \cdot 1.05^{i-1}\right] = (1-P(1))^5 \cdot \prod_{i=0}^{4}1.05^i$$

$$= (1-P(1))^5 \cdot 1.05^{0+1+2+3+4} = (1-P(1))^5 \cdot 1.05^{10}$$

所以每輪成功率 $p = 1 - q = 1 - (1-P(1))^5 \cdot 1.05^{10}$。

**X 服從幾何分布** Geometric(p)：
$$\text{Var}(X) = \frac{1-p}{p^2} = 2$$

解這個方程：
$$1 - p = 2p^2 \implies 2p^2 + p - 1 = 0 \implies (2p - 1)(p + 1) = 0$$

由 0 < p < 1 得 $p = 1/2$。

因此 $q = 1 - p = 1/2$：
$$(1 - P(1))^5 \cdot 1.05^{10} = \frac{1}{2}$$

$$1.05^{10} \approx 1.6289$$

$$(1 - P(1))^5 = \frac{1}{2 \times 1.6289} = \frac{1}{3.2578} \approx 0.30695$$

$$1 - P(1) = 0.30695^{1/5} = 0.30695^{0.2}$$

計算 $0.30695^{0.2}$：
$$\ln(0.30695) = -1.1803$$
$$0.2 \times (-1.1803) = -0.23606$$
$$e^{-0.23606} \approx 0.7896$$

$$P(1) = 1 - 0.7896 \approx 0.2104$$

$$\boxed{P(1) \approx 0.21}$$

---

## 題目 S3.7（林守德 102-2 期中考）

In the movie theater there are 300 seats. 300 people including Jack lined up to enter the theater. Jack is the 200th person to enter the theater, but when it's his turn, he found that his seat number faded so he has no idea where to seat. Jack decides to randomly pick a seat because everyone was so nice that if their seat is taken, they will simply find other seat randomly. What's the probability of the last person to seat in his/her own seat correctly? (10pts)

### 詳解

這是經典的**飛機座位問題（Airplane Seating Problem）**的變形。

**問題重新表述**：
- 300 個座位，300 個人。前 199 個人都乖乖坐自己的座位。
- 第 200 個人（Jack）隨機選一個座位。
- 之後第 201-300 的人：如果自己的座位空著就坐，否則隨機選一個空座位。
- 問：第 300 個人坐到自己座位的機率？

**關鍵觀察**：當 Jack 隨機坐的時候，前 199 個人已經坐好了，所以剩下 101 個空座位（Jack 的座位 + 第 201-300 號人的座位）。

此時問題等價於：101 個座位、101 個人（Jack 是第一個、亂坐者）。

**經典結論**：在標準的飛機座位問題中，如果第一個人隨機坐，其他人有座坐自己的、沒座隨機坐，那麼**最後一個人坐到自己座位的機率恰好是 1/2**。

**證明**（遞迴 / 歸納法）：

設有 m 個座位（這裡 m = 101），第一人（Jack）隨機選座位。

考慮 Jack 的選擇：
- 機率 1/m：Jack 坐到自己的座位（假設他的座位也在剩餘的空座位中）→ 之後所有人都能坐到自己的座位 → 最後一人坐對 ✓
- 機率 1/m：Jack 坐到最後一個人的座位 → 最後一人坐不到 ✗
- 機率 1/m：Jack 坐到第 k 個人（2 ≤ k ≤ m-1）的座位 → 第 2 到 k-1 的人都能坐對，但第 k 個人發現自己的座位被占，他隨機選一個空座位。此時問題**遞迴**為一個 m-k+1 人的同樣問題。

設 $f(m)$ = m 個座位版本中最後一人坐對的機率：
$$f(m) = \frac{1}{m} \cdot 1 + \frac{1}{m} \cdot 0 + \sum_{k=2}^{m-1}\frac{1}{m} \cdot f(m-k+1)$$

$$= \frac{1}{m}\left(1 + \sum_{j=2}^{m-1}f(j)\right)$$

其中 j = m-k+1。

可以驗證 $f(m) = 1/2$ 對所有 $m \geq 2$ 成立：

基本情況：$f(2) = 1/2$（兩人兩座，第一人 50% 坐對 50% 坐錯）✓

歸納步驟：假設 $f(j) = 1/2$ 對 $2 \leq j \leq m-1$ 成立：
$$f(m) = \frac{1}{m}\left(1 + (m-2) \cdot \frac{1}{2}\right) = \frac{1}{m} \cdot \frac{m}{2} = \frac{1}{2} \quad \checkmark$$

$$\boxed{P(\text{最後一個人坐到自己的座位}) = \frac{1}{2}}$$

---

## 題目 S3.8（林守德 102-2 期中考）

One day Takashi found that around him there were four zombies. He picked up the gun to kill them. Since it becomes easier to kill a zombie if there are more around, the probability for Takashi to kill the zombie is n/5 (n is the number of zombies) and he can only kill one zombie at a time. When a zombie is killed, the zombie will have 30% chance to be revived by their friend. That says, if there is only one zombie left, it won't rebirth. What's the expected time Takashi needed to kill all the zombies? (10pts)

### 詳解

**問題數學化**：
- 狀態 = 當前殭屍數量 n ∈ {0, 1, 2, 3, 4}
- 在狀態 n 時，每次嘗試的結果：
  - 殺成功且不復活：殭屍數 → n-1
  - 殺成功但復活：殭屍數維持 n（但注意：只剩 1 隻時不能復活）
  - 殺失敗：殭屍數維持 n
- 殺成功機率 = n/5
- 復活機率 = 30%（但只剩 1 隻時為 0%）

**從狀態 n 轉移的機率**：

對 n ≥ 2：
- P(n → n-1) = (n/5) × 0.7 = 0.7n/5 = 7n/50（殺成功且不復活）
- P(n → n) = (n/5) × 0.3 + (1 - n/5) = 0.3n/5 + 1 - n/5 = 1 - 0.7n/5 = 1 - 7n/50（殺成功但復活 + 殺失敗）

對 n = 1：
- P(1 → 0) = 1/5（殺成功，不會復活因為沒有朋友）
- P(1 → 1) = 4/5（殺失敗）

**設 $E_n$ = 從狀態 n 到狀態 0 的期望步數**

**狀態 n = 1**：每步成功機率 1/5，幾何分布。
$$E_1 = \frac{1}{1/5} = 5$$

**狀態 n ≥ 2**：每步從 n 到 n-1 的機率為 $p_n = 7n/50$。在離開狀態 n 之前的期望步數為 $1/p_n$。

$$E_n = \frac{1}{p_n} + E_{n-1} = \frac{50}{7n} + E_{n-1}$$

逐步計算：

$$E_1 = 5$$

$$E_2 = \frac{50}{7 \times 2} + E_1 = \frac{50}{14} + 5 = \frac{25}{7} + 5 = \frac{25 + 35}{7} = \frac{60}{7}$$

$$E_3 = \frac{50}{7 \times 3} + E_2 = \frac{50}{21} + \frac{60}{7} = \frac{50}{21} + \frac{180}{21} = \frac{230}{21}$$

$$E_4 = \frac{50}{7 \times 4} + E_3 = \frac{50}{28} + \frac{230}{21} = \frac{25}{14} + \frac{230}{21}$$

$$= \frac{75}{42} + \frac{460}{42} = \frac{535}{42} \approx 12.738$$

$$\boxed{E_4 = \frac{535}{42} \approx 12.74 \text{ 次}}$$

---

## 題目 S3.9（林守德 102-2 期中考）

In the MMORPG world, Shiroe and his partners want to meet with the king. They started at "A" and are allowed to choose only three directions (right, up, down), with probability P(right) = 1/2, P(up) = P(down) = 1/4. However, if he can't go up or down, the probability becomes P(right) = 1/2, P(up or down) = 1/2. In the graph there are many traps in each area, denoted as 'X'. Entering 'X' means game over. One special place is the rest area, there they can choose to start at "B", "C" or "D". Assuming Shiroe took SD's probability course previously and can make the best decision, what's the probability that Shiroe meets the king safely? (12pts)

```
+---+---+---+------+---+---+---+------+
| O | O | O |      | B | O | O |      |
+---+---+---+      +---+---+---+      |
| A | O | X | Rest | C | O | X | King |
+---+---+---+      +---+---+---+      |
| O | O | O |      | D | O | O |      |
+---+---+---+------+---+---+---+------+
```

### 詳解

**地圖分析**：

地圖分成左半部和右半部，中間有 Rest Area 連接。

**左半部**（3×3 格子，A 在中間左邊）：

用座標表示（列, 行），A = (2,1)（第 2 列 = 中間，第 1 行 = 左邊）：

```
(1,1) O    (1,2) O    (1,3) O
(2,1) A    (2,2) O    (2,3) X    → Rest
(3,1) O    (3,2) O    (3,3) O
```

**右半部**（類似結構）：
```
(1,1) B    (1,2) O    (1,3) O
(2,1) C    (2,2) O    (2,3) X    → King
(3,1) D    (3,2) O    (3,3) O
```

**移動規則**：只能往右、上、下（不能往左）。
- 一般情況：P(右) = 1/2, P(上) = 1/4, P(下) = 1/4
- 邊界（不能上或不能下時）：P(右) = 1/2, P(可行方向) = 1/2

**左半部分析：從 A 到 Rest 的機率**

從 A = (中, 左)：可以往右到 (中, 中)，往上到 (上, 左)，往下到 (下, 左)。

設各格子到達 Rest 的機率（不碰到 X）。

注意 (2,3) = X（陷阱），位於中間列的最右邊。Rest 在中間列的右邊（過了 X）。但因為 X 就擋在通往 Rest 的路上……

等等，重新理解地圖：Rest 是在第三行的右邊（column 4 的位置）。要到達 Rest，需要從第三列往右走。但 (2,3) = X，所以不能從中間列的第三行往右走到 Rest。

實際上，從第 3 列(column 3) 往右就到 Rest。位置 (1,3)、(2,3)、(3,3) 往右都到 Rest。但 (2,3) = X，進入就 game over。所以只有 (1,3) 和 (3,3) 可以往右到 Rest。

讓我重新定義座標：row = {top=1, mid=2, bot=3}, col = {1, 2, 3}。

各格子通往 Rest 的機率。設 $p_{r,c}$ = 從 (r,c) 出發最終到達 Rest 的機率。

**邊界/吸收狀態**：
- (2,3) = X → $p_{2,3} = 0$（進入 X 就 game over）
- 從 (1,3) 或 (3,3) 向右走到 Rest：$p_{1,3}(\text{to rest}) = 1/2$（向右到 Rest 的機率）…

不對，讓我更仔細思考。從 (1,3) 可以往右（到 Rest）或往下（到 (2,3)=X）。(1,3) 在頂端，不能往上。所以：
- P(右) = 1/2, P(下) = 1/2
- $p_{1,3} = 1/2 \cdot 1 + 1/2 \cdot 0 = 1/2$

從 (3,3)：在底端，不能往下。
- P(右) = 1/2, P(上) = 1/2
- $p_{3,3} = 1/2 \cdot 1 + 1/2 \cdot 0 = 1/2$

從 (1,2)：可以往右到 (1,3)、往下到 (2,2)。不能往上（頂端）。
- P(右) = 1/2, P(下) = 1/2
- $p_{1,2} = 1/2 \cdot p_{1,3} + 1/2 \cdot p_{2,2} = 1/2 \cdot 1/2 + 1/2 \cdot p_{2,2} = 1/4 + p_{2,2}/2$

從 (3,2)：可以往右到 (3,3)、往上到 (2,2)。不能往下（底端）。
- P(右) = 1/2, P(上) = 1/2
- $p_{3,2} = 1/2 \cdot p_{3,3} + 1/2 \cdot p_{2,2} = 1/4 + p_{2,2}/2$

從 (2,2)：可以往右到 (2,3)=X、往上到 (1,2)、往下到 (3,2)。
- P(右) = 1/2, P(上) = 1/4, P(下) = 1/4
- $p_{2,2} = 1/2 \cdot 0 + 1/4 \cdot p_{1,2} + 1/4 \cdot p_{3,2}$
- $= 1/4(1/4 + p_{2,2}/2) + 1/4(1/4 + p_{2,2}/2)$
- $= 1/4 \cdot (1/2 + p_{2,2}) = 1/8 + p_{2,2}/4$

解方程：$p_{2,2} = 1/8 + p_{2,2}/4 \Rightarrow 3p_{2,2}/4 = 1/8 \Rightarrow p_{2,2} = 1/6$

回代：$p_{1,2} = 1/4 + 1/12 = 1/3$, $p_{3,2} = 1/3$

從 A = (2,1)：
- P(右) = 1/2, P(上) = 1/4, P(下) = 1/4
- $p_A = 1/2 \cdot p_{2,2} + 1/4 \cdot p_{1,1 \to ...}$

等等，從 (2,1) 往上到 (1,1)，往右到 (2,2)，往下到 (3,1)。

從 (1,1)：頂端，不能往上。
- P(右) = 1/2, P(下) = 1/2
- $p_{1,1} = 1/2 \cdot p_{1,2} + 1/2 \cdot p_{2,1}$

從 (3,1)：底端，不能往下。
- P(右) = 1/2, P(上) = 1/2
- $p_{3,1} = 1/2 \cdot p_{3,2} + 1/2 \cdot p_{2,1}$

從 (2,1) = A：
- $p_{2,1} = 1/2 \cdot p_{2,2} + 1/4 \cdot p_{1,1} + 1/4 \cdot p_{3,1}$

代入已知值 $p_{2,2} = 1/6$, $p_{1,2} = 1/3$, $p_{3,2} = 1/3$：

$p_{1,1} = 1/2 \cdot 1/3 + 1/2 \cdot p_{2,1} = 1/6 + p_{2,1}/2$

$p_{3,1} = 1/2 \cdot 1/3 + 1/2 \cdot p_{2,1} = 1/6 + p_{2,1}/2$

$p_{2,1} = 1/2 \cdot 1/6 + 1/4 \cdot (1/6 + p_{2,1}/2) + 1/4 \cdot (1/6 + p_{2,1}/2)$

$= 1/12 + 1/2 \cdot (1/6 + p_{2,1}/2)$

$= 1/12 + 1/12 + p_{2,1}/4$

$= 1/6 + p_{2,1}/4$

$3p_{2,1}/4 = 1/6 \Rightarrow p_{2,1} = 2/9$

所以**從 A 到 Rest 的機率 = 2/9**。

**右半部分析：從 B/C/D 到 King 的機率**

右半部結構完全相同。用同樣的方法：
- 從 B = (1,1)（上左）開始到 King
- 從 C = (2,1)（中左）開始到 King
- 從 D = (3,1)（下左）開始到 King

King 在中間列的右出口。但 (2,3) = X，所以同樣只能從 (1,3) 或 (3,3) 往右到 King。

右半部的結構完全和左半部一樣，所以：
- 從 C（中左）到 King 的機率 = 2/9（和 A→Rest 一樣）
- 從 B（上左）到 King 的機率 = $p_{1,1} = 1/6 + p_{C}/2$...

不對，B 在 (1,1) 位置。從左半部分析中，$p_{1,1} = 1/6 + p_{2,1}/2$。在右半部，$p_{2,1}$ 對應 C 的位置，而 C→King 的機率 = 2/9。

所以 $p_B = 1/6 + (2/9)/2 = 1/6 + 1/9 = 3/18 + 2/18 = 5/18$

$p_D = 1/6 + (2/9)/2 = 5/18$（由對稱性和 D 同理）

$p_C = 2/9$

**最優策略**：在 Rest Area 選 B 或 D（都是 5/18 ≈ 0.278），而非 C（2/9 ≈ 0.222）。

**總機率**：
$$P(\text{meet king}) = P(\text{A → Rest}) \times \max(p_B, p_C, p_D) = \frac{2}{9} \times \frac{5}{18} = \frac{10}{162} = \frac{5}{81}$$

$$\boxed{P(\text{Shiroe meets the king}) = \frac{5}{81} \approx 0.0617 \approx 6.2\%}$$

---

# 二、102下 林守德 期末考（新增 6 題）

---

## 題目 S3.10（林守德 102-2 期末考）

**Short Answer (部分新增)**

(b) Describe Central Limit Theorem (5 pts)

(c) Describe p-value (5 pts)

### 詳解

**(b) 中央極限定理 (Central Limit Theorem, CLT)**

設 $X_1, X_2, \ldots, X_n$ 為獨立同分布（i.i.d.）的隨機變數，期望值 $E[X_i] = \mu$，變異數 $\text{Var}(X_i) = \sigma^2 < \infty$。

則當 $n \to \infty$ 時，標準化後的樣本平均數趨近標準常態分布：

$$\frac{\bar{X}_n - \mu}{\sigma / \sqrt{n}} = \frac{\sum_{i=1}^n X_i - n\mu}{\sigma\sqrt{n}} \xrightarrow{d} N(0, 1)$$

**核心意義**：不論原始分布的形狀如何（只要有有限變異數），大量獨立隨機變數的平均值近似常態分布。這就是為什麼常態分布在統計學中如此重要。

**(c) p-value**

p-value 是在**假設虛無假設 $H_0$ 為真**的條件下，觀察到**與目前數據一樣極端或更極端**的結果的機率。

$$\text{p-value} = P(\text{data as extreme or more extreme} \mid H_0 \text{ is true})$$

**使用方式**：
- 若 p-value < 顯著水準 $\alpha$（例如 0.05），則拒絕 $H_0$
- 若 p-value ≥ $\alpha$，則不拒絕 $H_0$

**注意事項**：
- p-value **不是** $H_0$ 為真的機率
- p-value 越小，反對 $H_0$ 的證據越強
- p-value 本身是一個隨機變數（取決於數據）

$$\boxed{\text{p-value = 假設 } H_0 \text{ 為真時，觀察到當前或更極端結果的機率}}$$

---

## 題目 S3.11（林守德 102-2 期末考）

某種燈泡已知壽命100小時，standard deviation 30小時。颱風天來了，假設現在我們要庫存一些燈泡，用以確保有98%以上的機率已有的燈泡連續點上可以發光至少2000小時，那我們必須庫存至少多少燈泡？ (8pts)

### 詳解

設每個燈泡壽命 $X_i$，$E[X_i] = 100$，$\text{SD}(X_i) = 30$，$\text{Var}(X_i) = 900$。

設庫存 n 個燈泡，連續使用的總壽命 $S_n = X_1 + X_2 + \cdots + X_n$。

$$E[S_n] = 100n, \quad \text{Var}(S_n) = 900n, \quad \sigma_{S_n} = 30\sqrt{n}$$

要求 $P(S_n \geq 2000) \geq 0.98$，等價於：

$$P(S_n < 2000) \leq 0.02$$

由中央極限定理，$S_n$ 近似常態分布：

$$P(S_n < 2000) = P\left(Z < \frac{2000 - 100n}{30\sqrt{n}}\right) \leq 0.02$$

查表：$\Phi(-2.05) \approx 0.02$（即 $P(Z < -2.05) = 0.02$），題目給的是 $\Phi(2) = 0.98$，所以用 $z_{0.02} = -2$（近似）。

要求：
$$\frac{2000 - 100n}{30\sqrt{n}} \leq -2$$

$$2000 - 100n \leq -60\sqrt{n}$$

$$100n - 60\sqrt{n} - 2000 \geq 0$$

令 $u = \sqrt{n}$：
$$100u^2 - 60u - 2000 \geq 0$$

用求根公式：
$$u = \frac{60 \pm \sqrt{3600 + 800000}}{200} = \frac{60 \pm \sqrt{803600}}{200} = \frac{60 \pm 896.4}{200}$$

取正根：
$$u = \frac{60 + 896.4}{200} = \frac{956.4}{200} = 4.782$$

$$n = u^2 = 22.87$$

取整數：$n = 23$。

**驗證**：n = 23 時，$E[S_{23}] = 2300$，$\sigma = 30\sqrt{23} \approx 143.9$

$$P(S_{23} \geq 2000) = P\left(Z \geq \frac{2000 - 2300}{143.9}\right) = P(Z \geq -2.085) = \Phi(2.085) \approx 0.981 > 0.98 \quad \checkmark$$

n = 22 時：$E = 2200$，$\sigma = 30\sqrt{22} \approx 140.7$

$$P(S_{22} \geq 2000) = P(Z \geq -1.42) = \Phi(1.42) \approx 0.922 < 0.98 \quad \times$$

$$\boxed{n = 23 \text{ 個燈泡}}$$

---

## 題目 S3.12（林守德 102-2 期末考）

A statistics department at a large university maintains a tutoring service for students. The hypothesis is that 40% of the students using the service would be from business department, 30% from engineering department, 20% from social science department and 10% from agriculture. A random sample of 120 students revealed that 52, 38, 21, 9 students from each department, respectively. Using Chi-square test to check whether the sampling results follow the hypothesis with α = 0.05. (8 pts)

### 詳解

**假設檢定**：
- $H_0$：學生比例為 40%（商）、30%（工）、20%（社科）、10%（農）
- $H_1$：至少一個比例不符合

**期望人數**（n = 120）：

| 科系 | 觀察值 $O_i$ | 期望值 $E_i$ |
|------|-------------|-------------|
| 商學 | 52 | 120 × 0.4 = 48 |
| 工程 | 38 | 120 × 0.3 = 36 |
| 社科 | 21 | 120 × 0.2 = 24 |
| 農學 | 9  | 120 × 0.1 = 12 |

**計算卡方統計量**：
$$\chi^2 = \sum_{i=1}^{4} \frac{(O_i - E_i)^2}{E_i}$$

$$= \frac{(52-48)^2}{48} + \frac{(38-36)^2}{36} + \frac{(21-24)^2}{24} + \frac{(9-12)^2}{12}$$

$$= \frac{16}{48} + \frac{4}{36} + \frac{9}{24} + \frac{9}{12}$$

$$= 0.333 + 0.111 + 0.375 + 0.750$$

$$= 1.569$$

**自由度** = k - 1 = 4 - 1 = 3

**臨界值**：$\chi^2_{0.05, 3} = 7.815$

**結論**：$\chi^2 = 1.569 < 7.815$，**不拒絕 $H_0$**。

$$\boxed{\text{在 } \alpha = 0.05 \text{ 下，沒有足夠證據拒絕假設的比例分配。樣本與假設分布一致。}}$$

---

## 題目 S3.13（林守德 102-2 期末考）

You want to build an automatic process to correct "Chinese sentences" (中式英文) with misused verb. For example, you want the system to automatically correct 'I opened the light' to 'I turn on the light'. You are given a large set of English sentences written by native-Chinese writers, and a large set of sentences from native English speakers. Please describe how you use n-gram language model and noisy channel model to resolve this problem. (10 pts)

### 詳解

**問題定義**：
- 輸入：含有中式英文的句子（如 "I opened the light"）
- 輸出：正確的英文句子（如 "I turn on the light"）

**Noisy Channel Model 框架**：

將問題建模為：正確句子 $W$ 通過一個「noisy channel」（中文母語者的干擾）變成了錯誤句子 $O$。

$$\hat{W} = \arg\max_W P(W \mid O) = \arg\max_W \frac{P(O \mid W) \cdot P(W)}{P(O)} = \arg\max_W P(O \mid W) \cdot P(W)$$

其中：
- **$P(W)$ — Language Model（語言模型）**：正確英文句子的先驗機率
- **$P(O \mid W)$ — Channel Model（通道模型）**：正確句子被「誤用」成錯誤句子的機率

---

**Step 1：建立 Language Model $P(W)$**

使用 native English speakers 的大量句子訓練 **n-gram language model**：

$$P(W) = P(w_1, w_2, \ldots, w_m) = \prod_{i=1}^{m} P(w_i \mid w_{i-n+1}, \ldots, w_{i-1})$$

例如 bigram model：
$$P(\text{"I turn on the light"}) = P(\text{I}) \cdot P(\text{turn} \mid \text{I}) \cdot P(\text{on} \mid \text{turn}) \cdot P(\text{the} \mid \text{on}) \cdot P(\text{light} \mid \text{the})$$

n-gram 機率通過在 native English 語料庫上統計 n-gram 頻率得到。

---

**Step 2：建立 Channel Model $P(O \mid W)$**

利用中式英文語料庫和正確英文語料庫（若有對齊的平行語料最好），統計動詞誤用的模式。

例如：統計中文母語者把 "turn on" 誤用為 "open" 的機率、把 "take" 誤用為 "eat" 的機率等。

$$P(O \mid W) = P(\text{"I opened the light"} \mid \text{"I turn on the light"})$$

通常只需要關注動詞的替換機率（假設其他詞保持不變）：
$$P(\text{open} \mid \text{turn on}) = \frac{\text{count(open 被用來替代 turn on)}}{\text{count(turn on 的正確使用)}}$$

---

**Step 3：解碼（Decoding）**

對於輸入的中式英文句子 $O$：
1. 識別可能被誤用的動詞
2. 生成所有可能的候選替換 $W$
3. 對每個候選計算 $P(O \mid W) \cdot P(W)$
4. 選擇得分最高的 $W$ 作為修正結果

$$\boxed{\hat{W} = \arg\max_W \underbrace{P(O|W)}_{\text{channel model}} \cdot \underbrace{P(W)}_{\text{n-gram LM}}}$$

---

## 題目 S3.14（林守德 102-2 期末考）

If $X_1, \ldots, X_n$ are iid and uniformly distributed between $[\theta_l, \theta_u]$, please find the maximum likelihood estimation of $\theta_l$ and $\theta_u$. (8 pts)

### 詳解

**似然函數**：
$$L(\theta_l, \theta_u) = \prod_{i=1}^n f(X_i; \theta_l, \theta_u) = \prod_{i=1}^n \frac{1}{\theta_u - \theta_l} \cdot \mathbf{1}(\theta_l \leq X_i \leq \theta_u)$$

$$= \frac{1}{(\theta_u - \theta_l)^n} \cdot \mathbf{1}(\theta_l \leq X_{(1)}) \cdot \mathbf{1}(X_{(n)} \leq \theta_u)$$

其中 $X_{(1)} = \min_i X_i$，$X_{(n)} = \max_i X_i$ 是 order statistics。

**MLE 分析**：

似然函數在以下限制條件下才不為零：
$$\theta_l \leq X_{(1)} \quad \text{且} \quad \theta_u \geq X_{(n)}$$

在此限制下，$L(\theta_l, \theta_u) = \frac{1}{(\theta_u - \theta_l)^n}$。

為了**最大化** $L$，需要**最小化** $(\theta_u - \theta_l)^n$，即最小化 $\theta_u - \theta_l$。

在限制條件下：
- $\theta_l$ 越大越好（但不超過 $X_{(1)}$）→ $\hat{\theta}_l = X_{(1)}$
- $\theta_u$ 越小越好（但不小於 $X_{(n)}$）→ $\hat{\theta}_u = X_{(n)}$

$$\boxed{\hat{\theta}_l^{MLE} = X_{(1)} = \min(X_1, \ldots, X_n), \quad \hat{\theta}_u^{MLE} = X_{(n)} = \max(X_1, \ldots, X_n)}$$

**備註**：MLE 是有偏的（低估範圍），因為 $E[X_{(1)}] > \theta_l$ 且 $E[X_{(n)}] < \theta_u$。無偏修正為：

$$\tilde{\theta}_l = X_{(1)} - \frac{X_{(n)} - X_{(1)}}{n-1}, \quad \tilde{\theta}_u = X_{(n)} + \frac{X_{(n)} - X_{(1)}}{n-1}$$

---

## 題目 S3.15（林守德 102-2 期末考）

A coin (whose head-rate is p) is flipped until the first head occurs. Let X denote the number of flips required.

(b) Let Y denote the number of flips until the second head appears. Thus, for example, Y=5 if the second head appears on the 5th flip. Is H(Y) larger, smaller, or equal to 2H(X)? Explain your solution. (5 pts)

### 詳解

已知 X ~ Geometric(p)，代表第一次出現正面所需的翻轉次數。

Y = 第二次正面出現的翻轉次數。Y 可以分解為 $Y = X_1 + X_2$，其中 $X_1, X_2$ 是兩個獨立的 Geometric(p) 隨機變數（$X_1$ = 第一次正面的等待，$X_2$ = 第一次正面後到第二次正面的等待）。

所以 Y 服從**負二項分布** NB(2, p)。

**比較 H(Y) 與 2H(X)**：

由資訊理論的性質：
$$H(Y) = H(X_1 + X_2) \leq H(X_1) + H(X_2) = 2H(X)$$

等號成立的條件是 $X_1$ 和 $X_2$ 獨立**且**知道 $Y = X_1 + X_2$ 時能完全恢復 $X_1$ 和 $X_2$ 各自的值。但 $H(X_1 + X_2) = H(X_1) + H(X_2)$ 需要 $X_1 + X_2$ 與 $(X_1, X_2)$ 之間是一對一映射，這顯然不成立（例如 $Y = 5$ 可以是 $X_1 = 1, X_2 = 4$ 或 $X_1 = 2, X_2 = 3$ 等多種組合）。

更正式地：
$$H(Y) = H(X_1 + X_2) \leq H(X_1, X_2) = H(X_1) + H(X_2) = 2H(X)$$

第一個不等式來自：$(X_1, X_2) \to X_1 + X_2$ 是一個函數，函數的 entropy ≤ 原始的 entropy。

等號不成立因為加法不是一對一映射。

$$\boxed{H(Y) < 2H(X)}$$

**直覺**：Y = X₁ + X₂ 丟失了 X₁ 和 X₂ 各自的資訊（只知道和，不知道個別值），所以 uncertainty 更小。

---

## 題目 S3.16（林守德 102-2 期末考）

在獵人試煉中，小傑和他的夥伴到達了最後一關。尼特羅會長（主考官）要求各位交出自己的分數公式。而要成為一個頂尖的獵人，最重要的就是體力和智力。小傑的體力是200（全部人的平均是150，變異數是40），智力為100（全部人的平均是130，變異數是30），而我們知道體力和智力是獨立的，所以小傑交出了公式為 Grade = 0.75 × Energy + 0.25 × Intelligence。

請問 Cov(Energy, Grade) 為多少？ (10pts)

### 詳解

**給定資訊**：
- Energy (E)：$\mu_E = 150$, $\text{Var}(E) = 40$
- Intelligence (I)：$\mu_I = 130$, $\text{Var}(I) = 30$
- E 和 I **獨立**，所以 $\text{Cov}(E, I) = 0$
- Grade $G = 0.75E + 0.25I$

**求 Cov(E, G)**：

$$\text{Cov}(E, G) = \text{Cov}(E, \; 0.75E + 0.25I)$$

利用 covariance 的線性性質：
$$= 0.75 \cdot \text{Cov}(E, E) + 0.25 \cdot \text{Cov}(E, I)$$

$$= 0.75 \cdot \text{Var}(E) + 0.25 \times 0$$

$$= 0.75 \times 40$$

$$\boxed{\text{Cov}(E, G) = 30}$$

---

# 三、101下 林守德 期末考（新增 1 題）

---

## 題目 S3.17（林守德 101-2 期末考）

In the class, we have discussed the n-gram language model. Indeed there is a tradeoff in determining n: larger n allows us to model the longer-distance dependency among words without significantly increasing the storage size? (10pts)

### 詳解

**n-gram 語言模型簡介**：

n-gram 模型假設一個詞的出現機率只取決於前 n-1 個詞：
$$P(w_i \mid w_1, w_2, \ldots, w_{i-1}) \approx P(w_i \mid w_{i-n+1}, \ldots, w_{i-1})$$

**n 的取捨（Tradeoff）**：

| | 大 n（例如 5-gram） | 小 n（例如 bigram） |
|---|---|---|
| **優點** | 捕捉更長距離的詞序依賴關係，模型更精確 | 儲存空間小、需要較少訓練數據 |
| **缺點** | 參數爆炸（若詞彙量 V，參數量 $O(V^n)$）、數據稀疏（許多 n-gram 在訓練中未出現） | 無法捕捉長距離依賴 |

**具體分析**：

1. **儲存空間**：n-gram 模型需要儲存所有觀察到的 n-gram 及其計數。若詞彙量為 V，理論上最多有 $V^n$ 個不同的 n-gram。n 每增加 1，儲存量最多增加 V 倍。

2. **數據稀疏問題（Data Sparsity）**：訓練語料中大量的 n-gram 會只出現 0 次或 1 次，導致機率估計不可靠。這是大 n 的主要問題。

3. **解決方案**：
   - **Smoothing（平滑化）**：如 Laplace smoothing、Good-Turing smoothing
   - **Backoff**：高階 n-gram 沒見過時，退回到低階（例如從 trigram 退回 bigram）
   - **Interpolation（插值）**：$P_{\text{interp}}(w_i | w_{i-2}, w_{i-1}) = \lambda_3 P_3 + \lambda_2 P_2 + \lambda_1 P_1$

**回答題目**：

較大的 n **確實**能建模更長距離的依賴，但**會**顯著增加儲存量（$O(V^n)$），且因數據稀疏使估計品質下降。實務上通常使用 n = 3（trigram）作為平衡點，配合 smoothing 和 backoff 技術。

$$\boxed{\text{大 n：長距離依賴 vs. 儲存空間爆炸 + 數據稀疏。通常用 trigram + smoothing 折衷。}}$$

---

# 四、103下 林守德 期末考（新增 8 題）

---

## 題目 S3.18（林守德 103-2 期末考）

John builds an auto-translation tool, and wants to claim that the tool he builds is better than the Google Translator (whose accuracy is 75%). He tested on 100 sentences and found 76 of them were translated correctly.

(a) What is the 95% confidence interval of the accuracy of his system? (hint: $Z_{0.05}=1.65$, $Z_{0.025}=1.96$) Can you use confidence interval to convince people John's system is better? (6pts)

(b) Given $H_0$: accuracy = 75%, what is the p-value? You don't need to calculate the exact p-value, just list its equation is good enough. (6pts)

### 詳解

**(a) 95% 信賴區間**

樣本比例 $\hat{p} = 76/100 = 0.76$，n = 100。

95% 信賴區間（雙尾）：
$$\hat{p} \pm Z_{0.025} \sqrt{\frac{\hat{p}(1-\hat{p})}{n}} = 0.76 \pm 1.96 \sqrt{\frac{0.76 \times 0.24}{100}}$$

$$= 0.76 \pm 1.96 \sqrt{0.001824} = 0.76 \pm 1.96 \times 0.04271$$

$$= 0.76 \pm 0.0837$$

$$\text{95\% CI} = (0.6763, \; 0.8437)$$

**能否說服 John 的系統更好？**

不能。因為 75% = 0.75 落在信賴區間 (0.6763, 0.8437) 之內，所以我們**無法排除** John 系統的真實準確率就是 75% 的可能性。信賴區間包含了 Google 的 75%，不能用這個結果宣稱 John 的系統顯著更好。

$$\boxed{\text{95\% CI} = (0.676, \; 0.844). \text{ 包含 0.75，無法證明顯著更好。}}$$

**(b) p-value**

假設 $H_0: p = 0.75$（單尾檢定，因為我們想證明「更好」= 準確率 > 75%）。

檢定統計量：
$$Z = \frac{\hat{p} - p_0}{\sqrt{p_0(1-p_0)/n}} = \frac{0.76 - 0.75}{\sqrt{0.75 \times 0.25 / 100}} = \frac{0.01}{\sqrt{0.001875}} = \frac{0.01}{0.04330} = 0.2309$$

p-value（右尾）：
$$\text{p-value} = P(Z > 0.2309) = 1 - \Phi(0.2309)$$

$$\boxed{\text{p-value} = 1 - \Phi\left(\frac{0.76 - 0.75}{\sqrt{0.75 \times 0.25 / 100}}\right) = 1 - \Phi(0.231) \approx 0.41}$$

p-value 非常大（約 41%），遠大於常用的 5% 顯著水準，因此**完全不能**拒絕 $H_0$。John 觀察到的 76% 很可能只是隨機波動。

---

## 題目 S3.19（林守德 103-2 期末考）

Suppose that $A_1$ and $A_2$ are independent uniform random variables on [0, 1]. Let $X = \max\{A_1, A_2\}$. Compute the probability density function for X. (6pts)

### 詳解

**CDF 法**：

$$F_X(x) = P(\max\{A_1, A_2\} \leq x) = P(A_1 \leq x, A_2 \leq x)$$

由獨立性：
$$= P(A_1 \leq x) \cdot P(A_2 \leq x) = x \cdot x = x^2, \quad 0 \leq x \leq 1$$

**PDF**：
$$f_X(x) = \frac{d}{dx} F_X(x) = 2x, \quad 0 \leq x \leq 1$$

**驗證**：$\int_0^1 2x \, dx = x^2 \Big|_0^1 = 1$ ✓

$$\boxed{f_X(x) = 2x, \quad 0 \leq x \leq 1}$$

**推廣**：若有 n 個獨立 Uniform(0,1)，$\max$ 的 PDF 為 $f(x) = nx^{n-1}$，這是 Beta(n, 1) 分布。

---

## 題目 S3.20（林守德 103-2 期末考）

X follows a uniform distribution on [0, 6]. Y follows exponential distribution with $\theta = 1/3$; Also X, Y are independent. Find the probability such that $Y \geq X$. (6pts)

### 詳解

$X \sim \text{Uniform}(0, 6)$，$f_X(x) = 1/6$，$0 \leq x \leq 6$

$Y \sim \text{Exp}(\lambda)$，其中 $\theta = 1/\lambda = 1/3$，所以 $\lambda = 3$。$f_Y(y) = 3e^{-3y}$，$y \geq 0$。

$$P(Y \geq X) = \int_0^6 \int_x^{\infty} \frac{1}{6} \cdot 3e^{-3y} \, dy \, dx$$

先計算內層積分：
$$\int_x^{\infty} 3e^{-3y} \, dy = \left[-e^{-3y}\right]_x^{\infty} = e^{-3x}$$

所以：
$$P(Y \geq X) = \int_0^6 \frac{1}{6} e^{-3x} \, dx = \frac{1}{6} \left[-\frac{1}{3}e^{-3x}\right]_0^6$$

$$= \frac{1}{6} \cdot \frac{1}{3} \left(1 - e^{-18}\right) = \frac{1}{18}\left(1 - e^{-18}\right)$$

由於 $e^{-18} \approx 1.5 \times 10^{-8} \approx 0$：

$$\boxed{P(Y \geq X) = \frac{1 - e^{-18}}{18} \approx \frac{1}{18} \approx 0.0556}$$

---

## 題目 S3.21（林守德 103-2 期末考）

Calculate the PageRank of A, B, C, D or provide a pseudo code telling us how to find the PageRank values of A, B, C, D. (8pts)

The link structure is:
B → A, B → C, C → A, C → D, D → A, D → B, A → D

### 詳解

**PageRank 模型**：

$$PR(i) = \sum_{j \to i} \frac{PR(j)}{L(j)}$$

其中 $L(j)$ 是節點 j 的出度（outgoing links 數量）。

**分析連結結構**：

| 節點 | 指向 | 出度 |
|------|------|------|
| A | D | 1 |
| B | A, C | 2 |
| C | A, D | 2 |
| D | A, B | 2 |

**PageRank 方程**（不含 damping factor 的簡化版）：

$$PR(A) = \frac{PR(B)}{2} + \frac{PR(C)}{2} + \frac{PR(D)}{2}$$

$$PR(B) = \frac{PR(D)}{2}$$

$$PR(C) = \frac{PR(B)}{2}$$

$$PR(D) = PR(A) + \frac{PR(C)}{2}$$

加上歸一化條件：$PR(A) + PR(B) + PR(C) + PR(D) = 1$

**求解**：

由第二和第三個方程：
$$PR(B) = \frac{PR(D)}{2}, \quad PR(C) = \frac{PR(B)}{2} = \frac{PR(D)}{4}$$

代入第四個方程：
$$PR(D) = PR(A) + \frac{PR(D)/4}{2} = PR(A) + \frac{PR(D)}{8}$$

$$\frac{7}{8}PR(D) = PR(A) \implies PR(A) = \frac{7}{8}PR(D)$$

代入第一個方程：
$$\frac{7}{8}PR(D) = \frac{PR(D)/2}{2} + \frac{PR(D)/4}{2} + \frac{PR(D)}{2}$$

$$\frac{7}{8}PR(D) = \frac{PR(D)}{4} + \frac{PR(D)}{8} + \frac{PR(D)}{2} = \frac{2+1+4}{8}PR(D) = \frac{7}{8}PR(D)$$

方程恆成立！使用歸一化條件：

$$PR(A) + PR(B) + PR(C) + PR(D) = 1$$

$$\frac{7}{8}PR(D) + \frac{1}{2}PR(D) + \frac{1}{4}PR(D) + PR(D) = 1$$

$$PR(D)\left(\frac{7}{8} + \frac{1}{2} + \frac{1}{4} + 1\right) = 1$$

$$PR(D) \times \frac{7+4+2+8}{8} = PR(D) \times \frac{21}{8} = 1$$

$$PR(D) = \frac{8}{21}$$

$$PR(A) = \frac{7}{8} \times \frac{8}{21} = \frac{7}{21} = \frac{1}{3}$$

$$PR(B) = \frac{1}{2} \times \frac{8}{21} = \frac{4}{21}$$

$$PR(C) = \frac{1}{4} \times \frac{8}{21} = \frac{2}{21}$$

**驗證**：$\frac{1}{3} + \frac{4}{21} + \frac{2}{21} + \frac{8}{21} = \frac{7}{21} + \frac{4}{21} + \frac{2}{21} + \frac{8}{21} = \frac{21}{21} = 1$ ✓

$$\boxed{PR(A) = \frac{1}{3} \approx 0.333, \; PR(B) = \frac{4}{21} \approx 0.190, \; PR(C) = \frac{2}{21} \approx 0.095, \; PR(D) = \frac{8}{21} \approx 0.381}$$

**Pseudo code（含 damping factor $d$ 的版本）**：

```
N = 4  # number of nodes
d = 0.85  # damping factor
PR = {A: 1/N, B: 1/N, C: 1/N, D: 1/N}
repeat until convergence:
    new_PR[A] = (1-d)/N + d * (PR[B]/2 + PR[C]/2 + PR[D]/2)
    new_PR[B] = (1-d)/N + d * (PR[D]/2)
    new_PR[C] = (1-d)/N + d * (PR[B]/2)
    new_PR[D] = (1-d)/N + d * (PR[A]/1 + PR[C]/2)
    PR = new_PR
```

---

## 題目 S3.22（林守德 103-2 期末考）

Consider throwing 60 four-sided unbiased dice all together at a time and observe their total sum. Assume that you perform the experiment 2000 times. After the experiments, you plot the observed counts corresponding to all possible sums (from 60 to 240). Give the continuous function that you think best fits the observed data plot. (8pts)

### 詳解

**分析**：

一顆四面骰子 $X_i$ 的值 ∈ {1, 2, 3, 4}：
$$E[X_i] = \frac{1+2+3+4}{4} = 2.5$$

$$E[X_i^2] = \frac{1+4+9+16}{4} = 7.5$$

$$\text{Var}(X_i) = 7.5 - 6.25 = 1.25$$

60 顆骰子的總和 $S = \sum_{i=1}^{60} X_i$：
$$E[S] = 60 \times 2.5 = 150$$

$$\text{Var}(S) = 60 \times 1.25 = 75, \quad \sigma_S = \sqrt{75} = 5\sqrt{3} \approx 8.66$$

由**中央極限定理**，S 近似常態分布：
$$S \sim N(150, 75)$$

進行 2000 次實驗，觀察計數的分布。令 $f(s)$ 為 $S$ 的 PDF，則在每個 sum 值 s 附近的期望計數 ≈ $2000 \times f(s)$。

**最佳擬合的連續函數**（觀察計數的分布）：

$$\text{Count}(s) \approx 2000 \times \frac{1}{\sqrt{2\pi \times 75}} \exp\left(-\frac{(s - 150)^2}{2 \times 75}\right)$$

$$= \frac{2000}{\sqrt{150\pi}} \exp\left(-\frac{(s-150)^2}{150}\right)$$

$$\boxed{f(s) = \frac{2000}{\sqrt{150\pi}} \exp\left(-\frac{(s - 150)^2}{150}\right) \approx \frac{2000}{21.71} \exp\left(-\frac{(s-150)^2}{150}\right)}$$

即**均值 150、變異數 75 的常態曲線，乘以 2000（總實驗次數）**。

---

## 題目 S3.23（林守德 103-2 期末考）

Let X have a gamma distribution with $\alpha = 2$ and $\theta = 2$. Please find the probability density function of $Y = e^{2X}$. (8pts)

### 詳解

$X \sim \text{Gamma}(2, 2)$，PDF 為：

$$f_X(x) = \frac{x^{\alpha-1} e^{-x/\theta}}{\theta^\alpha \Gamma(\alpha)} = \frac{x \cdot e^{-x/2}}{4 \cdot 1} = \frac{x e^{-x/2}}{4}, \quad x > 0$$

**變數變換**：$Y = e^{2X}$

求反函數：$X = \frac{1}{2}\ln Y$，$\frac{dX}{dY} = \frac{1}{2Y}$

定義域：$X > 0 \Rightarrow Y > 1$

$$f_Y(y) = f_X\left(\frac{\ln y}{2}\right) \cdot \left|\frac{dX}{dY}\right|$$

$$= \frac{\frac{\ln y}{2} \cdot e^{-\frac{\ln y}{4}}}{4} \cdot \frac{1}{2y}$$

$$= \frac{\ln y \cdot y^{-1/4}}{16y}$$

$$= \frac{\ln y}{16 y^{5/4}}$$

**驗證定義域**：$X > 0 \Rightarrow \ln Y > 0 \Rightarrow Y > 1$。

$$\boxed{f_Y(y) = \frac{\ln y}{16 \, y^{5/4}}, \quad y > 1}$$

---

## 題目 S3.24（林守德 103-2 期末考）

(a) $Y = x_1 + x_2$, and $M_{x_1}(t) = \frac{e^t - 1}{t}$, $M_{x_2}(t) = \frac{t \cdot e^{t^2/2}}{e^t - 1}$.

Use Chebyshev's inequality to find the lower bound of $P(-2 < Y < 2)$. (7pts)

(b) Do you think this lower bound attained from Chebyshev's inequality is tight? Explain your answer (hint: use the lookup table we provide). (7pts)

### 詳解

**(a) 求 E[Y] 和 Var(Y)**

$Y = x_1 + x_2$，$M_Y(t) = M_{x_1}(t) \cdot M_{x_2}(t)$。

$$M_Y(t) = \frac{e^t - 1}{t} \cdot \frac{t \cdot e^{t^2/2}}{e^t - 1} = e^{t^2/2}$$

這是 **標準常態分布 N(0, 1)** 的 MGF！

所以 $Y \sim N(0, 1)$，$E[Y] = 0$，$\text{Var}(Y) = 1$。

也可以從各自的 MGF 推導：

**$x_1$ 的 moments**：$M_{x_1}(t) = \frac{e^t - 1}{t}$

$M_{x_1}'(t) = \frac{te^t - (e^t - 1)}{t^2} = \frac{(t-1)e^t + 1}{t^2}$

$E[x_1] = M_{x_1}'(0) = \lim_{t \to 0} \frac{(t-1)e^t + 1}{t^2}$

用 L'Hôpital 法則（兩次）或 Taylor 展開：$e^t = 1 + t + t^2/2 + \cdots$

$(t-1)(1+t+t^2/2+\cdots)+1 = t+t^2+t^3/2-1-t-t^2/2+1 = t^2/2 + O(t^3)$

所以 $E[x_1] = 1/2$。

類似可得 $E[x_1^2] = 1/3$，$\text{Var}(x_1) = 1/3 - 1/4 = 1/12$。（$x_1 \sim \text{Uniform}(0,1)$）

**$x_2$ 的性質**：由 $M_Y = e^{t^2/2}$，$Y = x_1 + x_2 \sim N(0,1)$。

$E[Y] = E[x_1] + E[x_2] = 0 \Rightarrow E[x_2] = -1/2$

$\text{Var}(Y) = \text{Var}(x_1) + \text{Var}(x_2) = 1 \Rightarrow \text{Var}(x_2) = 1 - 1/12 = 11/12$

**Chebyshev 不等式**：

$$P(|Y - E[Y]| \geq k) \leq \frac{\text{Var}(Y)}{k^2}$$

$$P(|Y| \geq 2) \leq \frac{1}{4}$$

$$P(-2 < Y < 2) = 1 - P(|Y| \geq 2) \geq 1 - \frac{1}{4} = \frac{3}{4}$$

$$\boxed{P(-2 < Y < 2) \geq \frac{3}{4} = 0.75 \quad \text{(Chebyshev lower bound)}}$$

**(b) 這個下界緊嗎？**

不緊。因為 $Y \sim N(0,1)$，查標準常態分布表：

$$P(-2 < Y < 2) = 2\Phi(2) - 1 = 2 \times 0.9772 - 1 = 0.9544$$

Chebyshev 的下界 0.75 遠低於真實值 0.9544。

原因是 Chebyshev 不等式**對所有分布都成立**，沒有利用常態分布的特殊形狀（尾部衰減很快）。常態分布的尾部比 Chebyshev 假設的「最壞情形」輕得多。

$$\boxed{\text{不緊。真實值 } P(-2 < Y < 2) = \Phi(2) - \Phi(-2) \approx 0.9544 \gg 0.75}$$

---

## 題目 S3.25（林守德 103-2 期末考）

Suppose two random points are chosen independently and uniformly from the unit square $[0, 1] \times [0, 1]$, and let D denote the distance between the two points $(X_1, Y_1)$ and $(X_2, Y_2)$.

$$D^2 = (X_1 - X_2)^2 + (Y_1 - Y_2)^2$$

Find $E(D^2)$. (8pts)

**（注：此題與題庫 9.2 相同，但原出處為 103-2 期末考。此處提供另一種解法作為補充。）**

### 詳解

$$E[D^2] = E[(X_1 - X_2)^2 + (Y_1 - Y_2)^2] = E[(X_1 - X_2)^2] + E[(Y_1 - Y_2)^2]$$

由對稱性，兩項相同。計算 $E[(X_1 - X_2)^2]$：

**方法一（直接展開）**：
$$E[(X_1 - X_2)^2] = E[X_1^2] - 2E[X_1]E[X_2] + E[X_2^2]$$

$X_1, X_2 \sim \text{Uniform}(0,1)$：$E[X] = 1/2$，$E[X^2] = 1/3$

$$= \frac{1}{3} - 2 \times \frac{1}{4} + \frac{1}{3} = \frac{2}{3} - \frac{1}{2} = \frac{1}{6}$$

**方法二（Var 公式）**：
$$E[(X_1-X_2)^2] = \text{Var}(X_1 - X_2) + [E(X_1-X_2)]^2 = \text{Var}(X_1) + \text{Var}(X_2) + 0 = \frac{1}{12} + \frac{1}{12} = \frac{1}{6}$$

因此：
$$\boxed{E[D^2] = \frac{1}{6} + \frac{1}{6} = \frac{1}{3}}$$

---

# 附錄：各來源題目對照表

| 考卷 | 題號 | 狀態 | 補充題庫編號 |
|------|------|------|-------------|
| **102-2 期中考** | Q1 Independence | 新增 | S3.1 |
| | Q2 太陽花 (a) | 新增 | S3.2 |
| | Q2 太陽花 (b) | 已收錄 (19.1) | — |
| | Q3 Monty Hall | 已收錄 (27.1) | — |
| | Q4 Watermelon | 新增 | S3.3 |
| | Q5 Estimate π | 已收錄 (27.2) | — |
| | Q6 Bayes | 新增 | S3.4 |
| | Q7 Exponential | 已收錄 (25.1) | — |
| | Q8 Poisson | 新增 | S3.5 |
| | Q9 Amy concert | 新增 | S3.6 |
| | Q10 Movie theater | 新增 | S3.7 |
| | Q11 Zombie | 新增 | S3.8 |
| | Q12 MMORPG | 新增 | S3.9 |
| **102-2 期末考** | Q1(b)(c) Short answer | 新增 | S3.10 |
| | Q1(a)(d) Short answer | 已收錄 (8.1) | — |
| | Q2 選擇題 | 已收錄 (23.1) | — |
| | Q3 Joint density | 已收錄 (22.3) | — |
| | Q4 燈泡 | 新增 | S3.11 |
| | Q5 Gamma sum | 已收錄 (5.1) | — |
| | Q6 Chi-square | 新增 | S3.12 |
| | Q7 Chinglish | 新增 | S3.13 |
| | Q8 MLE Uniform | 新增 | S3.14 |
| | Q9(a) Entropy | 已收錄 (24.1) | — |
| | Q9(b) H(Y) vs 2H(X) | 新增 | S3.15 |
| | Q10 饅頭 | 已收錄 (27.3) | — |
| | Q11 C-Power | 已收錄 (23.3) | — |
| | Q12 獵人 Covariance | 新增 | S3.16 |
| **101-2 期末考** | Q1-Q5, Q7-Q12 | 已收錄 | — |
| | Q6 n-gram tradeoff | 新增 | S3.17 |
| **103-2 期末考** | Q1 CI + p-value | 新增 | S3.18 |
| | Q2 max of uniforms | 新增 | S3.19 |
| | Q3 P(Y≥X) | 新增 | S3.20 |
| | Q4 Estimate π | 已收錄 (27.2) | — |
| | Q5 PageRank | 新增 | S3.21 |
| | Q6 Chinglish | 與 S3.13 近似 | — |
| | Q7 CLT dice | 新增 | S3.22 |
| | Q8 Gamma transform | 新增 | S3.23 |
| | Q9 MLE Geometric | 已收錄 (26.2) | — |
| | Q10 Chebyshev | 新增 | S3.24 |
| | Q11 E(D²) | 已收錄 (9.2) | S3.25 (補充解法) |
| | Q12 Chi-square RPS | 已收錄 (14.3) | — |
| | Q13 Mutual info die | 已收錄 (24.2) | — |
| | Q14 Entropy proof | 已收錄 (8.3) | — |
