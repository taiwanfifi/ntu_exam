# 控制系統（二）：時域響應分析

## 🔰 本章基礎觀念（零基礎必讀）

> 上一章你學會了如何用轉移函數 G(s) 描述系統。現在的問題是：**給系統一個輸入後，輸出到底長什麼樣子？** 多快到達？會不會震盪超過目標？最後能不能穩定下來？這就是時域響應分析。想像你按下電梯按鈕（步階輸入），電梯要多久到？會不會衝過頭再回來？這些都可以用本章的公式算出來。

---

## 一、典型測試訊號

| 測試訊號 | 時域 | s 域 | 用途 |
|----------|------|------|------|
| 脈衝 δ(t) | δ(t) | 1 | 測系統本身特性 |
| 步階 u(t) | 1 (t≥0) | 1/s | 最常用！測暫態+穩態 |
| 斜坡 tu(t) | t (t≥0) | 1/s² | 測追蹤等速輸入能力 |
| 拋物線 ½t²u(t) | ½t² | 1/s³ | 測追蹤加速輸入能力 |

> 最重要的是**步階響應（Step Response）**，考試九成以上都考這個。

---

## 二、一階系統響應

### 2.1 一階系統標準式

$$G(s) = \frac{1}{\tau s + 1}$$

其中 τ 為**時間常數（Time Constant）**。

### 2.2 步階響應

輸入 R(s) = 1/s，輸出：

$$Y(s) = G(s) \cdot R(s) = \frac{1}{s(\tau s + 1)} = \frac{1}{s} - \frac{1}{s + 1/\tau}$$

取拉普拉斯反轉換：

$$\boxed{y(t) = 1 - e^{-t/\tau}, \quad t \geq 0}$$

### 2.3 時間常數 τ 的物理意義

| 時間 | y(t) 值 | 白話意義 |
|------|---------|----------|
| t = τ | 1 - e⁻¹ ≈ 0.632 | 到達最終值的 63.2% |
| t = 2τ | 1 - e⁻² ≈ 0.865 | 到達 86.5% |
| t = 3τ | 1 - e⁻³ ≈ 0.950 | 到達 95.0% |
| t = 4τ | 1 - e⁻⁴ ≈ 0.982 | 到達 98.2%（常取為安定時間）|
| t = 5τ | 1 - e⁻⁵ ≈ 0.993 | 到達 99.3% |

> **口訣**：1τ → 63%，4τ → 98%（2% 安定），5τ → 99%

**【例題 1】RC 電路步階響應**

RC 電路 G(s) = 1/(0.5s + 1)，輸入步階 5V。求：
(a) 時間常數
(b) 到達最終值 90% 所需時間

**解**：
(a) τ = 0.5 秒

(b) 最終值 = 5V。要求 y(t) = 0.9 × 5 = 4.5V
$$5(1 - e^{-t/0.5}) = 4.5$$
$$1 - e^{-2t} = 0.9$$
$$e^{-2t} = 0.1$$
$$t = \frac{\ln 10}{2} = \frac{2.303}{2} \approx 1.15 \text{ 秒}$$

---

## 三、二階系統響應

### 3.1 二階系統標準式

$$\boxed{G(s) = \frac{\omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2}}$$

- **$\omega_n$**：自然頻率（Natural Frequency），單位 rad/s
- **$\zeta$**（zeta）：阻尼比（Damping Ratio），無單位

### 3.2 特徵方程式與極點

特徵方程式：$s^2 + 2\zeta\omega_n s + \omega_n^2 = 0$

極點：$s = -\zeta\omega_n \pm \omega_n\sqrt{\zeta^2 - 1}$

### 3.3 四種阻尼情況

| 阻尼比範圍 | 類型 | 極點性質 | 響應特徵 |
|-----------|------|----------|----------|
| ζ > 1 | 過阻尼（Overdamped）| 兩個不同的負實數極點 | 慢慢上升，不震盪 |
| ζ = 1 | 臨界阻尼（Critically Damped）| 兩個相同的負實數極點 | 最快不震盪到達 |
| 0 < ζ < 1 | 欠阻尼（Underdamped）| 共軛複數極點 | 震盪後收斂（最常見！）|
| ζ = 0 | 無阻尼（Undamped）| 純虛數極點 | 永遠震盪不停 |

### 3.4 欠阻尼系統（0 < ζ < 1）的詳細分析

極點位置：$s = -\zeta\omega_n \pm j\omega_d$

其中 $\omega_d = \omega_n\sqrt{1-\zeta^2}$ 為**阻尼自然頻率（Damped Natural Frequency）**

步階響應：
$$y(t) = 1 - \frac{e^{-\zeta\omega_n t}}{\sqrt{1-\zeta^2}} \sin(\omega_d t + \phi), \quad \phi = \cos^{-1}\zeta$$

> 重點：響應是**衰減的正弦波**疊加在最終值 1 上。

### 3.5 極點在複數平面上的幾何關係

```
        jω
        ↑
        |    × s = -ζωn + jωd
        |   /|
        |  / |
   ωn  | /  | ωd = ωn√(1-ζ²)
        |/θ  |
   ─────+─────→ σ
        |  σd = ζωn
        |
        |    × s = -ζωn - jωd（共軛）
```

- θ = cos⁻¹(ζ)：極點與負實軸的夾角
- ζ = cos(θ)
- σ_d = ζω_n：極點的實部大小（衰減率）
- ω_d = ω_n sin(θ)：極點的虛部（振盪頻率）

---

## 四、暫態響應規格（Transient Response Specifications）

以下均針對**欠阻尼二階系統的單位步階響應**。

### 4.1 上升時間 tr（Rise Time）

從最終值的 10% 上升到 90% 所需的時間（也有定義為 0% 到 100%）。

$$\boxed{t_r = \frac{\pi - \phi}{\omega_d}}, \quad \phi = \cos^{-1}\zeta$$

近似公式：$t_r \approx \frac{1.8}{\omega_n}$（當 ζ 適中時）

### 4.2 峰值時間 tp（Peak Time）

響應第一次到達最大值的時間。

$$\boxed{t_p = \frac{\pi}{\omega_d} = \frac{\pi}{\omega_n\sqrt{1-\zeta^2}}}$$

### 4.3 最大超越量 Mp（Maximum Overshoot）

響應超過最終值的最大百分比。

$$\boxed{M_p = e^{-\zeta\pi / \sqrt{1-\zeta^2}} \times 100\%}$$

> **重要性質**：Mp 只跟 ζ 有關，跟 ωn 無關！

| ζ | Mp (%) |
|---|--------|
| 0 | 100% |
| 0.1 | 72.9% |
| 0.2 | 52.7% |
| 0.3 | 37.2% |
| 0.4 | 25.4% |
| 0.5 | 16.3% |
| 0.6 | 9.5% |
| 0.7 | 4.6% |
| 0.8 | 1.5% |
| 0.9 | 0.2% |
| 1.0 | 0% |

### 4.4 安定時間 ts（Settling Time）

響應進入且停留在最終值 ±2%（或 ±5%）範圍內的時間。

$$\boxed{t_s \approx \frac{4}{\zeta\omega_n}} \quad \text{（2% 準則）}$$

$$t_s \approx \frac{3}{\zeta\omega_n} \quad \text{（5% 準則）}$$

> **記憶法**：$\zeta\omega_n$ 就是極點的實部大小 σ_d，所以 $t_s \approx 4/\sigma_d$。

---

## 五、暫態規格公式總整理

| 規格 | 公式 | 主要影響因素 |
|------|------|-------------|
| 上升時間 $t_r$ | $(\pi - \phi)/\omega_d$ | ωn 越大 → tr 越小 |
| 峰值時間 $t_p$ | $\pi/\omega_d$ | ωd 越大 → tp 越小 |
| 最大超越量 $M_p$ | $e^{-\zeta\pi/\sqrt{1-\zeta^2}}$ | 只跟 ζ 有關 |
| 安定時間 $t_s$ | $4/(\zeta\omega_n)$ | ζωn 越大 → ts 越小 |

> **設計矛盾**：要 Mp 小（ζ 大）↔ 要 tr 小（ζ 小）→ 需要折衷！

---

## 六、數值例題

**【例題 2】求暫態規格**

$$G(s) = \frac{25}{s^2 + 4s + 25}$$

**解**：
對比標準式 $\omega_n^2/(s^2 + 2\zeta\omega_n s + \omega_n^2)$：

- $\omega_n^2 = 25 \Rightarrow \omega_n = 5$ rad/s
- $2\zeta\omega_n = 4 \Rightarrow \zeta = 4/(2\times5) = 0.4$
- $\omega_d = 5\sqrt{1-0.16} = 5\times0.9165 = 4.583$ rad/s

計算各規格：
- $t_p = \pi/\omega_d = \pi/4.583 = 0.685$ 秒
- $M_p = e^{-0.4\pi/\sqrt{1-0.16}} = e^{-0.4\pi/0.9165} = e^{-1.370} = 0.254 = 25.4\%$
- $t_s = 4/(\zeta\omega_n) = 4/(0.4\times5) = 4/2 = 2$ 秒（2%準則）
- $t_r = (\pi - \cos^{-1}0.4)/4.583 = (\pi - 1.159)/4.583 = 1.982/4.583 = 0.432$ 秒

**【例題 3】由規格反推參數**

設計需求：$M_p \leq 20\%$，$t_s \leq 1$ 秒（2%準則）。求 ζ 和 ωn 的範圍。

**解**：

由 Mp ≤ 20%：
$$e^{-\zeta\pi/\sqrt{1-\zeta^2}} \leq 0.2$$
$$\frac{\zeta\pi}{\sqrt{1-\zeta^2}} \geq \ln 5 = 1.609$$

數值求解得 $\zeta \geq 0.456$

由 ts ≤ 1 秒：
$$\frac{4}{\zeta\omega_n} \leq 1 \Rightarrow \zeta\omega_n \geq 4$$

所以：$\zeta \geq 0.456$ 且 $\omega_n \geq 4/\zeta$

若取 ζ = 0.5，則 ωn ≥ 4/0.5 = 8 rad/s。

**【例題 4】過阻尼二階系統**

$$G(s) = \frac{6}{s^2 + 5s + 6} = \frac{6}{(s+2)(s+3)}$$

輸入單位步階，求 y(t)。

**解**：
$$Y(s) = \frac{6}{s(s+2)(s+3)}$$

部分分式展開：
$$Y(s) = \frac{A}{s} + \frac{B}{s+2} + \frac{C}{s+3}$$

- $A = \frac{6}{2\times3} = 1$
- $B = \frac{6}{(-2)(-2+3)} = \frac{6}{(-2)(1)} = -3$
- $C = \frac{6}{(-3)(-3+2)} = \frac{6}{(-3)(-1)} = 2$

$$y(t) = 1 - 3e^{-2t} + 2e^{-3t}, \quad t \geq 0$$

檢驗：y(0) = 1 - 3 + 2 = 0 ✓，y(∞) = 1 ✓

此為過阻尼（ζ > 1），無超越量，但響應較慢。

**【例題 5】從步階響應量測參數**

測量二階系統步階響應，得到：
- 最終值 = 2
- 第一個峰值 = 2.6（在 t = 0.5s 時）
- 安定時間 ts ≈ 2s（2%準則）

求 ωn 和 ζ。

**解**：
最大超越量：$M_p = (2.6-2)/2 = 0.3 = 30\%$

由 Mp 公式：
$$0.3 = e^{-\zeta\pi/\sqrt{1-\zeta^2}}$$
$$\ln 0.3 = -\frac{\zeta\pi}{\sqrt{1-\zeta^2}}$$
$$1.204 = \frac{\zeta\pi}{\sqrt{1-\zeta^2}}$$
$$1.449 = \frac{\zeta^2\pi^2}{1-\zeta^2}$$
$$1.449 - 1.449\zeta^2 = \zeta^2\pi^2$$
$$\zeta^2 = \frac{1.449}{1.449 + \pi^2} = \frac{1.449}{11.318} = 0.128$$
$$\zeta = 0.358$$

由 ts ≈ 4/(ζωn) = 2：
$$\omega_n = 4/(0.358 \times 2) = 5.59 \text{ rad/s}$$

驗算：$t_p = \pi/\omega_d = \pi/(5.59\sqrt{1-0.128}) = \pi/(5.59\times0.934) = 0.601$ 秒
（與量測的 0.5s 有些差距，因為量測有誤差）

---

## 七、主極點（Dominant Poles）概念

### 7.1 什麼是主極點？

當系統有多個極點時，**離虛軸最近的極點**（實部最小）對響應的影響最大，稱為**主極點**。

**判斷準則**：若某極點的實部大小是主極點的 5 倍以上，則該極點對響應的影響可以忽略。

### 7.2 例子

$$G(s) = \frac{10}{(s+1)(s+10)}$$

極點：s = -1 和 s = -10

s = -1 是主極點（離虛軸近）。s = -10 的響應 e^{-10t} 衰減很快，可忽略。

近似：$G(s) \approx \frac{10}{10(s+1)} = \frac{1}{s+1}$（一階近似）

---

## 八、附加極點和零點的影響

### 8.1 附加極點的影響

在系統中增加一個極點 s = -a：
- **a 很大**（極點遠離虛軸）：影響小，可忽略
- **a 較小**（極點靠近虛軸）：使響應變慢，上升時間增加

### 8.2 附加零點的影響

在系統中增加一個零點 s = -a：
- **a 很大**：影響小
- **a 較小**（零點靠近虛軸）：使響應加快，但超越量增加
- **a 為正**（右半平面零點）：造成**非最小相位（Non-Minimum Phase）**響應，一開始往反方向走

### 8.3 零極點抵消

若零點和極點位置相近（如零點 s=-2.1，極點 s=-2），它們的效果會互相抵消，近似可以同時刪除。

---

## 九、關鍵術語表

| 中文 | 英文 | 白話解釋 | 例子 |
|------|------|----------|------|
| 時間常數 | Time Constant (τ) | 一階系統到達 63.2% 的時間 | RC 電路的 τ=RC |
| 自然頻率 | Natural Frequency (ωn) | 無阻尼時的振盪頻率 | ωn=5 rad/s |
| 阻尼比 | Damping Ratio (ζ) | 衡量震盪程度的參數 | ζ=0.5 為欠阻尼 |
| 欠阻尼 | Underdamped | 會震盪但最終收斂 | 0<ζ<1 |
| 過阻尼 | Overdamped | 不震盪，慢慢到達 | ζ>1 |
| 臨界阻尼 | Critically Damped | 最快且不震盪 | ζ=1 |
| 上升時間 | Rise Time (tr) | 從 10% 到 90% 的時間 | tr=0.5s |
| 峰值時間 | Peak Time (tp) | 到達第一個峰值的時間 | tp=π/ωd |
| 最大超越量 | Maximum Overshoot (Mp) | 超過最終值的最大百分比 | Mp=25.4% |
| 安定時間 | Settling Time (ts) | 進入 ±2% 範圍的時間 | ts=4/(ζωn) |
| 主極點 | Dominant Poles | 離虛軸最近、影響最大的極點 | s=-1 比 s=-10 主導 |
| 阻尼自然頻率 | Damped Natural Frequency (ωd) | 有阻尼時的實際振盪頻率 | ωd=ωn√(1-ζ²) |

---

## 十、題型鑑別表

| 題目特徵 | 解題方法 |
|----------|----------|
| 給 G(s)，求 ωn、ζ | 對比標準式 ωn²/(s²+2ζωns+ωn²) |
| 求 Mp、tp、ts、tr | 套公式（先求 ωn、ζ、ωd）|
| 由測量 Mp 反推 ζ | $\zeta = -\ln(M_p)/\sqrt{\pi^2+\ln^2(M_p)}$ |
| 設計需求→求參數範圍 | Mp→ζ 下界，ts→ζωn 下界 |
| 高階系統近似 | 找主極點，忽略遠極點 |
| 求步階響應 y(t) | 部分分式展開 + 拉普拉斯反轉換 |
| 判斷阻尼類型 | 看 ζ：<1 欠阻尼，=1 臨界，>1 過阻尼 |

---

## 十一、額外例題

**【例題 6】閉迴路系統的暫態分析**

開迴路轉移函數 $G(s) = \frac{K}{s(s+4)}$，單位回授。求使 Mp = 20% 的 K 值。

**解**：
閉迴路：$T(s) = \frac{K}{s^2 + 4s + K}$

對比標準式：
- $\omega_n^2 = K \Rightarrow \omega_n = \sqrt{K}$
- $2\zeta\omega_n = 4 \Rightarrow \zeta = 2/\sqrt{K}$

由 Mp = 20%：
$$0.2 = e^{-\zeta\pi/\sqrt{1-\zeta^2}}$$
$$\ln 0.2 = -1.609 = -\frac{\zeta\pi}{\sqrt{1-\zeta^2}}$$

查表或計算得 ζ ≈ 0.456

$$0.456 = \frac{2}{\sqrt{K}} \Rightarrow \sqrt{K} = \frac{2}{0.456} = 4.386 \Rightarrow K = 19.24$$

驗算：$\omega_n = \sqrt{19.24} = 4.386$，$\zeta = 2/4.386 = 0.456$ ✓

**【例題 7】三階系統的主極點近似**

$$T(s) = \frac{50}{(s+10)(s^2+2s+5)}$$

判斷主極點並做近似分析。

**解**：
極點：
- s = -10（遠極點）
- $s^2 + 2s + 5 = 0 \Rightarrow s = -1 \pm j2$（共軛複數極點）

主極點 $s = -1 \pm j2$ 離虛軸較近（實部 = 1），而 s = -10 遠（實部 = 10，是主極點的 10 倍），可忽略。

近似為二階系統：
$$T(s) \approx \frac{50}{10 \cdot (s^2+2s+5)} = \frac{5}{s^2+2s+5}$$

修正使 DC 增益不變：原始 $T(0) = 50/(10\times5) = 1$，近似 $T(0) = 5/5 = 1$ ✓

近似 ωn = √5 ≈ 2.236，ζ = 1/√5 ≈ 0.447

$M_p = e^{-0.447\pi/\sqrt{1-0.2}} \approx e^{-1.571} \approx 20.8\%$

---

## ✅ 自我檢測

<details>
<summary><strong>Q1：一階系統 G(s)=1/(2s+1) 的時間常數是多少？到達 98% 需要多久？</strong></summary>

**答**：τ = 2 秒。到達 98% 需要 4τ = 8 秒（因為 $1-e^{-4} \approx 0.982$）。
</details>

<details>
<summary><strong>Q2：ζ = 0.5 時，最大超越量大約是多少？</strong></summary>

**答**：$M_p = e^{-0.5\pi/\sqrt{1-0.25}} = e^{-0.5\pi/0.866} = e^{-1.814} = 0.163 = 16.3\%$
</details>

<details>
<summary><strong>Q3：要減小安定時間 ts，應該怎麼做？</strong></summary>

**答**：$t_s = 4/(\zeta\omega_n)$，所以要增大 $\zeta\omega_n$（即增大極點實部的大小）。可以增大 ωn 或 ζ（或兩者）。
</details>

<details>
<summary><strong>Q4：系統 G(s) = 9/(s²+6s+9)，是什麼類型？ωn 和 ζ 各是多少？</strong></summary>

**答**：$\omega_n^2 = 9 \Rightarrow \omega_n = 3$。$2\zeta\omega_n = 6 \Rightarrow \zeta = 1$。這是**臨界阻尼**系統。極點 $s = -3$（重根）。
</details>

<details>
<summary><strong>Q5：為什麼 Mp 只跟 ζ 有關，跟 ωn 無關？</strong></summary>

**答**：因為 $M_p = e^{-\zeta\pi/\sqrt{1-\zeta^2}}$ 公式中只有 ζ。直觀理解：ωn 影響震盪「多快」，ζ 影響震盪「多大」。改變 ωn 只是讓響應等比例地在時間軸上伸縮，峰值高度（相對於最終值）不變。
</details>

<details>
<summary><strong>Q6：什麼是「非最小相位系統」？有什麼特殊行為？</strong></summary>

**答**：含有右半平面零點的系統。步階響應一開始會往反方向走（undershoot），然後才轉向正確方向到達最終值。例如：倒車時車頭先向前移一點再後退。
</details>

---

> **下一章預告**：知道了響應長什麼樣，接下來最關鍵的問題——系統到底**穩不穩定**？穩定之後的**誤差**有多大？第三章帶你掌握 Routh-Hurwitz 判據和穩態誤差分析！
