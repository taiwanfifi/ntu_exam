# 信號與系統 第六章：Z 轉換

---

## 🔰 本章基礎觀念（零基礎必讀）

### Z 轉換是什麼？

上一章我們學了**拉普拉斯轉換**，它是連續時間系統的分析工具。

> **Z 轉換就是離散時間系統的「拉普拉斯轉換」。**

| | 連續時間 | 離散時間 |
|--|---------|---------|
| 時域 → 轉換域 | 拉普拉斯轉換 (s 域) | Z 轉換 (z 域) |
| 特殊情況 | 傅立葉轉換 (s = jω) | DTFT (z = e^(jω)) |

### 為什麼要用 Z 轉換？

和拉普拉斯轉換一樣的好處：
1. **差分方程 → 代數方程**（微積分消失了！）
2. 可以分析**不穩定**的離散系統
3. 極零圖直接告訴你系統的穩定性和頻率特性
4. 數位濾波器設計的基礎工具

### z 和 s 的關係

$$z = e^{sT}$$

其中 T 是取樣週期。當 T 歸一化為 1 時，z = e^s。

- s 平面的 jω 軸 → z 平面的**單位圓**
- s 平面的左半面 → z 平面的**單位圓內部**
- s 平面的右半面 → z 平面的**單位圓外部**

---

## 關鍵術語表

| 中文 | 英文 | 白話解釋 | 例子 |
|------|------|----------|------|
| Z 轉換 | Z-Transform | 把離散信號轉到 z 域 | x[n] → X(z) |
| 單位圓 | Unit circle | z 平面上 \|z\| = 1 的圓 | z = e^(jω) |
| ROC | Region of Convergence | z 平面上級數收斂的區域 | \|z\| > 0.5 |
| 差分方程 | Difference equation | 離散系統的輸入輸出關係 | y[n]-0.5y[n-1]=x[n] |
| 長除法 | Long division | 反 Z 轉換的一種方法 | |
| 留數法 | Residue method | 反 Z 轉換的另一種方法 | |
| FIR | Finite Impulse Response | 有限脈衝響應（h[n] 有限長）| |
| IIR | Infinite Impulse Response | 無限脈衝響應（h[n] 無限長）| |

---

## 一、Z 轉換的定義

### 1.1 定義

$$X(z) = \sum_{n=-\infty}^{\infty} x[n] \, z^{-n}$$

其中 z 是複數變數。

> **白話**：把序列 x[n] 的每一項乘以 z^(-n)，全部加起來。

### 1.2 與 DTFT 的關係

DTFT 是 z = e^(jω) 的特例：

$$X(e^{j\omega}) = X(z)\big|_{z=e^{j\omega}} = \sum_{n=-\infty}^{\infty} x[n] \, e^{-j\omega n}$$

> **當 ROC 包含單位圓時**，在單位圓上取值就得到 DTFT。

### 1.3 單邊 Z 轉換

$$X(z) = \sum_{n=0}^{\infty} x[n] \, z^{-n}$$

適合分析因果信號和有初始條件的差分方程。

---

## 二、常見 Z 轉換對

### 2.1 基本轉換對

| x[n] | X(z) | ROC |
|-------|-------|-----|
| δ[n] | 1 | 全 z 平面 |
| u[n] | z/(z-1) = 1/(1-z⁻¹) | \|z\| > 1 |
| aⁿu[n] | z/(z-a) = 1/(1-az⁻¹) | \|z\| > \|a\| |
| -aⁿu[-n-1] | z/(z-a) = 1/(1-az⁻¹) | \|z\| < \|a\| |
| naⁿu[n] | az/(z-a)² | \|z\| > \|a\| |
| nu[n] | z/(z-1)² | \|z\| > 1 |
| cos(ω₀n)u[n] | z(z-cos ω₀)/(z²-2z cos ω₀+1) | \|z\| > 1 |
| sin(ω₀n)u[n] | z sin ω₀/(z²-2z cos ω₀+1) | \|z\| > 1 |
| aⁿcos(ω₀n)u[n] | z(z-a cos ω₀)/(z²-2az cos ω₀+a²) | \|z\| > \|a\| |
| δ[n-k] | z⁻ᵏ | z ≠ 0 (k>0) |

### 數值例題 2.1：基本 Z 轉換

> **問題**：求 x[n] = (0.5)ⁿu[n] 的 Z 轉換。

**解答**：

$$X(z) = \sum_{n=0}^{\infty} (0.5)^n z^{-n} = \sum_{n=0}^{\infty} (0.5 z^{-1})^n = \frac{1}{1 - 0.5z^{-1}} = \frac{z}{z - 0.5}$$

收斂條件：|0.5z⁻¹| < 1 → |z| > 0.5

**答：X(z) = z/(z-0.5)，ROC：|z| > 0.5**

> 極點在 z = 0.5（單位圓內），零點在 z = 0。

### 數值例題 2.2：左邊信號

> **問題**：求 x[n] = -(0.5)ⁿu[-n-1] 的 Z 轉換。

**解答**：

$$X(z) = -\sum_{n=-\infty}^{-1} (0.5)^n z^{-n} = -\sum_{m=1}^{\infty} (0.5)^{-m} z^{m} = -\sum_{m=1}^{\infty} (2z)^m$$

$$= -\frac{2z}{1-2z} = \frac{2z}{2z-1} = \frac{z}{z-0.5}$$

收斂條件：|2z| < 1 → |z| < 0.5

**答：X(z) = z/(z-0.5)，ROC：|z| < 0.5**

> **注意**：跟例題 2.1 的 X(z) 表示式完全一樣！但 ROC 不同 → 對應不同的 x[n]。
> 再次證明：**沒有 ROC，Z 轉換的反轉換不唯一。**

---

## 三、ROC 與因果性 / 穩定性

### 3.1 ROC 的基本規則

| 信號類型 | ROC 形狀 |
|----------|----------|
| **右邊信號**（因果）| \|z\| > r_max（最大極點半徑的外圈）|
| **左邊信號** | \|z\| < r_min（最小極點半徑的內圈）|
| **雙邊信號** | 環狀：r₁ < \|z\| < r₂ |
| **有限長序列** | 全 z 平面（可能除 z=0 或 z=∞）|

### 3.2 因果性與穩定性

| 性質 | 條件 |
|------|------|
| **因果** | ROC 在最外極點的外面（包含 z = ∞）|
| **穩定** | ROC 包含**單位圓** |
| **因果且穩定** | 所有極點都在**單位圓內** (\|pₖ\| < 1) |

> **超重要結論（離散版）**：因果且穩定 ↔ 所有極點在單位圓內。
>
> 對比連續版本：因果且穩定 ↔ 所有極點在左半平面。

### 數值例題 3.1：穩定性判斷

> **問題**：H(z) = z/((z-0.3)(z-0.8))，假設因果，判斷穩定性。

**解答**：

極點在 z = 0.3 和 z = 0.8。
- |0.3| = 0.3 < 1 ✓
- |0.8| = 0.8 < 1 ✓

所有極點在單位圓內 → **因果且穩定** ✓

> **問題（變化）**：若極點改為 z = 0.3 和 z = 1.2？

極點 z = 1.2 在單位圓外 → **不穩定** ✗

---

## 四、Z 轉換的重要性質

### 4.1 線性

$$ax_1[n] + bx_2[n] \longleftrightarrow aX_1(z) + bX_2(z)$$

### 4.2 時移（最常用！）

$$x[n-k] \longleftrightarrow z^{-k} X(z)$$

> **延遲一個樣本 = 乘以 z⁻¹。** 這是 Z 轉換最核心的性質。
> z⁻¹ 在離散系統中就代表「延遲一個單位」。

### 4.3 z 域尺度

$$a^n x[n] \longleftrightarrow X(z/a)$$

### 4.4 卷積

$$x[n] * h[n] \longleftrightarrow X(z) \cdot H(z)$$

### 4.5 初值定理

$$x[0] = \lim_{z \to \infty} X(z)$$

### 4.6 性質速查表

| 性質 | 時域 | z 域 |
|------|------|------|
| 線性 | ax₁+bx₂ | aX₁+bX₂ |
| 時移 | x[n-k] | z⁻ᵏX(z) |
| z域尺度 | aⁿx[n] | X(z/a) |
| 時域翻轉 | x[-n] | X(1/z) |
| 微分(z域) | nx[n] | -z(dX/dz) |
| 卷積 | x*h | X·H |
| 初值 | x[0] | lim_{z→∞} X(z) |

---

## 五、反 Z 轉換

### 5.1 方法一：部分分式展開（最常用）

**步驟**：
1. 把 X(z)/z 做部分分式展開
2. 乘回 z
3. 查表反轉換

> 為什麼要先除以 z 再展開？因為轉換對都是 z/(z-a) 的形式，所以先把 X(z)/z 展開成 A/(z-a) 的形式，再乘 z 得到 Az/(z-a)，就可以直接查表。

### 數值例題 5.1：部分分式法

> **問題**：X(z) = (2z²-1.5z)/((z-0.5)(z-1))，ROC: |z| > 1，求 x[n]。

**解答**：

**步驟 1：X(z)/z**

$$\frac{X(z)}{z} = \frac{2z - 1.5}{(z-0.5)(z-1)} = \frac{A}{z-0.5} + \frac{B}{z-1}$$

- z = 0.5: 2(0.5)-1.5 = -0.5 = A(0.5-1) = -0.5A → A = 1
- z = 1: 2(1)-1.5 = 0.5 = B(1-0.5) = 0.5B → B = 1

$$\frac{X(z)}{z} = \frac{1}{z-0.5} + \frac{1}{z-1}$$

**步驟 2：乘回 z**

$$X(z) = \frac{z}{z-0.5} + \frac{z}{z-1}$$

**步驟 3：查表（ROC: |z| > 1 → 因果）**

$$x[n] = (0.5)^n u[n] + (1)^n u[n] = [(0.5)^n + 1]u[n]$$

**驗證**：x[0] = 0.5⁰ + 1 = 2。初值定理：lim_{z→∞} X(z) = lim_{z→∞} (2z²-1.5z)/(z²-1.5z+0.5) = 2 ✓

### 5.2 方法二：長除法（Power Series Expansion）

直接把 X(z) 展開成 z⁻ⁿ 的冪級數，係數就是 x[n]。

### 數值例題 5.2：長除法

> **問題**：X(z) = 1/(1-0.5z⁻¹)，ROC: |z| > 0.5，求前幾項 x[n]。

**解答**：

做多項式長除法（分子 1 除以 1-0.5z⁻¹）：

```
      1 + 0.5z⁻¹ + 0.25z⁻² + 0.125z⁻³ + ...
     ─────────────────────────────────────
1-0.5z⁻¹ ) 1
            1 - 0.5z⁻¹
            ──────────
                0.5z⁻¹
                0.5z⁻¹ - 0.25z⁻²
                ──────────────────
                       0.25z⁻²
                       ...
```

所以 X(z) = 1 + 0.5z⁻¹ + 0.25z⁻² + 0.125z⁻³ + ...

$$x[n] = (0.5)^n, \quad n = 0, 1, 2, 3, \ldots$$

即 x[n] = (0.5)ⁿu[n] ✓

### 5.3 方法三：留數法

$$x[n] = \sum_{\text{ROC 內的極點}} \text{Res}\left[X(z) z^{n-1}, z = p_k\right]$$

（注意：「ROC 內的極點」是指使級數收斂的那些極點。對因果信號，是所有極點。）

### 數值例題 5.3：留數法

> **問題**：X(z) = z/((z-0.5)(z-0.8))，ROC: |z| > 0.8，求 x[n]。

**解答**：

$$x[n] = \text{Res}_{z=0.5}\left[\frac{z^n}{(z-0.5)(z-0.8)}\right] + \text{Res}_{z=0.8}\left[\frac{z^n}{(z-0.5)(z-0.8)}\right]$$

$$= \frac{(0.5)^n}{0.5-0.8} + \frac{(0.8)^n}{0.8-0.5} = \frac{(0.5)^n}{-0.3} + \frac{(0.8)^n}{0.3}$$

$$x[n] = \frac{1}{0.3}\left[-(0.5)^n + (0.8)^n\right]u[n] = \frac{10}{3}\left[(0.8)^n - (0.5)^n\right]u[n]$$

---

## 六、差分方程與 H(z)

### 6.1 從差分方程到轉移函數

一般的線性常係數差分方程：

$$\sum_{k=0}^{N} a_k y[n-k] = \sum_{k=0}^{M} b_k x[n-k]$$

取 Z 轉換（零初始條件），利用時移性質 x[n-k] ↔ z⁻ᵏX(z)：

$$H(z) = \frac{Y(z)}{X(z)} = \frac{b_0 + b_1 z^{-1} + \cdots + b_M z^{-M}}{a_0 + a_1 z^{-1} + \cdots + a_N z^{-N}}$$

### 數值例題 6.1：差分方程轉 H(z)

> **問題**：y[n] - 0.5y[n-1] = x[n] + 2x[n-1]，求 H(z) 和極零點。

**解答**：

取 Z 轉換：
$$Y(z) - 0.5z^{-1}Y(z) = X(z) + 2z^{-1}X(z)$$

$$Y(z)(1 - 0.5z^{-1}) = X(z)(1 + 2z^{-1})$$

$$H(z) = \frac{1 + 2z^{-1}}{1 - 0.5z^{-1}} = \frac{z + 2}{z - 0.5}$$

**極點**：z = 0.5（單位圓內 → 穩定 ✓）
**零點**：z = -2

### 數值例題 6.2：求脈衝響應

> **問題**：續上題，求 h[n]。

**解答**：

$$H(z) = \frac{z+2}{z-0.5}$$

做部分分式：先算 H(z)/z = (z+2)/(z(z-0.5))

$$\frac{z+2}{z(z-0.5)} = \frac{A}{z} + \frac{B}{z-0.5}$$

- z = 0: 2 = A(-0.5) → A = -4
- z = 0.5: 2.5 = B(0.5) → B = 5

$$H(z) = -4 + \frac{5z}{z-0.5}$$

$$h[n] = -4\delta[n] + 5(0.5)^n u[n]$$

**驗證**：h[0] = -4 + 5 = 1，h[1] = 5(0.5) = 2.5。

代入差分方程 y[n]-0.5y[n-1] = δ[n]+2δ[n-1]：
- n=0: h[0] - 0 = 1 = δ[0]+0 = 1 ✓
- n=1: h[1] - 0.5h[0] = 2.5-0.5 = 2 = δ[1]+2δ[0] = 0+2 = 2 ✓

---

## 七、極零圖與頻率響應

### 7.1 從極零圖讀頻率響應

在單位圓上取一點 z = e^(jω)，頻率響應為：

$$H(e^{j\omega}) = K \cdot \frac{\prod |\text{零點到 } e^{j\omega} \text{ 的距離}|}{\prod |\text{極點到 } e^{j\omega} \text{ 的距離}|} \cdot e^{j(\text{相位項})}$$

**直覺**：
- 當 ω 使得 e^(jω) 靠近一個**極點** → 分母小 → |H| 大 → **增強**該頻率
- 當 ω 使得 e^(jω) 靠近一個**零點** → 分子小 → |H| 小 → **抑制**該頻率

### 7.2 單位圓與穩定性

- 極點在單位圓**內** → 穩定
- 極點在單位圓**上** → 邊界穩定（等幅振盪）
- 極點在單位圓**外** → 不穩定

### 數值例題 7.1：極零圖分析頻率響應

> **問題**：H(z) = (z-1)/(z-0.9)。描述這個系統的頻率特性。

**解答**：

**零點**：z = 1（在單位圓上，對應 ω = 0，即直流）
**極點**：z = 0.9（在單位圓內，也接近 ω = 0）

- 在 ω = 0（z = 1）附近：靠近零點 → |H| ≈ 0（**擋住直流**）
- 在 ω = π（z = -1）：離零點遠，離極點也遠 → |H| 適中

**這是一個高通濾波器！** 它擋住低頻（包括直流），通過高頻。

計算 |H(e^(j0))| = |1-1|/|1-0.9| = 0/0.1 = 0 → 完全擋住直流 ✓
計算 |H(e^(jπ))| = |-1-1|/|-1-0.9| = 2/1.9 ≈ 1.05 → 高頻略有增益

---

## 八、題型鑑別

| 看到什麼 | 用什麼方法 |
|----------|-----------|
| 「求 X(z) 和 ROC」 | 查轉換對表 + 利用性質 |
| 「反 Z 轉換」 | 部分分式（最常用）、長除法（求前幾項）、留數法 |
| 「差分方程 → H(z)」 | 取 Z 轉換，利用時移性質 z⁻ᵏ |
| 「判斷穩定性（離散）」 | 看極點是否都在單位圓內 |
| 「x[n-k] 的 Z 轉換」 | z⁻ᵏX(z) |
| 「aⁿx[n] 的 Z 轉換」 | X(z/a) |
| 「極零圖 → 頻率特性」 | 靠近極點→增強，靠近零點→抑制 |
| 「求 DTFT」 | 先求 Z 轉換，再令 z = e^(jω) |

---

## ✅ 自我檢測

### 問題 1
x[n] = 3(0.4)ⁿu[n] - 2(0.7)ⁿu[n] 的 Z 轉換和 ROC 是什麼？

<details>
<summary>點擊查看答案</summary>

$$X(z) = \frac{3z}{z-0.4} - \frac{2z}{z-0.7}$$

$$= \frac{3z(z-0.7) - 2z(z-0.4)}{(z-0.4)(z-0.7)} = \frac{z^2 - 1.3z}{(z-0.4)(z-0.7)} = \frac{z(z-1.3)}{(z-0.4)(z-0.7)}$$

ROC：|z| > 0.7（取兩個分量 ROC 的交集）。

極點：z = 0.4, z = 0.7（都在單位圓內 → 穩定）
零點：z = 0, z = 1.3

</details>

### 問題 2
H(z) = (1 - z⁻¹)/(1 - 0.5z⁻¹)，求差分方程。

<details>
<summary>點擊查看答案</summary>

$$\frac{Y(z)}{X(z)} = \frac{1 - z^{-1}}{1 - 0.5z^{-1}}$$

$$Y(z)(1 - 0.5z^{-1}) = X(z)(1 - z^{-1})$$

$$Y(z) - 0.5z^{-1}Y(z) = X(z) - z^{-1}X(z)$$

反轉換回時域：

$$y[n] - 0.5y[n-1] = x[n] - x[n-1]$$

</details>

### 問題 3
用長除法求 X(z) = 1/(1-z⁻¹-z⁻²) 的前 5 項（即 x[0] 到 x[4]）。

<details>
<summary>點擊查看答案</summary>

做長除法 1 ÷ (1-z⁻¹-z⁻²)：

x[0] = 1
x[1]：從 z⁻¹ 項得 1（因為 1×1 = 1）
x[2]：1+1 = 2（z⁻¹ 和 z⁻² 的貢獻）
x[3]：2+1 = 3
x[4]：3+2 = 5

**x[n] = {1, 1, 2, 3, 5, ...}**

這就是**費波那契數列**！差分方程 x[n] = x[n-1] + x[n-2]，x[0]=x[1]=1。

</details>

### 問題 4
H(z) 的極點在 z = 0.9e^(±jπ/4)，零點在 z = 0。這個系統的頻率響應在什麼頻率附近有峰值？

<details>
<summary>點擊查看答案</summary>

極點位於 z = 0.9e^(±jπ/4)，對應的角度是 ω = ±π/4。

當 e^(jω) 在單位圓上移動到靠近極點的位置（ω = π/4）時，|H(e^(jω))| 會特別大。

**峰值在 ω = π/4（即歸一化頻率的 1/8 處）**。

這是一個**帶通濾波器**，通帶中心在 ω = π/4。

極點越靠近單位圓（0.9 → 1），峰值越尖銳（Q 值越高）。

</details>

### 問題 5
為什麼 FIR 濾波器（h[n] 有限長）永遠是穩定的？

<details>
<summary>點擊查看答案</summary>

FIR 的 h[n] 只有有限個非零項。

穩定性條件：Σ|h[n]| < ∞。

有限個有限值的和一定是有限的，所以 **FIR 永遠滿足 BIBO 穩定條件**。

從 Z 轉換角度：FIR 的 H(z) 是 z⁻¹ 的多項式，極點只在 z = 0（永遠在單位圓內）。

這是 FIR 濾波器的一大優點——**保證穩定**。

</details>

---

> **下一章預告**：連續信號如何變成離散信號？離散信號如何還原成連續信號？下一章的**取樣定理**將回答這些核心問題。
