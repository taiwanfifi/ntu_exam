# 若嵐的統計學筆記 #11

## 獨立性檢驗 Chi-Square Test of Independence

> 出現於：第十一章〈獨立性檢驗〉

---

### ◈ 這個概念在故事裡是什麼

若嵐手上現在有三個病人。三個看似無關的故事。

- **許芷萱**：每天遲到三分鐘。行為模式異常精確。
- **陳柏宇**：連續三十天倒楣。事件有自相關。
- **沈曉夢**：反覆做同一個夢。夢裡有六個數字。

三個人，三種症狀，三段不同的人生。

若嵐把三個人的異常整理成一張列聯表——三個維度：行為模式異常程度、時間窗口是否重疊、空間指向是否收斂。然後她在 R 裡跑了一行指令。

```r
chisq.test(ct)
# X-squared = 47.283, df = 8, p-value = 1.34e-07
```

p = 0.000000134。

若嵐盯著螢幕，嘴唇動了一下：「他們不是獨立的。」

三個人的異常不是巧合。他們被同一張網連著。

---

### ◈ 正式定義

**卡方獨立性檢驗**：用來判斷兩個類別變數之間是否獨立。

虛無假設 H₀：兩個變數獨立（沒有關聯）。
對立假設 H₁：兩個變數不獨立（有關聯）。

卡方統計量：

$$
\chi^2 = \sum_{\text{所有格子}} \frac{(O_{ij} - E_{ij})^2}{E_{ij}}
$$

- $O_{ij}$ = 觀察值（你看到的數字）
- $E_{ij}$ = 期望值（如果獨立的話，應該看到的數字）
- 差的平方除以期望——衡量「現實和理論之間的差距」

如果 $\chi^2$ 很大 → 現實和「獨立」的假設差很遠 → 拒絕 H₀ → 兩個變數**不是獨立的**。

---

### ◈ 推導直覺：期望值怎麼算？

列聯表的每個格子的期望值：

$$
E_{ij} = \frac{(\text{第 i 列的總和}) \times (\text{第 j 行的總和})}{\text{全部總和}}
$$

白話：如果兩個變數真的獨立，每個格子的數字應該只取決於它所在的列和行的「邊際比例」。

| | 重疊 | 不重疊 | 合計 |
|------|------|--------|------|
| 異常 | **O₁₁** | O₁₂ | R₁ |
| 正常 | O₂₁ | O₂₂ | R₂ |
| 合計 | C₁ | C₂ | N |

如果獨立：

$$
E_{11} = \frac{R_1 \times C_1}{N}
$$

實際的 O₁₁ 比 E₁₁ 大很多 → 說明「異常」和「重疊」同時出現的頻率**高於預期** → 它們不是各走各的。

---

### ◈ 帶入數字算：三個人的列聯表

若嵐的簡化版列聯表（將三個維度的觀測壓縮為二分類）：

| | 時間窗口重疊 | 時間窗口不重疊 |
|------------|------------|-------------|
| 行為高度異常 | 觀察：9 | 觀察：1 |
| 行為正常範圍 | 觀察：2 | 觀察：8 |

行合計：10, 10。列合計：11, 9。總和：20。

期望值（假設獨立）：

$$
E_{11} = \frac{10 \times 11}{20} = 5.5
$$

$$
E_{12} = \frac{10 \times 9}{20} = 4.5
$$

卡方值：

$$
\chi^2 = \frac{(9-5.5)^2}{5.5} + \frac{(1-4.5)^2}{4.5} + \frac{(2-5.5)^2}{5.5} + \frac{(8-4.5)^2}{4.5}
$$

$$
= \frac{12.25}{5.5} + \frac{12.25}{4.5} + \frac{12.25}{5.5} + \frac{12.25}{4.5}
$$

$$
= 2.23 + 2.72 + 2.23 + 2.72 = \mathbf{9.9}
$$

df = (2-1)(2-1) = 1。臨界值 χ²(0.01, 1) = 6.63。

9.9 > 6.63 → **p < 0.01**。拒絕獨立假設。

這只是二維簡化版。若嵐的完整三維列聯表跑出來 χ² = 47.283，p = 1.34 × 10⁻⁷。

翻譯：**這三個人的異常同時發生在同一個時空窗口裡，不是巧合的機率超過 99.99999%。**

---

### ◈ 你只能檢驗放進表格裡的東西

獨立性檢驗有一個深層的限制，若嵐在手記裡寫了出來。

> 卡方檢驗只能分析你**放進列聯表**的數據。但如果有人從來沒走進你的診所呢？如果有些受害者從來沒被任何人記錄呢？

> 看不見的受害者不會出現在任何列聯表裡。你用統計方法能發現的，永遠只是浮在水面上的冰山。

沈曉夢那天沒有預約。她是自己走進來的。帶著一個沾灰的箱子，裡面有一支 USB 隨身碟。

上面貼著一張紙條：

> 「如果我消失了，把這個交給能讀懂噪音的人。」

若嵐的手在發抖。不是因為數據。是因為她意識到——**她能看見的三個案例，可能只是一張巨大網絡裡被她碰巧接住的三個節點。**

USB 裡的加密資料。阿鬼解開第一層之後找到的 Echo 標靶名單。53 個人。

林哲宇是第 37 號。

白若晴——若嵐的雙胞胎妹妹——是**第 8 號**。

---

### ◈ 那你呢？

你有沒有覺得生活裡某些事情「太巧了」？

連續三天在不同地方遇到同一個人。投了五份履歷，五份都被同一個理由拒絕。三個朋友在同一週告訴你同一句話。

有時候那真的只是巧合。

但有時候，那是因為你們的生活裡有一個**共同的條件變數**——一個你沒放進列聯表裡的東西。也許是一個共同的朋友在傳話。也許是一個你不知道的政策在影響所有人。也許是一個你還沒意識到的模式在重複。

獨立性檢驗不會告訴你**為什麼**不獨立。它只會告訴你：這裡有東西。你該去找了。

---

> *「p = 0.000000134。」*
> *「他們不是獨立的。」*
> —— 第十一章〈獨立性檢驗〉

---

**▸ 圖：見 `Ch11_獨立性檢驗.png`**
