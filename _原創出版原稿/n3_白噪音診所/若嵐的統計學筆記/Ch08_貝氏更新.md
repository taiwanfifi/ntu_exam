# 若嵐的統計學筆記 #08

## 貝氏定理與貝氏更新 Bayes' Theorem & Bayesian Updating

> 出現於：第八章〈貝氏更新〉

---

### ◈ 這個概念在故事裡是什麼

秋天。椰林大道。落葉像一封封寄不出去的信。

若嵐走進台大校園去查陳默——她大學時的指導教授、若晴曾經說「他是唯一理解我的人」的那個男人。

她在路上做了一件事：把自己對老師的信任，從一個模糊的「感覺」，壓成一個數字。

**0.01。** 只有百分之一的可能，她的老師涉入了殺人。

然後證據一條一條進來。每進來一條，那個數字就跳一格。

到章節結尾，她在圖書館裡翻到一篇十三年前的論文，致謝欄寫著「感謝研究助理白若晴同學」。

她不敢再算了。

不是因為她不會算。是因為答案已經太清楚了。

---

### ◈ 正式定義

$$
P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)}
$$

| 符號 | 名稱 | 白話 |
|------|------|------|
| $P(A)$ | 先驗機率 Prior | 看到證據**之前**，你信多少 |
| $P(A｜B)$ | 後驗機率 Posterior | 看到證據**之後**，你信多少 |
| $P(B｜A)$ | 似然度 Likelihood | 如果 A 是真的，B 出現的可能性 |
| $P(B)$ | 邊際似然度 Evidence | 不管 A 真不真，B 出現的整體機率 |

---

### ◈ 推導：三步，從條件機率的定義出發

**第一步。** 兩件事同時發生的機率，可以這樣拆：

$$
P(A \cap B) = P(A|B) \cdot P(B)
$$

**第二步。** 也可以反過來拆：

$$
P(A \cap B) = P(B|A) \cdot P(A)
$$

**第三步。** 左邊一樣，右邊相等，除以 $P(B)$：

$$
P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)}
$$

就這樣。貝氏定理不是天外飛來的——它只是條件機率定義的代數重排。

但它的意義遠超代數：**它把「改變想法」這件事，變成了一個有公式的過程。**

---

### ◈ 帶入數字算算看：若嵐的信念崩塌

**設定：**
- A＝「陳默涉入林哲宇之死」
- 先驗 P(A) = 0.01

**第一條證據 B₁：林哲宇死前 14 件事符合行為導引模式**

需要估計兩個數字：
- P(B₁|A)＝如果陳默真的幹了，看到這種模式的機率？→ **0.95**（幾乎必然）
- P(B₁|¬A)＝如果他沒幹，自然出現這種模式的機率？→ **0.001**（第一章算過，10⁻²⁸ 量級，這裡已經極度寬鬆）

先用全機率公式算 P(B₁)：

$$
P(B_1) = P(B_1|A) \cdot P(A) + P(B_1|\neg A) \cdot P(\neg A)
$$

$$
= 0.95 \times 0.01 + 0.001 \times 0.99 = 0.01049
$$

代入貝氏定理：

$$
P(A|B_1) = \frac{0.95 \times 0.01}{0.01049} = \frac{0.0095}{0.01049} \approx \textbf{0.906}
$$

**一條證據。先驗從 1% 跳到 90.6%。**

這就是為什麼若嵐整個人翻轉了——不是衝動，是數據的力量就是這麼暴力。

---

### ◈ 連續更新：把後驗當成下一輪的先驗

貝氏更新的精髓在**迭代**。看到一條證據，更新一次。把結果當新的起點，再看下一條。

| # | 證據 | 先驗 | → 後驗 |
|---|------|------|--------|
| 0 | 初始信念（他是我的老師） | — | **0.010** |
| 1 | 14 件事件符合行為導引模式 | 0.010 | **0.906** |
| 2 | 理論被否定後他消失了 | 0.906 | **0.966** |
| 3 | 被學術倫理委員會調查過 | 0.966 | **0.985** |
| 4 | 三位患者的異常同步出現 | 0.985 | **0.994** |
| 5 | 87% 準確率的行為預測論文 | 0.994 | **0.998** |
| 6 | 若晴的名字在論文致謝頁 | 0.998 | **0.9997** |

99.97%。

這就是她「不敢再算」的原因。不是不會。是答案太清楚，清楚到她過去五年搭建的整棟信念大廈，要全部拆掉重建。

---

### ◈ 似然比：更直覺的版本

如果完整公式太繁瑣，有一個更鋒利的寫法——**賠率形式（Odds Form）**：

$$
\underbrace{\frac{P(A|B)}{P(\neg A|B)}}_{\text{後驗賠率}} = \underbrace{\frac{P(B|A)}{P(B|\neg A)}}_{\text{似然比 LR}} \times \underbrace{\frac{P(A)}{P(\neg A)}}_{\text{先驗賠率}}
$$

**似然比**告訴你：這條證據在「他幹了」vs「他沒幹」兩個平行宇宙裡，出現的機率差多少倍。

- LR = 1 → 這條證據是廢話，看了等於沒看
- LR = 10 → 強力支持
- LR = 100 → 接近定論

第一條證據的似然比：

$$
LR_1 = \frac{P(B_1|A)}{P(B_1|\neg A)} = \frac{0.95}{0.001} = \textbf{950}
$$

一條證據。950 倍。

若嵐不是在「懷疑」她的老師。她是被 950 倍的數據碾過去的。

---

### ◈ 先驗的脆弱與必要

若嵐在手記裡寫了一段我認為是全書最深的話：

> *先驗是我們活著的基礎。我們相信明天太陽會升起——先驗。我們相信水是安全的——先驗。我們相信老師不會傷害學生——先驗。*

先驗不是壞東西。它是大腦為了在不確定的世界裡正常運作而「預裝」的假設。沒有它，你連過馬路都做不到——因為你無法確定紅燈真的會讓車停下來。

但先驗的危險在於：**你一旦拒絕更新，它就從「合理假設」變成了「自我欺騙」。**

警方對林哲宇的先驗：「有憂鬱症的年輕人跳軌＝自殺。」合理。大多數時候是對的。但行為數據指向完全相反的結論時，他們沒有更新。

若嵐對陳默的先驗：「我的老師是好人。」合理。在她的經驗裡毫無裂縫。但六條證據全部指向同一個方向。

她選擇了更新。

這是整個故事裡最勇敢的選擇——不是面對反派，是面對自己過去相信的一切可能是錯的。

---

### ◈ 那你呢？

你現在也在做貝氏更新。每一天。

你和一個人交往。先驗是「他愛我」。然後你看到一條曖昧的訊息。一次忘記的紀念日。一個說謊時飄開的眼神。

你的後驗在跳。你知道。你只是不想算完。

你在一間公司工作。先驗是「這裡值得我待」。然後你發現主管在會議上搶了你的功勞。同事跟你說「大家都在看新職缺」。年終獎金少了三成。

你的先驗在裂。你聽到裂開的聲音。你只是把音樂開大了一點。

貝氏定理不是學術遊戲。它是你的大腦每時每刻都在跑的程式。

差別只在——**你願不願意看那個輸出值。**

跟若嵐一樣，你可以選擇不算完。但不算完不代表答案不存在。它只是留在那裡，安靜地等你準備好。

---

> *「貝氏定理的核心不是公式。是勇氣。」*
> *「是你願不願意承認，你原本相信的事，可能是錯的。」*
> —— 第八章〈貝氏更新〉白若嵐的諮商手記

---

**▸ 圖：見 `Ch08_貝氏更新.png`**
