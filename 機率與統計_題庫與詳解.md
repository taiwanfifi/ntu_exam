# 機率與統計 考古題題庫與詳解

---

# 第一章：基本機率與計數

## 題目 1.1（鄭明燕 105-2 期中考）
An urn contains 30 red balls and 24 blue balls. They are withdrawn one at a time without replacement until a total of 8 red balls have been withdrawn. Find the probability that a total of k balls are drawn.

### 詳解
這是**負超幾何分布**。抽到第 k 顆球時恰好湊滿 8 顆紅球，表示前 k-1 顆中有 7 紅、(k-8) 藍，且第 k 顆是紅球。

$$P(\text{total } k) = \frac{\binom{30}{7}\binom{24}{k-8}}{\binom{54}{k-1}} \cdot \frac{30-7}{54-(k-1)} = \frac{\binom{30}{7}\binom{24}{k-8}}{\binom{54}{k-1}} \cdot \frac{23}{55-k}$$

更簡潔地寫：
$$P(K=k) = \frac{\binom{29}{7}\binom{24}{k-8}}{\binom{54}{k}} \cdot \frac{k}{8}, \quad k = 8, 9, \ldots, 32$$

或等價地用負超幾何公式：
$$P(K=k) = \frac{\binom{k-1}{7}\binom{54-k}{22}}{\binom{54}{30}} \cdot \frac{30-(8-1)}{54-(k-1)} $$

**直覺理解**：前 k-1 球中恰好 7 紅 (k-8) 藍，第 k 球是紅球。

$$\boxed{P(K=k) = \frac{\binom{k-1}{7}\binom{54-k}{22}}{\binom{54}{30}}\cdot\frac{23}{55-k}}$$

---

## 題目 1.2（鄭明燕 105-2 期中考）
If there are 45 strangers in a room, what is the probability that no two of them celebrate their birthday in the same day? (365 days a year)

### 詳解
經典**生日問題**。

$$P(\text{no match}) = \frac{365}{365} \cdot \frac{364}{365} \cdot \frac{363}{365} \cdots \frac{365-44}{365} = \frac{365!}{(365-45)! \cdot 365^{45}} = \prod_{i=0}^{44}\frac{365-i}{365}$$

$$\boxed{P = \frac{365!}{320! \cdot 365^{45}} \approx 0.0000009 \approx 9 \times 10^{-7}}$$

幾乎不可能沒有人同天生日。（一般 23 人就有 50% 機率碰撞了）

---

## 題目 1.3（鄭明燕 105-2 期中考）
5% of men and 0.25% of women are color blind. A color-blind person is chosen at random. What is the probability of this person being male? Assume the population consists of twice as many males as females.

### 詳解
使用**貝氏定理**。設 M = 男性, F = 女性, C = 色盲。

- P(M) = 2/3, P(F) = 1/3（男是女的兩倍）
- P(C|M) = 0.05, P(C|F) = 0.0025

$$P(M|C) = \frac{P(C|M)P(M)}{P(C|M)P(M) + P(C|F)P(F)}$$

$$= \frac{0.05 \times \frac{2}{3}}{0.05 \times \frac{2}{3} + 0.0025 \times \frac{1}{3}} = \frac{\frac{0.1}{3}}{\frac{0.1}{3} + \frac{0.0025}{3}} = \frac{0.1}{0.1025}$$

$$\boxed{P(M|C) = \frac{0.1}{0.1025} = \frac{40}{41} \approx 0.9756}$$

---

## 題目 1.4（鄭明燕 105-2 期中考）
A and B alternate rolling a pair of dice, stopping either when A rolls the sum 10 or when B rolls the sum 8. Assuming A rolls first, find the probability that the final roll is made by A.

### 詳解
- 擲兩骰子和為 10 的組合：(4,6),(5,5),(6,4) → P(sum=10) = 3/36 = 1/12
- 擲兩骰子和為 8 的組合：(2,6),(3,5),(4,4),(5,3),(6,2) → P(sum=8) = 5/36

設 p = P(A 結束遊戲)。

第一輪：A 以 1/12 機率擲出 10 → A 勝。
若 A 未擲出 10（機率 11/12），B 擲。B 以 5/36 機率擲出 8 → B 勝。
若 B 也未擲出 8（機率 31/36），回到起點。

$$p = \frac{1}{12} + \frac{11}{12} \cdot \frac{31}{36} \cdot p$$

$$p = \frac{1}{12} + \frac{341}{432} p$$

$$p\left(1 - \frac{341}{432}\right) = \frac{1}{12}$$

$$p \cdot \frac{91}{432} = \frac{1}{12} = \frac{36}{432}$$

$$\boxed{p = \frac{36}{91} \approx 0.3956}$$

---

# 第二章：離散隨機變數

## 題目 2.1（鄭明燕 105-2 期中考）
Suppose a random variable X has the Yule-Simons distribution:
P(X = n) = 4/(n(n+1)(n+2)), n = 1, 2, ...

(a) Show that the preceding is a probability mass function.
(b) Show that E(X) = 2.
(c) Show that Var(X) = ∞.

### 詳解

**(a)** 需證 ΣP(X=n) = 1。

利用部分分式：
$$\frac{4}{n(n+1)(n+2)} = \frac{4}{2}\left[\frac{1}{n(n+1)} - \frac{1}{(n+1)(n+2)}\right] = 2\left[\frac{1}{n(n+1)} - \frac{1}{(n+1)(n+2)}\right]$$

$$\sum_{n=1}^{\infty} \frac{4}{n(n+1)(n+2)} = 2\sum_{n=1}^{\infty}\left[\frac{1}{n(n+1)} - \frac{1}{(n+1)(n+2)}\right]$$

這是望遠鏡級數（telescoping series）：
$$= 2 \cdot \frac{1}{1 \cdot 2} = 2 \cdot \frac{1}{2} = 1 \quad \checkmark$$

**(b)**
$$E(X) = \sum_{n=1}^{\infty} n \cdot \frac{4}{n(n+1)(n+2)} = \sum_{n=1}^{\infty} \frac{4}{(n+1)(n+2)}$$

$$= 4\sum_{n=1}^{\infty}\left[\frac{1}{n+1} - \frac{1}{n+2}\right] = 4\left[\frac{1}{2} - 0\right] = 4 \cdot \frac{1}{2} = \boxed{2}$$

**(c)**
$$E(X^2) = \sum_{n=1}^{\infty} n^2 \cdot \frac{4}{n(n+1)(n+2)} = 4\sum_{n=1}^{\infty} \frac{n}{(n+1)(n+2)}$$

$$= 4\sum_{n=1}^{\infty}\left[\frac{1}{n+1} + \frac{1}{n+2} - \frac{1}{n+1}\right] \to \text{需仔細展開}$$

$$\frac{n}{(n+1)(n+2)} = 1 - \frac{3}{n+1} + \frac{2}{n+2}$$

不對，重做：$\frac{n}{(n+1)(n+2)} = \frac{A}{n+1} + \frac{B}{n+2}$

$n = A(n+2) + B(n+1)$, 令 n=-1: $-1 = A$, 令 n=-2: $-2 = -B$, 所以 $B = 2$。

$$\frac{n}{(n+1)(n+2)} = \frac{-1}{n+1} + \frac{2}{n+2} = \frac{2}{n+2} - \frac{1}{n+1}$$

$$E(X^2) = 4\sum_{n=1}^{\infty}\left[\frac{2}{n+2} - \frac{1}{n+1}\right] = 4\left[2\sum_{n=3}^{\infty}\frac{1}{n} - \sum_{n=2}^{\infty}\frac{1}{n}\right]$$

$$= 4\left[\sum_{n=3}^{\infty}\frac{1}{n} + \sum_{n=3}^{\infty}\frac{1}{n} - \frac{1}{2} - \sum_{n=3}^{\infty}\frac{1}{n}\right] = 4\left[\sum_{n=3}^{\infty}\frac{1}{n} - \frac{1}{2}\right]$$

由於 $\sum_{n=3}^{\infty}\frac{1}{n}$ 是調和級數，發散到 ∞。

所以 $E(X^2) = \infty$，因此 $\boxed{Var(X) = E(X^2) - [E(X)]^2 = \infty}$

---

## 題目 2.2（鄭明燕 105-2 期中考）
Compare the Poisson approximation with the correct binomial probability:
(a) P(X=2) when n=8, p=0.1
(b) P(X=9) when n=10, p=0.95
(c) P(X=0) when n=20, p=0.1

### 詳解

**(a)** X ~ Bin(8, 0.1), λ = np = 0.8

精確值：$P(X=2) = \binom{8}{2}(0.1)^2(0.9)^6 = 28 \times 0.01 \times 0.531441 = 0.1488$

Poisson近似：$P(X=2) = e^{-0.8}\frac{0.8^2}{2!} = 0.4493 \times 0.32 = 0.1438$

**(b)** X ~ Bin(10, 0.95)。令 Y = 10-X ~ Bin(10, 0.05), λ = 0.5

P(X=9) = P(Y=1)

精確值：$P(Y=1) = \binom{10}{1}(0.05)^1(0.95)^9 = 10 \times 0.05 \times 0.6302 = 0.3151$

Poisson近似：$P(Y=1) = e^{-0.5}\frac{0.5}{1!} = 0.6065 \times 0.5 = 0.3033$

**(c)** X ~ Bin(20, 0.1), λ = 2

精確值：$P(X=0) = (0.9)^{20} = 0.1216$

Poisson近似：$P(X=0) = e^{-2} = 0.1353$

---

## 題目 2.3（林守德 101-2 期末考）
The probabilities of failure on component 1 (Poisson λ₁=4) and component 2 (Poisson λ₂=5) are independent. We observe 3 product failures. What is the probability that two of them come from component 1?

### 詳解
設 X ~ Poisson(4), Y ~ Poisson(5), X+Y ~ Poisson(9)。

$$P(X=2 | X+Y=3) = \frac{P(X=2, Y=1)}{P(X+Y=3)}$$

$$= \frac{P(X=2)P(Y=1)}{P(X+Y=3)} = \frac{\frac{e^{-4}4^2}{2!}\cdot\frac{e^{-5}5^1}{1!}}{\frac{e^{-9}9^3}{3!}}$$

$$= \frac{\frac{16}{2}\cdot 5}{\frac{729}{6}} = \frac{40}{121.5} = \frac{240}{729}$$

更簡潔：已知 X+Y=3 時，X|X+Y=3 ~ Bin(3, 4/9)

$$\boxed{P(X=2|X+Y=3) = \binom{3}{2}\left(\frac{4}{9}\right)^2\left(\frac{5}{9}\right)^1 = 3 \times \frac{16}{81} \times \frac{5}{9} = \frac{240}{729} = \frac{80}{243} \approx 0.329}$$

---

# 第三章：連續隨機變數

## 題目 3.1（鄭明燕 105-2 期中考）
Find the PDF of Y = e^X when X is normally distributed with parameters μ and σ².

### 詳解
這就是**對數常態分布**（Lognormal distribution）。

用變數變換法：Y = e^X → X = ln(Y), dX/dY = 1/Y

$$f_Y(y) = f_X(\ln y) \cdot \left|\frac{dX}{dY}\right| = \frac{1}{\sqrt{2\pi}\sigma} \exp\left[-\frac{(\ln y - \mu)^2}{2\sigma^2}\right] \cdot \frac{1}{y}$$

$$\boxed{f_Y(y) = \frac{1}{y\sigma\sqrt{2\pi}} \exp\left[-\frac{(\ln y - \mu)^2}{2\sigma^2}\right], \quad y > 0}$$

---

## 題目 3.2（鄭明燕 105-2 期中考）
Verify that Var(X) = α/λ² when X is a Gamma random variable with parameters α and λ.

### 詳解
Gamma(α, λ) 的 PDF 為：$f(x) = \frac{\lambda^{\alpha}}{\Gamma(\alpha)} x^{\alpha-1} e^{-\lambda x}, \quad x > 0$

**求 E(X)**：
$$E(X) = \int_0^{\infty} x \cdot \frac{\lambda^{\alpha}}{\Gamma(\alpha)} x^{\alpha-1} e^{-\lambda x} dx = \frac{\lambda^{\alpha}}{\Gamma(\alpha)} \int_0^{\infty} x^{\alpha} e^{-\lambda x} dx$$

$$= \frac{\lambda^{\alpha}}{\Gamma(\alpha)} \cdot \frac{\Gamma(\alpha+1)}{\lambda^{\alpha+1}} = \frac{\alpha\Gamma(\alpha)}{\Gamma(\alpha)\lambda} = \frac{\alpha}{\lambda}$$

**求 E(X²)**：
$$E(X^2) = \frac{\lambda^{\alpha}}{\Gamma(\alpha)} \int_0^{\infty} x^{\alpha+1} e^{-\lambda x} dx = \frac{\lambda^{\alpha}}{\Gamma(\alpha)} \cdot \frac{\Gamma(\alpha+2)}{\lambda^{\alpha+2}} = \frac{\alpha(\alpha+1)}{\lambda^2}$$

**Var(X)**：
$$\boxed{Var(X) = E(X^2) - [E(X)]^2 = \frac{\alpha(\alpha+1)}{\lambda^2} - \frac{\alpha^2}{\lambda^2} = \frac{\alpha}{\lambda^2}}$$

---

## 題目 3.3（黃乾綱 101-1 期中考）
一個指數分布的隨機變數 X，已知 Var(X) = 4，求 (a) PDF of X (b) E[Y²] where Y = 2X-1

### 詳解
X ~ Exp(λ), Var(X) = 1/λ² = 4 → λ = 1/2

**(a)** $\boxed{f_X(x) = \frac{1}{2}e^{-x/2}, \quad x \geq 0}$

**(b)**
$$E[Y^2] = E[(2X-1)^2] = E[4X^2 - 4X + 1] = 4E[X^2] - 4E[X] + 1$$

E[X] = 1/λ = 2, Var(X) = 4, 所以 E[X²] = Var(X) + [E(X)]² = 4 + 4 = 8

$$\boxed{E[Y^2] = 4(8) - 4(2) + 1 = 32 - 8 + 1 = 25}$$

---

# 第四章：聯合隨機變數

## 題目 4.1（張志中 107-2 期中考）
Let X, Y be independent Exp(λ). Put U = X+Y, V = X/(X+Y).
(a) Find the joint density of (U, V).
(b) Find the individual distributions of U and V. Are U and V independent?
(c) Evaluate E[X|V].

### 詳解

**(a)** 變換：X = UV, Y = U(1-V)

Jacobian：
$$J = \begin{vmatrix} \partial X/\partial U & \partial X/\partial V \\ \partial Y/\partial U & \partial Y/\partial V \end{vmatrix} = \begin{vmatrix} V & U \\ 1-V & -U \end{vmatrix} = -UV - U(1-V) = -U$$

|J| = U

$$f_{U,V}(u,v) = f_{X,Y}(uv, u(1-v)) \cdot |J|$$
$$= \lambda e^{-\lambda uv} \cdot \lambda e^{-\lambda u(1-v)} \cdot u = \lambda^2 u e^{-\lambda u}$$

$$\boxed{f_{U,V}(u,v) = \lambda^2 u e^{-\lambda u}, \quad u > 0, \; 0 < v < 1}$$

**(b)** 由聯合密度可拆分：
- $f_U(u) = \lambda^2 u e^{-\lambda u}$ → **U ~ Gamma(2, λ)**
- $f_V(v) = 1$ → **V ~ Uniform(0, 1)**

因為 $f_{U,V}(u,v) = f_U(u) \cdot f_V(v)$，所以 **U 和 V 獨立**。

**(c)**
V = X/(X+Y), 所以 X = V·U。

$$E[X|V=v] = E[VU|V=v] = v \cdot E[U|V=v] = v \cdot E[U]$$

因為 U 和 V 獨立，所以 $E[U|V=v] = E[U] = 2/\lambda$

$$\boxed{E[X|V=v] = \frac{2v}{\lambda}}$$

同理 $E[Y|V=v] = \frac{2(1-v)}{\lambda}$

---

## 題目 4.2（林守德 101-2 期末考）
Let X and Y be independent uniform on (0,1). Calculate the CDF of min(X,Y)/max(X,Y).

### 詳解
設 Z = min(X,Y)/max(X,Y)。由對稱性，我們可以分兩個情況。

對 0 < z < 1：
$$P(Z \leq z) = P\left(\frac{\min(X,Y)}{\max(X,Y)} \leq z\right)$$

分兩種情形：X < Y 和 X > Y（各機率 1/2）

若 X < Y：Z = X/Y, P(X/Y ≤ z) = P(X ≤ zY)
$$= \int_0^1 \int_0^{\min(zy,1)} 1 \, dx \, dy = \int_0^{1/z} zy \, dy + \int_{1/z}^{1} 1 \, dy$$
（若 z < 1）$= \frac{z}{2z^2} + 1 - \frac{1}{z} = \frac{1}{2z} + 1 - \frac{1}{z} = 1 - \frac{1}{2z}$

由對稱性，若 Y < X 也得到同樣的結果。

$$\boxed{F_Z(z) = 1 - \frac{1}{2z} + \frac{z}{2} = z, \quad 0 < z < 1}$$

等等，讓我重新計算：

$$P(Z \leq z) = 2P(X \leq zY, X < Y) = 2\int_0^1 \int_0^{zy} dx \, dy = 2\int_0^1 zy \, dy = 2 \cdot \frac{z}{2} = z$$

所以 $F_Z(z) = z$，即 **Z ~ Uniform(0,1)**！

$$\boxed{F_Z(z) = z, \quad 0 < z < 1 \implies Z \sim \text{Uniform}(0,1)}$$

---

## 題目 4.3（林守德 101-2 期末考）
A point (X,Y) is selected randomly from the triangle with vertices (0,0), (1,1) and (1,0). Calculate E(X|Y=y).

### 詳解
三角形面積 = 1/2，所以 f(x,y) = 2 在三角形內。

三角形由 0 ≤ y ≤ x ≤ 1 定義。

邊際密度：$f_Y(y) = \int_y^1 2 \, dx = 2(1-y), \quad 0 \leq y \leq 1$

條件密度：$f_{X|Y}(x|y) = \frac{f(x,y)}{f_Y(y)} = \frac{2}{2(1-y)} = \frac{1}{1-y}, \quad y \leq x \leq 1$

$$\boxed{E(X|Y=y) = \int_y^1 x \cdot \frac{1}{1-y} dx = \frac{1}{1-y} \cdot \frac{1-y^2}{2} = \frac{1+y}{2}}$$

---

# 第五章：動差生成函數 (MGF)

## 題目 5.1（林守德 101-2 期末考）
Let {X₁, ..., Xₙ} be Gamma random variables with parameters α₁,...,αₙ and identical θ. Find the distribution of ΣXᵢ.
(Hint: MGF of Gamma(α, θ) is (1-θt)^{-α})

### 詳解
由 MGF 的性質，獨立隨機變數之和的 MGF 等於各 MGF 之積。

$$M_{\sum X_i}(t) = \prod_{i=1}^n M_{X_i}(t) = \prod_{i=1}^n (1-\theta t)^{-\alpha_i} = (1-\theta t)^{-\sum_{i=1}^n \alpha_i}$$

這正是 Gamma($\sum \alpha_i$, θ) 的 MGF。

$$\boxed{\sum_{i=1}^n X_i \sim \text{Gamma}\left(\sum_{i=1}^n \alpha_i, \; \theta\right)}$$

---

# 第六章：中央極限定理與大數法則

## 題目 6.1（鄭明燕 105-2 期末考）
(a) State the Central Limit Theorem for i.i.d. samples.
(b) A six-sided die is continually rolled until the total sum exceeds 380. Using CLT to approximate the probability that at least 100 rolls are necessary.

### 詳解

**(a)** 中央極限定理：設 X₁, X₂, ... 為 i.i.d. 隨機變數，E(Xᵢ) = μ, Var(Xᵢ) = σ²。則

$$\frac{\bar{X}_n - \mu}{\sigma/\sqrt{n}} = \frac{\sum_{i=1}^n X_i - n\mu}{\sigma\sqrt{n}} \xrightarrow{d} N(0,1) \quad \text{as } n \to \infty$$

**(b)** 骰子：E(X) = 7/2 = 3.5, Var(X) = 35/12

需要至少 100 次 ⟺ 前 99 次總和 ≤ 380

$$S_{99} = \sum_{i=1}^{99} X_i$$

$$E(S_{99}) = 99 \times 3.5 = 346.5$$
$$Var(S_{99}) = 99 \times \frac{35}{12} = \frac{3465}{12} = 288.75$$
$$\sigma_{S_{99}} = \sqrt{288.75} \approx 16.99$$

$$P(S_{99} \leq 380) = P\left(\frac{S_{99} - 346.5}{16.99} \leq \frac{380 - 346.5}{16.99}\right) = P(Z \leq 1.97)$$

$$\boxed{P(\text{at least 100 rolls}) = P(S_{99} \leq 380) \approx \Phi(1.97) \approx 0.9756}$$

---

## 題目 6.2（鄭明燕 105-2 期末考）
State the Weak Law of Large Numbers and give a proof when the variance exists.

### 詳解
**弱大數法則**：設 X₁, X₂, ... 為 i.i.d.，E(Xᵢ) = μ, Var(Xᵢ) = σ² < ∞。則對任意 ε > 0：

$$P\left(|\bar{X}_n - \mu| \geq \varepsilon\right) \to 0 \quad \text{as } n \to \infty$$

**證明**（用 Chebyshev 不等式）：

$$P(|\bar{X}_n - \mu| \geq \varepsilon) \leq \frac{Var(\bar{X}_n)}{\varepsilon^2} = \frac{\sigma^2}{n\varepsilon^2} \to 0 \quad \text{as } n \to \infty$$

$\blacksquare$

---

# 第七章：假設檢定與信賴區間

## 題目 7.1（林守德 101-2 期末考）
In a random sample of 1000 males, 250 are afflicted with a blood disorder; 275 of 1000 females tested also have it. Compute a 95% confidence interval for the difference between proportions.

### 詳解
$\hat{p}_1 = 250/1000 = 0.25$（男性）, $\hat{p}_2 = 275/1000 = 0.275$（女性）

差值：$\hat{p}_1 - \hat{p}_2 = -0.025$

標準誤：
$$SE = \sqrt{\frac{\hat{p}_1(1-\hat{p}_1)}{n_1} + \frac{\hat{p}_2(1-\hat{p}_2)}{n_2}} = \sqrt{\frac{0.25 \times 0.75}{1000} + \frac{0.275 \times 0.725}{1000}}$$

$$= \sqrt{\frac{0.1875}{1000} + \frac{0.199375}{1000}} = \sqrt{0.000387} \approx 0.01967$$

95% 信賴區間：$(\hat{p}_1 - \hat{p}_2) \pm 1.96 \times SE$

$$\boxed{-0.025 \pm 1.96 \times 0.01967 = -0.025 \pm 0.0386 = (-0.0636, \; 0.0136)}$$

因為區間包含 0，所以在 95% 信心水準下，男女患病比例沒有顯著差異。

---

## 題目 7.2（林守德 101-2 期末考）
Chi-square test: 1000 voters, relationship between sex and voting.

|  | Men | Women |
|--|-----|-------|
| Vote | 260 | 360 |
| Didn't vote | 140 | 240 |

### 詳解
**卡方獨立性檢定**

總計：男 400, 女 600, 投票 620, 未投票 380, 總共 1000

期望值：
- E(男,投票) = 400×620/1000 = 248
- E(男,不投票) = 400×380/1000 = 152
- E(女,投票) = 600×620/1000 = 372
- E(女,不投票) = 600×380/1000 = 228

$$\chi^2 = \frac{(260-248)^2}{248} + \frac{(140-152)^2}{152} + \frac{(360-372)^2}{372} + \frac{(240-228)^2}{228}$$

$$= \frac{144}{248} + \frac{144}{152} + \frac{144}{372} + \frac{144}{228} = 0.581 + 0.947 + 0.387 + 0.632 = 2.547$$

自由度 = (2-1)(2-1) = 1。$\chi^2_{0.05,1} = 3.841$

因為 2.547 < 3.841，**不拒絕 H₀**。

$$\boxed{\text{在 5\% 顯著水準下，性別與投票行為沒有顯著關聯。}}$$

---

# 第八章：資訊理論（資工系特有）

## 題目 8.1（林守德 101-2 期末考）
(a) What are PageRank and TFIDF? Why we need both?
(b) Draw the Venn Diagram of Entropy and Mutual Information.
(c) What is noisy channel model?
(d) Is KL-divergence a good 'distance' measure? If not, how to fix it?

### 詳解

**(a)**
- **PageRank**：衡量網頁的重要性，基於連結結構。一個被很多重要網頁連結的網頁有更高的 PageRank。
- **TFIDF**：Term Frequency - Inverse Document Frequency。衡量一個詞對一份文件的重要性。TF 高代表該詞在文件中常出現；IDF 高代表該詞在整個語料庫中不常見（因此更有區分力）。
- **為何需要兩者**：PageRank 只考慮網頁的全局重要性（query-independent），TFIDF 考慮查詢詞與文件的相關性（query-dependent）。好的搜尋引擎需要同時考慮文件的相關性（TFIDF）和權威性（PageRank）。

**(b)** Venn Diagram：
```
  H(X)          H(Y)
 [     I(X;Y)     ]
 [H(X|Y)  |  H(Y|X)]
```
- H(X,Y) = H(X) + H(Y|X) = H(Y) + H(X|Y)
- I(X;Y) = H(X) - H(X|Y) = H(Y) - H(Y|X) = H(X) + H(Y) - H(X,Y)

**(c)** **Noisy Channel Model**：
$$\hat{w} = \arg\max_w P(w|o) = \arg\max_w \frac{P(o|w)P(w)}{P(o)} = \arg\max_w P(o|w)P(w)$$
其中 o 是觀察（如拼錯的字），w 是原始訊息。P(o|w) 是 channel model，P(w) 是 language model。
可用於：拼字校正、語音辨識、機器翻譯。

**(d)** KL divergence $D_{KL}(P \| Q) = \sum_x P(x) \log \frac{P(x)}{Q(x)}$

**不是好的距離度量**，因為不滿足對稱性：$D_{KL}(P \| Q) \neq D_{KL}(Q \| P)$

修正方法：使用 **Jensen-Shannon divergence**：
$$JSD(P \| Q) = \frac{1}{2}D_{KL}(P \| M) + \frac{1}{2}D_{KL}(Q \| M), \quad M = \frac{P+Q}{2}$$

JSD 是對稱的，且滿足三角不等式。

---

## 題目 8.2（林守德 101-2 期末考）
A playoff: three-game series, terminates when either team wins 2. X = outcome (e.g., AA, BAB), Y = number of games.
(a) Calculate H(X), H(Y), H(Y|X), H(X|Y) assuming equally matched teams.
(b) Let Z = winning team. Find H(X|Z).

### 詳解

**(a)** 列出所有可能：（A、B 各贏一場的機率相等 = 1/2）

| X | P(X) | Y |
|---|------|---|
| AA | 1/4 | 2 |
| BB | 1/4 | 2 |
| ABA | 1/8 | 3 |
| BAA | 1/8 | 3 |
| ABB | 1/8 | 3 |
| BAB | 1/8 | 3 |

**H(X)** = -[2×(1/4)log(1/4) + 4×(1/8)log(1/8)]
= -[2×(1/4)×(-2) + 4×(1/8)×(-3)]
= -[-1 + (-3/2)] = 5/2 = **2.5 bits**

**H(Y)**：P(Y=2) = 1/2, P(Y=3) = 1/2
H(Y) = -[1/2 × log(1/2) + 1/2 × log(1/2)] = **1 bit**

**H(Y|X)** = 0（知道 X 就確定了 Y）

**H(X|Y)** = H(X) - I(X;Y) = H(X) - [H(Y) - H(Y|X)] = 2.5 - 1 = **1.5 bits**

或直接算：H(X|Y=2) = 1 bit（AA 或 BB 各 1/2），H(X|Y=3) = 2 bits（4 種各 1/4）
H(X|Y) = 1/2 × 1 + 1/2 × 2 = **1.5 bits** ✓

**(b)** P(Z=A) = P(Z=B) = 1/2

H(X|Z=A)：P(AA|A) = 1/2, P(ABA|A) = 1/4, P(BAA|A) = 1/4
= -(1/2)log(1/2) - (1/4)log(1/4) - (1/4)log(1/4) = 1/2 + 1/2 + 1/2 = **1.5 bits**

由對稱性，H(X|Z=B) = 1.5 bits

$$\boxed{H(X|Z) = \frac{1}{2}(1.5) + \frac{1}{2}(1.5) = 1.5 \text{ bits}}$$

---

## 題目 8.3（林守德 101-2 期末考）
Show that the entropy of a function of X is less than or equal to the entropy of X.

### 詳解
設 Y = g(X)。因為 Y 是 X 的函數，知道 X 就能確定 Y，所以 H(Y|X) = 0。

$$H(Y) = H(Y) - H(Y|X) = I(X;Y) \leq H(X)$$

最後一步是因為互資訊 I(X;Y) ≤ min{H(X), H(Y)} ≤ H(X)。

或者更直觀：函數映射可能把多個 x 值映到同一個 y 值，但不會增加隨機性。

$$\boxed{H(g(X)) \leq H(X), \text{ 等號成立當且僅當 } g \text{ 是一對一函數。}}$$

$\blacksquare$

---

# 第九章：條件期望值與條件分布

## 題目 9.1（張志中 107-2 期中考）
Let S and T be independent and absolutely continuous RVs with densities f_S and f_T. Let Z = S+T.

(a) Show that f_{Z|S}(z|s) = f_T(z-s).
(b) Assume S and T are Exp(λ). Find the conditional density f_{S|Z}(s|z).
(c) Evaluate E[S|Z].

### 詳解

**(a)** 由 Z = S + T，在給定 S = s 下，Z = s + T。

$$f_{Z|S}(z|s) = f_T(z - s) \quad \text{(因為 Z - s = T，且 T 與 S 獨立)}$$

$\blacksquare$

**(b)** 用 Bayes' formula for densities：

$$f_{S|Z}(s|z) = \frac{f_{Z|S}(z|s) \cdot f_S(s)}{f_Z(z)}$$

S, T ~ Exp(λ)：f_S(s) = λe^{-λs}, f_T(t) = λe^{-λt}

由 (a)：f_{Z|S}(z|s) = f_T(z-s) = λe^{-λ(z-s)}, 0 ≤ s ≤ z

Z = S+T ~ Gamma(2, λ)：$f_Z(z) = \lambda^2 z e^{-\lambda z}$

$$f_{S|Z}(s|z) = \frac{\lambda e^{-\lambda(z-s)} \cdot \lambda e^{-\lambda s}}{\lambda^2 z e^{-\lambda z}} = \frac{\lambda^2 e^{-\lambda z}}{\lambda^2 z e^{-\lambda z}} = \frac{1}{z}$$

$$\boxed{f_{S|Z}(s|z) = \frac{1}{z}, \quad 0 \leq s \leq z \implies S|Z=z \sim \text{Uniform}(0, z)}$$

**(c)** 由 S|Z=z ~ Uniform(0,z)：

$$\boxed{E[S|Z=z] = \frac{z}{2}, \quad \text{即 } E[S|Z] = \frac{Z}{2}}$$

對稱性：E[T|Z] = Z/2 也是。

---

## 題目 9.2（林守德 106-2 期中考）
兩個獨立均勻分布在 [0,1]×[0,1] 的隨機點 (X₁,Y₁) 和 (X₂,Y₂)，D² = (X₁-X₂)² + (Y₁-Y₂)²。求 E(D²)。

### 詳解

$$E(D^2) = E[(X_1-X_2)^2] + E[(Y_1-Y_2)^2]$$

由對稱性，兩項相等。計算 E[(X₁-X₂)²]：

$$E[(X_1-X_2)^2] = Var(X_1-X_2) + [E(X_1-X_2)]^2$$

E[X₁-X₂] = 0（對稱），Var(X₁-X₂) = Var(X₁) + Var(X₂) = 1/12 + 1/12 = 1/6

$$E(D^2) = \frac{1}{6} + \frac{1}{6} = \boxed{\frac{1}{3}}$$

---

## 題目 9.3（林守德 106-2 期末考）
X₁, ..., Xₙ i.i.d. with mean μ and variance σ². Yₙ = ΣXᵢ.

Prove: E[Xᵢ | Yₙ = y] = y/n.

### 詳解

由對稱性，所有 Xᵢ 是 i.i.d.，所以 E[Xᵢ | Yₙ = y] 對所有 i 相同。

$$\sum_{i=1}^n E[X_i | Y_n = y] = E[Y_n | Y_n = y] = y$$

由對稱性：$n \cdot E[X_i | Y_n = y] = y$

$$\boxed{E[X_i | Y_n = y] = \frac{y}{n}}$$

---

# 第十章：Chebyshev 不等式應用

## 題目 10.1（林守德 106-2 期末考）
Population has 200 families: 70% no dogs, 22% one dog, 8% two dogs. Approximate P(more than 90 dogs).

### 詳解

設 Xᵢ = 第 i 個家庭的狗數。

E[Xᵢ] = 0(0.70) + 1(0.22) + 2(0.08) = 0.38

E[Xᵢ²] = 0(0.70) + 1(0.22) + 4(0.08) = 0.54

Var(Xᵢ) = 0.54 - 0.38² = 0.54 - 0.1444 = 0.3956

S = ΣXᵢ, E[S] = 200 × 0.38 = 76, Var(S) = 200 × 0.3956 = 79.12, σ_S = 8.895

$$P(S > 90) = P\left(Z > \frac{90 - 76}{8.895}\right) = P(Z > 1.574) \approx 1 - \Phi(1.574) \approx 0.0577$$

$$\boxed{P(\text{more than 90 dogs}) \approx 5.8\%}$$

---

# 第十一章：最大概似估計 (MLE) 與動差法

## 題目 11.1（林守德 101-2 期末考）
**German Tank Problem**: X₁, ..., Xₙ integers from U[0, b]. Estimate b.

(a) MLE (b) Method of Moments (c) Concerns

### 詳解

**(a) MLE**：

$L(b) = \frac{1}{(b+1)^n}$ for $b \geq \max(X_i)$, 遞減函數。

$$\boxed{\hat{b}_{MLE} = X_{(n)} = \max(X_1, \ldots, X_n)}$$

**(b) MoM**：E[X] = b/2, 令 $\bar{X} = b/2$：

$$\boxed{\hat{b}_{MoM} = 2\bar{X}}$$

**(c)** MLE 有偏差（低估），MoM 可能 < X_{(n)}（不合理）。無偏修正：$\hat{b} = \frac{n+1}{n}X_{(n)} - 1$。

---

## 題目 11.2（林守德 106-2 期末考）
MLE for class size n. Observed student numbers: {1, 3, 7}.

### 詳解

$L(n) = 1/\binom{n}{3}$，在 n ≥ 7 時遞減。

$$\boxed{\hat{n}_{MLE} = 7 = \max(\text{observed})}$$

---

# 第十二章：Order Statistics 與分布變換

## 題目 12.1（鄭明燕 105-2 期末考）
X₁, ..., Xₙ i.i.d. U(0,1). Joint pdf of order statistics X_{(i)} and X_{(j)}.

### 詳解

$$\boxed{f_{X_{(i)},X_{(j)}}(x,y) = \frac{n!}{(i-1)!(j-i-1)!(n-j)!} x^{i-1} (y-x)^{j-i-1} (1-y)^{n-j}, \quad 0 < x < y < 1}$$

---

## 題目 12.2（林守德 101-2 期末考）
Show X/(X+Y) ~ Uniform(0,1) when X, Y i.i.d. Exp(λ).

### 詳解

CDF 法：Z = X/(X+Y)。W = X/Y 的 CDF：$P(W \leq t) = t/(1+t)$

代入 t = z/(1-z)：$P(Z \leq z) = z/(1-z) \div [1 + z/(1-z)] = z$

$$\boxed{Z \sim \text{Uniform}(0,1)}$$

---

# 第十三章：Multinomial 與 Covariance

## 題目 13.1（鄭明燕 105-2 期末考）
Multinomial: n trials, r outcomes. Find Cov(Nᵢ, Nⱼ).

### 詳解

$$\boxed{Cov(N_i, N_j) = -np_ip_j \quad (i \neq j)}$$

直觀：Nᵢ 和 Nⱼ 負相關（一個增多，另一個必然減少）。

---

# 第十四章：假設檢定進階

## 題目 14.1（林守德 106-2 期末考）
H₀: μ=16, H₁: μ≠16, σ²=4, n=25, α=0.05.

### 詳解

σ/√n = 0.4。接受域：$\boxed{15.216 < \bar{X} < 16.784}$

若真 μ=20：P(Type II) ≈ 0（相距太遠）。

---

## 題目 14.2（林守德 105-2 期末考）
Blood type independence test: 200 couples.

### 詳解

Expected: A-A=32, A-B=96, B-B=72

χ² = 2.0 + 2.667 + 0.889 = 5.556 < 5.991 = χ²_{0.05,2}

$$\boxed{\text{不拒絕 H₀，無足夠證據顯示血型影響婚姻。}}$$

---

## 題目 14.3（林守德 103-2 期末考）
Rock-Paper-Scissors test (n=120).

### 詳解

Expected = 40 each. χ² = 10 + 0.025 + 9.025 = 19.05 >> 5.991

$$\boxed{\text{強烈拒絕 H₀，選擇分布顯著不均勻。}}$$

---

# 第十五章：Lognormal 與 MGF 應用

## 題目 15.1（林守德 106-2 期中考）
X with MGF $M_X(t) = e^{2018t + 512t^2}$. Find PDF of Y = eˣ and E[Y].

### 詳解

X ~ N(2018, 1024)（比對 MGF 公式 $e^{\mu t + \sigma^2t^2/2}$）。

Y = eˣ ~ **Lognormal(2018, 1024)**。

$$E[Y] = M_X(1) = e^{2018 + 512} = \boxed{e^{2530}}$$

---

# 第十六章：Bayes 定理進階

## 題目 16.1（林守德 106-2 期中考）
Two disease tests. P(D) = 0.2. Both positive, find P(D)?

### 詳解

$$P(D|T_1=+,T_2=+) = \frac{0.7 \times 0.9 \times 0.2}{0.7 \times 0.9 \times 0.2 + 0.3 \times 0.4 \times 0.8} = \frac{0.126}{0.222} \approx \boxed{0.568}$$

---

# 第十七章：Poisson Process

## 題目 17.1（劉長遠 103-2 期末考）
Customers arrive to a restaurant according to a Poisson process with rate 10/hour. The restaurant opens at 11:00 am.

(a) P(15 customers at 1pm | 12 customers at 12:50pm)?
(b) Given a customer arrived at 11:13am, what is the expected arrival time of the next customer?
(c) A customer arrives at 2pm. P(next 4 customers arrive before 3pm)?

### 詳解

**(a)** 從 12:50 到 1:00 是 10 分鐘 = 1/6 小時，rate = 10/6 ≈ 1.667

需要再來 15-12 = 3 位客人在 10 分鐘內。

$$P(N(10\text{min})=3) = \frac{(10/6)^3}{3!}e^{-10/6} = \frac{(5/3)^3}{6}e^{-5/3}$$

$$= \frac{125/27}{6}e^{-5/3} = \frac{125}{162}e^{-5/3} \approx \frac{125}{162} \times 0.1889 \approx \boxed{0.1458}$$

**(b)** Poisson process 的 **memoryless property**：不管上一位客人何時到達，下一位客人的等待時間仍然是 Exp(10/hr)。

Expected waiting time = 1/10 hour = **6 分鐘**。

$$\boxed{E[\text{next arrival}] = 11:13 + 6\text{min} = 11:19\text{am}}$$

**(c)** 從 2pm 到 3pm = 1 小時，rate = 10。需要 4 位客人在 1 小時內到達。

$$P(N(1) \geq 4) = 1 - P(N(1) \leq 3) = 1 - \sum_{k=0}^{3}\frac{10^k e^{-10}}{k!}$$

$$= 1 - e^{-10}\left(1 + 10 + 50 + \frac{500}{3}\right) = 1 - e^{-10} \times 227.67$$

$$\approx 1 - 0.01034 \approx \boxed{0.9897}$$

---

## 題目 17.2（劉長遠 103-2 期末考）
Transmitter A sends messages as a Poisson process with rate λ_A. Word count per message: P(W=1)=1/3, P(W=2)=1/2, P(W=3)=1/6.

(a) PDF for T = time until receiver gets exactly 8 three-word messages from A.
(b) P(a particular damaged word is from a 3-word message) if damage rate = 10⁻³.

### 詳解

**(a)** 三字訊息出現率 = λ_A × P(W=3) = λ_A/6（Poisson thinning）。

等第 8 個三字訊息的時間 T ~ Gamma(8, λ_A/6)：

$$\boxed{f_T(t) = \frac{(\lambda_A/6)^8}{7!} t^7 e^{-\lambda_A t/6}, \quad t > 0}$$

**(b)** 每個字損壞機率 = 10⁻³，與訊息類型獨立。

一個「損壞的字」來自 3-word message 的機率：

E[# words from 1-word msgs per msg] = 1 × 1/3
E[# words from 2-word msgs per msg] = 2 × 1/2 = 1
E[# words from 3-word msgs per msg] = 3 × 1/6 = 1/2

E[total words per msg] = 1/3 + 1 + 1/2 = 11/6

$$P(\text{damaged word from 3-word msg}) = \frac{1/2}{11/6} = \frac{3}{11}$$

$$\boxed{\frac{3}{11} \approx 0.273}$$

（損壞是隨機的，所以任何損壞的字來自 3-word message 的機率等於 3-word message 占總字數的比例。）

---

## 題目 17.3（陳宏 103-2 期末考）
Show: if N₁(t) and N₂(t) are independent Poisson processes with rates λ₁ and λ₂, then N(t) = N₁(t)+N₂(t) is a Poisson process with rate λ₁+λ₂.

### 詳解

**方法一：用 PMF**

$$P(N(t) = n) = \sum_{k=0}^{n} P(N_1(t)=k)P(N_2(t)=n-k)$$

$$= \sum_{k=0}^{n} \frac{(\lambda_1 t)^k e^{-\lambda_1 t}}{k!} \cdot \frac{(\lambda_2 t)^{n-k} e^{-\lambda_2 t}}{(n-k)!}$$

$$= e^{-(\lambda_1+\lambda_2)t} \sum_{k=0}^{n} \frac{(\lambda_1 t)^k (\lambda_2 t)^{n-k}}{k!(n-k)!}$$

$$= \frac{e^{-(\lambda_1+\lambda_2)t}}{n!} \sum_{k=0}^{n} \binom{n}{k}(\lambda_1 t)^k (\lambda_2 t)^{n-k}$$

$$= \frac{e^{-(\lambda_1+\lambda_2)t}}{n!} [(\lambda_1+\lambda_2)t]^n$$

$$\boxed{P(N(t)=n) = \frac{[(\lambda_1+\lambda_2)t]^n e^{-(\lambda_1+\lambda_2)t}}{n!}} \quad \text{Poisson}(\lambda_1+\lambda_2)$$

還需驗證獨立增量和平穩增量，這由 N₁ 和 N₂ 的獨立性直接得到。$\blacksquare$

---

# 第十八章：Markov Chain

## 題目 18.1（陳宏 103-2 小考）
Three white and three black balls in two urns (each with 3). State i = number of white balls in urn 1. At each step, draw one from each urn, swap. Find transition matrix.

### 詳解

State space: {0, 1, 2, 3}

在 state i（urn 1 有 i 白 (3-i) 黑，urn 2 有 (3-i) 白 i 黑）：
- 從 urn 1 抽白 P = i/3，從 urn 2 抽白 P = (3-i)/3
- 從 urn 1 抽黑 P = (3-i)/3，從 urn 2 抽黑 P = i/3

| urn1抽 | urn2抽 | State change | Prob |
|--------|--------|-------------|------|
| 白 | 白 | i→i | i(3-i)/9 |
| 白 | 黑 | i→i-1+0=i-1 | i²/9 |
| 黑 | 白 | i→i+1 | (3-i)²/9 |
| 黑 | 黑 | i→i | i(3-i)/9 |

等等，重新思考：從 urn1 抽出一球放到 urn2，從 urn2 抽出一球放到 urn1。

若從 urn1 抽白（prob i/3），從 urn2 抽白（prob (3-i)/3）：urn1 少一白多一白 → i 不變
若從 urn1 抽白（prob i/3），從 urn2 抽黑（prob i/3）：urn1 少一白多一黑 → i-1
若從 urn1 抽黑（prob (3-i)/3），從 urn2 抽白（prob (3-i)/3）：urn1 少一黑多一白 → i+1
若從 urn1 抽黑（prob (3-i)/3），從 urn2 抽黑（prob i/3）：urn1 不變

$$P(i \to i+1) = \frac{(3-i)^2}{9}, \quad P(i \to i-1) = \frac{i^2}{9}, \quad P(i \to i) = \frac{2i(3-i)}{9}$$

$$\boxed{P = \begin{pmatrix} 0 & 1 & 0 & 0 \\ 1/9 & 4/9 & 4/9 & 0 \\ 0 & 4/9 & 4/9 & 1/9 \\ 0 & 0 & 1 & 0 \end{pmatrix}}$$

---

## 題目 18.2（陳宏 103-2 小考）
**Umbrella Problem**. 3 umbrellas, rain prob = 0.2 per trip. Xₙ = umbrellas at current location. Find steady-state fraction of time she gets wet.

### 詳解

State = number of umbrellas at current location (0, 1, 2, 3).

She gets wet when: it rains AND she has 0 umbrellas (state 0).

**Transition matrix**：

From state i:
- If rain (p=0.2): she takes one umbrella → other location gets +1, current loses 1. Next state = 3-i+1 = 4-i...

不，重新想：她走到另一個地點。如果她在 state i（目前地點有 i 把傘），另一個地點有 3-i 把傘。

- 不下雨(0.8)：不帶傘走過去，到了另一地點，那裡有 3-i 把傘 → next state = 3-i
- 下雨(0.2)且 i > 0：帶傘走過去 → 另一地點原有 3-i 把，加上帶去的 1 把 = 3-i+1 → next state = 4-i
- 下雨(0.2)且 i = 0：沒傘，淋雨走過去 → next state = 3-i = 3

Transition:
- P(0→3) = 0.8 + 0.2 = 1（不管下不下雨都是 3-0=3 或淋雨到 3）
- P(1→2) = 0.8, P(1→3) = 0.2
- P(2→1) = 0.8, P(2→3) = 0.2
- P(3→0) = 0.8, P(3→1) = 0.2

Steady state: πP = π

π₀ = 0.8·π₃
π₁ = 0.8·π₂ + 0.2·π₃
π₂ = 0.8·π₁
π₃ = π₀ + 0.2·π₁ + 0.2·π₂

From π₂ = 0.8π₁ and π₁ = 0.8π₂ + 0.2π₃ → π₁ = 0.64π₁ + 0.2π₃ → 0.36π₁ = 0.2π₃ → π₃ = 1.8π₁

π₀ = 0.8 × 1.8π₁ = 1.44π₁, π₂ = 0.8π₁

Sum = 1: 1.44π₁ + π₁ + 0.8π₁ + 1.8π₁ = 5.04π₁ = 1 → π₁ = 1/5.04

π₀ = 1.44/5.04 = 0.2857

She gets wet when in state 0 AND it rains: P(wet) = π₀ × 0.2

$$\boxed{P(\text{wet}) = 0.2857 \times 0.2 = 0.0571 \approx \frac{2}{35}}$$

---

## 題目 18.3（劉長遠 103-2 期末考）
Weather Markov Chain: Good(G), Fair(F), Sad(S). Values: G=$1, F=$0, S=$-1. Steady state.

P(F|G)=1/3, P(S|G)=1/6 → P(G|G)=1/2
P(F|F)=2/3, P(S|F)=1/6 → P(G|F)=1/6
P(F|S)=3/8, P(S|S)=1/2 → P(G|S)=1/8

(a) Find expected value of a random day.
(b) Sum of days 13 and 14 was $0. P(day 13 was Fair)?

### 詳解

**(a)** 求 steady state πP = π：

$$\begin{cases} \pi_G = \frac{1}{2}\pi_G + \frac{1}{6}\pi_F + \frac{1}{8}\pi_S \\ \pi_F = \frac{1}{3}\pi_G + \frac{2}{3}\pi_F + \frac{3}{8}\pi_S \\ \pi_S = \frac{1}{6}\pi_G + \frac{1}{6}\pi_F + \frac{1}{2}\pi_S \\ \pi_G + \pi_F + \pi_S = 1 \end{cases}$$

From eq 1: $\frac{1}{2}\pi_G = \frac{1}{6}\pi_F + \frac{1}{8}\pi_S$ → $\pi_G = \frac{1}{3}\pi_F + \frac{1}{4}\pi_S$

From eq 3: $\frac{1}{2}\pi_S = \frac{1}{6}\pi_G + \frac{1}{6}\pi_F$ → $\pi_S = \frac{1}{3}\pi_G + \frac{1}{3}\pi_F$

代入：$\pi_G = \frac{1}{3}\pi_F + \frac{1}{4}(\frac{1}{3}\pi_G + \frac{1}{3}\pi_F) = \frac{1}{3}\pi_F + \frac{1}{12}\pi_G + \frac{1}{12}\pi_F$

$\frac{11}{12}\pi_G = \frac{5}{12}\pi_F$ → $\pi_F = \frac{11}{5}\pi_G$

$\pi_S = \frac{1}{3}\pi_G + \frac{1}{3} \cdot \frac{11}{5}\pi_G = \frac{1}{3}\pi_G + \frac{11}{15}\pi_G = \frac{16}{15}\pi_G$

Sum: $\pi_G + \frac{11}{5}\pi_G + \frac{16}{15}\pi_G = \pi_G(1 + 2.2 + 1.067) = 4.267\pi_G = 1$

$\pi_G = 0.2344, \pi_F = 0.5156, \pi_S = 0.2500$

$$E[\text{day value}] = 1 \times 0.2344 + 0 \times 0.5156 + (-1) \times 0.2500 = \boxed{-0.0156}$$

**(b)** Days 13+14 sum = $0 的情況：(G,S), (S,G), (F,F)

由 steady state + transition：
- P(G₁₃,S₁₄) = π_G × P(S|G) = 0.2344 × 1/6 = 0.0391
- P(S₁₃,G₁₄) = π_S × P(G|S) = 0.2500 × 1/8 = 0.03125
- P(F₁₃,F₁₄) = π_F × P(F|F) = 0.5156 × 2/3 = 0.3437

$$P(F_{13} | \text{sum}=0) = \frac{0.3437}{0.0391 + 0.03125 + 0.3437} = \frac{0.3437}{0.4140} \approx \boxed{0.830}$$

---

# 第十九章：Random Walk 與 Gambler's Ruin

## 題目 19.1（林守德 102-2 期中考）
**太陽花學運問題**：n 名學生占領立法院。每分鐘 1/2 機率有一人離開（n→n-1），1/2 機率有一人進入（n→n+1）。到達 2n 前如果先到 0，領導者被逮捕。

(b) If t >> n, what is the probability the leader is arrested?

### 詳解

這是經典的 **Gambler's Ruin** 問題。起始資金 n，目標 2n，每步 ±1 各 1/2。

在對稱隨機漫步（p=q=1/2）中，從位置 n 出發，先到 0 的機率 vs 先到 2n 的機率：

$$P(\text{ruin}) = \frac{2n - n}{2n} = \frac{n}{2n} = \frac{1}{2}$$

$$P(\text{reach } 2n) = \frac{n}{2n} = \frac{1}{2}$$

等等，Gambler's Ruin 公式（p=q=1/2）：從位置 i 出發，先到 0 的機率 = 1 - i/N，先到 N 的機率 = i/N。

這裡 i = n, N = 2n：

$$P(\text{arrested, i.e. reach 0}) = 1 - \frac{n}{2n} = \frac{1}{2}$$

當 t >> n 時（足夠長時間），遊戲一定會結束（對稱隨機漫步會以機率 1 到達邊界）。

$$\boxed{P(\text{leader arrested}) = \frac{1}{2}}$$

---

## 題目 19.2（陳宏 103-2 小考）
**Random Walk on Integers**: P_{i,i+1} = p, P_{i,i-1} = 1-p. Determine whether state 0 is recurrent or transient.

### 詳解

State 0 is recurrent iff $\sum_{n=0}^{\infty} P_{00}^{(n)} = \infty$。

$P_{00}^{(2n)} = \binom{2n}{n} p^n (1-p)^n$（必須走 n 步右 n 步左才能回到 0）

用 Stirling 近似：$\binom{2n}{n} \approx \frac{4^n}{\sqrt{\pi n}}$

$$P_{00}^{(2n)} \approx \frac{4^n}{\sqrt{\pi n}} [p(1-p)]^n = \frac{[4p(1-p)]^n}{\sqrt{\pi n}}$$

- 若 **p = 1/2**：4p(1-p) = 1，$P_{00}^{(2n)} \approx \frac{1}{\sqrt{\pi n}}$，$\sum \frac{1}{\sqrt{n}} = \infty$ → **Recurrent**
- 若 **p ≠ 1/2**：4p(1-p) < 1，$P_{00}^{(2n)}$ 指數衰減，$\sum < \infty$ → **Transient**

$$\boxed{\text{State 0 is recurrent iff } p = 1/2; \text{ transient if } p \neq 1/2}$$

---

# 第二十章：Coupon Collector Problem

## 題目 20.1（陳宏 103-2 期末考）
Sample from n cards with replacement. N = number of draws until all n types collected.

(a) Let Nᵢ = draws to get ith new type after having i-1 types. Find E(Nᵢ) and Var(Nᵢ).
(b) Write N in terms of Nᵢ. Find aₙ such that N/aₙ → 1 in probability.

### 詳解

**(a)** 有了 i-1 種後，每次抽到新種的機率 = (n-i+1)/n。

Nᵢ ~ Geometric((n-i+1)/n)：

$$E(N_i) = \frac{n}{n-i+1}$$

$$Var(N_i) = \frac{1 - (n-i+1)/n}{[(n-i+1)/n]^2} = \frac{(i-1)/n}{[(n-i+1)/n]^2} = \frac{n(i-1)}{(n-i+1)^2}$$

**(b)** $N = N_1 + N_2 + \cdots + N_n$

$$E(N) = \sum_{i=1}^{n} \frac{n}{n-i+1} = n\sum_{j=1}^{n}\frac{1}{j} = n \cdot H_n \approx n \ln n + \gamma n$$

其中 $H_n$ 是調和級數，$\gamma \approx 0.5772$ 是 Euler-Mascheroni 常數。

取 $a_n = n \ln n$：

$$Var(N) = \sum_{i=1}^n Var(N_i) \leq n \sum_{j=1}^n \frac{1}{j^2} \cdot n = n^2 \cdot \frac{\pi^2}{6} = O(n^2)$$

$$Var(N/a_n) = \frac{Var(N)}{a_n^2} = \frac{O(n^2)}{n^2(\ln n)^2} = \frac{O(1)}{(\ln n)^2} \to 0$$

由 Chebyshev: $P(|N/a_n - E[N]/a_n| > \epsilon) \leq \frac{Var(N/a_n)}{\epsilon^2} \to 0$

且 $E[N]/a_n = nH_n / (n\ln n) \to 1$，所以 $N/a_n \xrightarrow{P} 1$。

$$\boxed{a_n = n \ln n, \quad E[N] \approx n \ln n}$$

---

# 第二十一章：Waiting Time Paradox (Random Incidence)

## 題目 21.1（陳宏 103-2 期末考）
Bus paradox: 8/9 intervals are 1 min (short), 1/9 intervals are 10 min (long).

(a) P(first passenger faces long wait) = 1/9
(b) Explain why P(random passenger faces long wait) = 5/9
(c) Expected waiting time of first passenger who just missed bus?
(d) Expected waiting time of random passenger?

### 詳解

**(a)** 第一位乘客（剛好趕上公車離開）：下一段 gap 為 long 的機率就是 1/9。

$$\boxed{P(\text{long wait}) = 1/9}$$

**(b)** 隨機到達的乘客更可能落在長的 gap 中（因為長 gap 占更多時間）。

平均 gap 長度 = (8/9)×1 + (1/9)×10 = 8/9 + 10/9 = 18/9 = 2 分鐘。

落在長 gap 中的機率 ∝ 該 gap 的長度：

$$P(\text{long gap}) = \frac{(1/9) \times 10}{(1/9) \times 10 + (8/9) \times 1} = \frac{10/9}{10/9 + 8/9} = \frac{10}{18} = \boxed{\frac{5}{9}}$$

這就是 **size-biased sampling / inspection paradox**：隨機時間點更可能落在較長的區間。

**(c)** 剛好錯過公車的乘客等待 = 整個下一個 gap 的長度。

$$E[\text{wait}] = (8/9) \times 1 + (1/9) \times 10 = \boxed{2 \text{ min}}$$

**(d)** 隨機到達的乘客，落在長度 L 的 gap 中的機率 ∝ L。在長度 L 的 gap 中，等待時間 ~ Uniform(0, L)，期望值 = L/2。

$$E[\text{wait}] = P(\text{short gap}) \times \frac{1}{2} + P(\text{long gap}) \times \frac{10}{2}$$

$$= \frac{4}{9} \times 0.5 + \frac{5}{9} \times 5 = \frac{2}{9} + \frac{25}{9} = \frac{27}{9} = \boxed{3 \text{ min}}$$

或用公式：$E[\text{wait}] = \frac{E[L^2]}{2E[L]}$

$E[L^2] = (8/9)(1) + (1/9)(100) = 108/9 = 12$

$E[\text{wait}] = 12/(2×2) = 3$ ✓

**這解釋了為何乘客感覺等待時間比公告的平均間隔長！**

---

# 第二十二章：Conditional PDF 與 Joint Distribution 進階

## 題目 22.1（陳宏 103-2 期末考）
X ~ Uniform(0,1), given X=x, Y ~ Uniform(1-x, 1).
(a) Joint density f(x,y).
(b) P(X ≥ 1/2, Y ≥ 1/2).
(c) f_{X|Y}(x | 1/3).

### 詳解

**(a)** f(x,y) = f_X(x) × f_{Y|X}(y|x)

f_X(x) = 1 for 0 ≤ x ≤ 1
f_{Y|X}(y|x) = 1/x for 1-x ≤ y ≤ 1

$$\boxed{f(x,y) = \frac{1}{x}, \quad 0 < x \leq 1, \; 1-x \leq y \leq 1}$$

**(b)**
$$P(X \geq 1/2, Y \geq 1/2) = \int_{1/2}^{1}\int_{\max(1-x, 1/2)}^{1} \frac{1}{x} \, dy \, dx$$

When x ≥ 1/2: 1-x ≤ 1/2, so max(1-x, 1/2) = 1/2.

$$= \int_{1/2}^{1} \frac{1-1/2}{x} dx = \frac{1}{2}\int_{1/2}^{1}\frac{dx}{x} = \frac{1}{2}\ln 2$$

$$\boxed{P = \frac{\ln 2}{2} \approx 0.347}$$

**(c)** 先求 f_Y(1/3)：

Y = 1/3 需要 1-x ≤ 1/3 即 x ≥ 2/3。

$$f_Y(1/3) = \int_{2/3}^{1} \frac{1}{x} dx = \ln 1 - \ln(2/3) = \ln(3/2)$$

$$f_{X|Y}(x|1/3) = \frac{f(x, 1/3)}{f_Y(1/3)} = \frac{1/x}{\ln(3/2)}$$

$$\boxed{f_{X|Y}(x|1/3) = \frac{1}{x \ln(3/2)}, \quad 2/3 \leq x \leq 1}$$

---

## 題目 22.2（陳宏 103-2 期末考）
X₁, X₂ i.i.d. with f(x) = 3x⁻⁴, x > 1. Let Z = max(X₁,X₂). Find pdf of Z.

### 詳解

CDF: $F(x) = \int_1^x 3t^{-4}dt = 1 - x^{-3}$ for x ≥ 1.

$F_Z(z) = P(\max(X_1,X_2) \leq z) = [F(z)]^2 = (1-z^{-3})^2$

$$f_Z(z) = 2(1-z^{-3}) \cdot 3z^{-4} = 6z^{-4}(1-z^{-3})$$

$$\boxed{f_Z(z) = 6z^{-4} - 6z^{-7}, \quad z > 1}$$

---

## 題目 22.3（林守德 102-2 期末考）
X ~ Uniform(0,1), Y | X=x ~ Exp(1/x). Find E[Y].

### 詳解

$$E[Y] = E[E[Y|X]] = E[X] \quad \text{(因為 } E[Y|X=x] = x \text{)}$$

等等，Exp(λ) 的期望值是 1/λ。若 λ = 1/x，則 E[Y|X=x] = x。

$$E[Y] = E[E[Y|X]] = E[X] = \frac{1}{2}$$

不對，題目說 parameter θ = 1/x，若 f(y|x) = (1/x)e^{-y/x}，則 E[Y|X=x] = x。

但若 λ = 1/x（即 θ = x），E[Y|X=x] = 1/λ = x。

$$E[Y] = E[X] = \int_0^1 x \, dx = \boxed{\frac{1}{2}}$$

注意：嚴格來說需要驗證 E[Y] 存在。$E[Y] = \int_0^1 \int_0^\infty y \cdot \frac{1}{x}e^{-y/x} \, dy \, dx = \int_0^1 x \, dx = 1/2$ ✓

（此題林守德 105-2 也出過類似題：答案是 E[Y] 發散的版本，看定義的 parameter 方式。）

---

# 第二十三章：CLT 應用進階

## 題目 23.1（林守德 102-2 期末考）
期末考 100 題選擇題（四選一），學生每題有 0.6 機率知道答案，否則隨機猜。P(答對 > 80題)?

### 詳解

每題答對機率 = 0.6 + 0.4 × 1/4 = 0.6 + 0.1 = 0.7

X = 答對題數 ~ Bin(100, 0.7)

E[X] = 70, Var(X) = 100 × 0.7 × 0.3 = 21, σ = √21 ≈ 4.583

$$P(X > 80) = P\left(Z > \frac{80 - 70}{4.583}\right) = P(Z > 2.18) \approx 1 - \Phi(2.18) \approx 0.0146$$

$$\boxed{P(X > 80) \approx 1.5\%}$$

---

## 題目 23.2（劉長遠 103-2 期末考）
Battery life ~ N(250, 20²).
(a) P(one battery > 260)?
(b) P(average of 4 batteries > 260)?

### 詳解

**(a)** $P(X > 260) = P\left(Z > \frac{260-250}{20}\right) = P(Z > 0.5) = 1 - \Phi(0.5) \approx \boxed{0.3085}$

**(b)** $\bar{X}_4 \sim N(250, 20^2/4) = N(250, 100)$, σ = 10

$$P(\bar{X}_4 > 260) = P\left(Z > \frac{260-250}{10}\right) = P(Z > 1) = 1 - \Phi(1) \approx \boxed{0.1587}$$

---

## 題目 23.3（林守德 102-2 期末考）
A 每分鐘 100 C-Power (variance 24)，B 每分鐘 80 (variance 40)。B 領先 40 單位，剩 10 分鐘。P(B wins)?

### 詳解

設 Sₐ = A 後 10 分鐘的總量，S_b = B 後 10 分鐘的總量。

E[Sₐ] = 1000, Var(Sₐ) = 240
E[S_b] = 800, Var(S_b) = 400

B wins ⟺ S_b + 40 > Sₐ ⟺ Sₐ - S_b < 40

D = Sₐ - S_b: E[D] = 200, Var(D) = 240 + 400 = 640, σ_D = √640 ≈ 25.3

$$P(D < 40) = P\left(Z < \frac{40 - 200}{25.3}\right) = P(Z < -6.32) \approx \boxed{0 \text{ (幾乎不可能)}}$$

A 的期望產出大幅領先，B 獲勝機率極小。

---

# 第二十四章：Geometric Entropy 與特殊 Entropy

## 題目 24.1（林守德 102-2 期末考）
A fair coin is flipped until first head. X = number of flips. Find H(X).

### 詳解

X ~ Geometric(1/2): P(X=k) = (1/2)^k, k = 1, 2, ...

$$H(X) = -\sum_{k=1}^{\infty} \frac{1}{2^k} \log_2 \frac{1}{2^k} = -\sum_{k=1}^{\infty} \frac{1}{2^k}(-k) = \sum_{k=1}^{\infty} \frac{k}{2^k}$$

$$\sum_{k=1}^{\infty} \frac{k}{2^k} = \frac{1/2}{(1-1/2)^2} = 2$$

$$\boxed{H(X) = 2 \text{ bits}}$$

一般 Geometric(p): $H(X) = \frac{-(1-p)\log_2(1-p) - p\log_2 p}{p}$

---

## 題目 24.2（林守德 102-2 期末考）
Given a 6-sided die, what is the mutual information between the top side T and the front face F?

### 詳解

骰子相對面之和為 7（1-6, 2-5, 3-4）。知道頂面就確定了底面，但前面仍有 4 種可能（四個側面中的一個）。

H(T) = log₂6（頂面均勻分布）

H(F) = log₂6（前面均勻分布）

H(F|T)：已知頂面後，底面確定，剩 4 個側面等機率為前面。H(F|T) = log₂4 = 2。

$$I(T;F) = H(F) - H(F|T) = \log_2 6 - 2 = \log_2 6 - \log_2 4 = \log_2 \frac{6}{4} = \log_2 \frac{3}{2}$$

$$\boxed{I(T;F) = \log_2(3/2) \approx 0.585 \text{ bits}}$$

---

# 第二十五章：Exponential Distribution 進階

## 題目 25.1（林守德 102-2 期中考）
X ~ Exp, P(X < 50) = 0.25. Find P(X > 100 | X > 50).

### 詳解

P(X < 50) = 1 - e^{-λ·50} = 0.25 → e^{-50λ} = 0.75

由 memoryless property：

$$P(X > 100 | X > 50) = P(X > 50) = e^{-50\lambda} = \boxed{0.75}$$

---

## 題目 25.2（葉丙成 101-2 期末考）
李白 X ~ Exp(1/2), 賀知章 Y ~ Exp(1), independent.

(e) Joint PDF?
(f) E[X+Y] and std of X+Y?
(g) P(X > Y)?

### 詳解

**(e)** $f_{X,Y}(x,y) = f_X(x)f_Y(y) = \frac{1}{2}e^{-x/2} \cdot e^{-y}$

$$\boxed{f_{X,Y}(x,y) = \frac{1}{2}e^{-x/2-y}, \quad x > 0, y > 0}$$

**(f)** E[X+Y] = E[X] + E[Y] = 2 + 1 = 3 升

Var(X+Y) = Var(X) + Var(Y) = 4 + 1 = 5, σ = √5

$$\boxed{E[X+Y] = 3, \quad \sigma_{X+Y} = \sqrt{5} \approx 2.236}$$

**(g)** $P(X > Y) = \int_0^\infty \int_0^x \frac{1}{2}e^{-x/2} e^{-y} \, dy \, dx$

$= \int_0^\infty \frac{1}{2}e^{-x/2}(1 - e^{-x}) dx = \int_0^\infty \frac{1}{2}(e^{-x/2} - e^{-3x/2}) dx$

$= \frac{1}{2}\left[\frac{1}{1/2} - \frac{1}{3/2}\right] = \frac{1}{2}\left[2 - \frac{2}{3}\right] = \frac{1}{2} \cdot \frac{4}{3} = \frac{2}{3}$

$$\boxed{P(\text{李白勝}) = \frac{2}{3}}$$

（直觀：E[X]=2 > E[Y]=1，且 Exp 分布的 memoryless 性質使得 P(X>Y) = λ_Y/(λ_X+λ_Y) = 1/(1/2+1) = 2/3。）

---

# 第二十六章：MLE 進階

## 題目 26.1（劉長遠 103-2 期末考）
Geometric(P): f(x) = (1-P)^{x-1}·P, x=1,2,3,...
Data: 5, 2, 3. Find MLE of P.

### 詳解

$$L(P) = \prod_{i=1}^3 (1-P)^{x_i - 1} P = P^3 (1-P)^{(5-1)+(2-1)+(3-1)} = P^3 (1-P)^7$$

$$\ln L = 3\ln P + 7\ln(1-P)$$

$$\frac{d\ln L}{dP} = \frac{3}{P} - \frac{7}{1-P} = 0$$

$$3(1-P) = 7P \implies 3 = 10P$$

$$\boxed{\hat{P}_{MLE} = \frac{3}{10} = 0.3 = \frac{n}{\sum x_i} = \frac{3}{10}}$$

（一般：n 個觀測值的 MLE = n / Σxᵢ = 1/X̄。）

---

## 題目 26.2（林守德 103-2 期末考）
X₁, ..., Xₙ i.i.d. Geometric(p). MLE of p.

### 詳解

$$L(p) = \prod_{i=1}^n p(1-p)^{x_i-1} = p^n (1-p)^{\sum x_i - n}$$

$$\ln L = n\ln p + (\sum x_i - n)\ln(1-p)$$

$$\frac{\partial}{\partial p} = \frac{n}{p} - \frac{\sum x_i - n}{1-p} = 0$$

$$n(1-p) = p(\sum x_i - n) \implies n = p \sum x_i$$

$$\boxed{\hat{p}_{MLE} = \frac{n}{\sum_{i=1}^n X_i} = \frac{1}{\bar{X}}}$$

---

# 第二十七章：特殊應用題

## 題目 27.1（林守德 102-2 期中考）
**Modified Monty Hall**: n doors, k cars (k << n), n-k goats. After choosing, host opens a goat door. Should you switch?

### 詳解

**應該換（Switch）。**

最初選中車的機率 = k/n。

Host 開一扇有羊的門後，剩下 n-2 扇門中有 k-1（或 k）輛車。

- 若最初選中車（prob k/n）：剩 n-2 門中有 k-1 車。換的話中車機率 = (k-1)/(n-2)
- 若最初選中羊（prob (n-k)/n）：剩 n-2 門中有 k 車。換的話中車機率 = k/(n-2)

P(car if switch) = (k/n)·(k-1)/(n-2) + ((n-k)/n)·k/(n-2) = k[k-1+n-k]/[n(n-2)] = k(n-1)/[n(n-2)]

P(car if stay) = k/n

Ratio: switch/stay = (n-1)/(n-2) > 1

$$\boxed{\text{應該換。} P(\text{switch}) = \frac{k(n-1)}{n(n-2)} > \frac{k}{n} = P(\text{stay})}$$

---

## 題目 27.2（林守德 102-2 期中考）
**Estimate π**: Using only random() returning [0,1] and +,-,*,/.

### 詳解

**Monte Carlo 方法**：

```python
count = 0
N = 1000000  # 大量試驗
for i in range(N):
    x = random()
    y = random()
    if x*x + y*y <= 1:  # 落在四分之一圓內
        count += 1

pi_estimate = 4 * count / N
```

**原理**：單位正方形 [0,1]×[0,1] 面積 = 1。其中 x²+y² ≤ 1 的區域面積 = π/4（四分之一圓）。

隨機撒點落在圓內的比例 ≈ π/4，所以 π ≈ 4 × (圓內點數/總點數)。

$$\boxed{\pi \approx 4 \times \frac{\#\{(x,y) : x^2+y^2 \leq 1\}}{N}}$$

---

## 題目 27.3（林守德 102-2 期末考）
**饅頭問題**：巧克力饅頭每 10 分鐘出爐，草莓饅頭每 8 分鐘出爐，到達時兩種都賣完了。P(下一個出爐的是草莓)?

### 詳解

設 X = 巧克力饅頭等待時間 ~ Uniform(0,10)
設 Y = 草莓饅頭等待時間 ~ Uniform(0,8)

（假設兩者的出爐時間相互獨立，且到達時刻在各自的 cycle 中均勻分布。）

$$P(\text{草莓先出爐}) = P(Y < X) = \int_0^8 \int_y^{10} \frac{1}{10} \cdot \frac{1}{8} \, dx \, dy$$

$$= \frac{1}{80}\int_0^8 (10-y) \, dy = \frac{1}{80}\left[10y - \frac{y^2}{2}\right]_0^8 = \frac{1}{80}(80 - 32) = \frac{48}{80} = \boxed{\frac{3}{5} = 0.6}$$

小羊有 60% 的機率吃到草莓饅頭！
