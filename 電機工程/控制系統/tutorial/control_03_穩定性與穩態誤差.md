# 控制系統（三）：穩定性與穩態誤差

## 🔰 本章基礎觀念（零基礎必讀）

> 設計控制系統，**穩定性**是第一優先。一個不穩定的系統不只沒用，還可能造成災難（想像飛機的自動駕駛失控）。確定穩定之後，下一個問題是：系統最終能「追到」目標值嗎？如果追不到，差多少？這就是**穩態誤差**。本章教你兩個最重要的工具：Routh-Hurwitz 判據（判穩定）和系統型別（算誤差）。

---

## 一、BIBO 穩定性

### 1.1 定義

**BIBO 穩定（Bounded-Input Bounded-Output Stability）**：
> 若系統對任何有界輸入都產生有界輸出，則系統是 BIBO 穩定的。

### 1.2 極點判據

> **閉迴路系統穩定的充要條件：所有閉迴路極點都在 s 平面的左半平面（Left Half Plane, LHP），即所有極點的實部 < 0。**

| 極點位置 | 對應響應 | 穩定性 |
|----------|----------|--------|
| 左半平面（實部 < 0）| 衰減（e^(-at)）| 穩定 |
| 虛軸上（實部 = 0）| 等幅振盪或常數 | 臨界穩定（邊緣穩定）|
| 右半平面（實部 > 0）| 發散（e^(+at)）| 不穩定 |

### 1.3 問題

閉迴路特徵方程式可能是高次多項式，求根不容易。怎麼不求根就判斷穩定性？→ **Routh-Hurwitz 判據**！

---

## 二、Routh-Hurwitz 判據

### 2.1 特徵方程式

$$a_n s^n + a_{n-1} s^{n-1} + \cdots + a_1 s + a_0 = 0$$

**必要條件**：所有係數 $a_i$ 同號且不為零（若有缺項或異號，一定不穩定）。

### 2.2 Routh 表建立步驟

以 $a_4 s^4 + a_3 s^3 + a_2 s^2 + a_1 s + a_0 = 0$ 為例：

| 行 | | 第一欄 | 第二欄 | 第三欄 |
|---|---|--------|--------|--------|
| s⁴ | | a₄ | a₂ | a₀ |
| s³ | | a₃ | a₁ | 0 |
| s² | | b₁ | b₂ | |
| s¹ | | c₁ | | |
| s⁰ | | d₁ | | |

計算公式：

$$b_1 = \frac{a_3 a_2 - a_4 a_1}{a_3}, \quad b_2 = \frac{a_3 a_0 - a_4 \cdot 0}{a_3} = a_0$$

$$c_1 = \frac{b_1 a_1 - a_3 b_2}{b_1}$$

$$d_1 = \frac{c_1 b_2 - b_1 \cdot 0}{c_1} = b_2 = a_0$$

> **口訣**：交叉相乘再相減，除以上一行第一個。

### 2.3 Routh 判據

> **Routh 表第一列的正負號變化次數 = 右半平面（RHP）的極點數**

- 第一列全正（或全負）→ 沒有 RHP 極點 → **穩定**
- 有正負號變化 → 不穩定，變化次數 = RHP 極點數

**【例題 1】基本 Routh 判據**

特徵方程式：$s^4 + 2s^3 + 3s^2 + 4s + 5 = 0$

建 Routh 表：

| | 第一欄 | 第二欄 | 第三欄 |
|---|--------|--------|--------|
| s⁴ | 1 | 3 | 5 |
| s³ | 2 | 4 | 0 |
| s² | (2×3-1×4)/2 = 1 | (2×5-1×0)/2 = 5 | |
| s¹ | (1×4-2×5)/1 = -6 | | |
| s⁰ | 5 | | |

第一列：1, 2, 1, **-6**, 5

正負號變化：1→2（無）→1（無）→-6（有！）→5（有！）= **2 次變化**

結論：有 **2 個**右半平面極點 → **不穩定**。

**【例題 2】用 Routh 求穩定的 K 範圍**

閉迴路特徵方程式：$s^3 + 3s^2 + 2s + K = 0$

Routh 表：

| | 第一欄 | 第二欄 |
|---|--------|--------|
| s³ | 1 | 2 |
| s² | 3 | K |
| s¹ | (3×2-1×K)/3 = (6-K)/3 | |
| s⁰ | K | |

穩定條件（第一列全正）：
- s² 行：3 > 0 ✓（恆成立）
- s¹ 行：(6-K)/3 > 0 → K < 6
- s⁰ 行：K > 0

$$\boxed{0 < K < 6}$$

### 2.4 特殊情形一：第一列出現零

**處理方法**：用一個很小的正數 ε 代替 0，繼續計算，最後取 ε→0⁺ 的極限。

**【例題 3】第一列零的處理**

$s^3 + 2s^2 + 2s + 4 = 0$

| | 第一欄 | 第二欄 |
|---|--------|--------|
| s³ | 1 | 2 |
| s² | 2 | 4 |
| s¹ | (2×2-1×4)/2 = **0** → ε | |
| s⁰ | (ε×4-2×0)/ε = 4 | |

第一列：1, 2, ε, 4

當 ε→0⁺：全正 → 似乎穩定？但 ε 是 0 代表有虛軸上的極點。

驗證：$s^3+2s^2+2s+4 = (s+2)(s^2+2) = 0$

極點：s = -2, s = ±j√2

有純虛數極點 → **臨界穩定（邊緣穩定）**，嚴格來說不是 BIBO 穩定。

### 2.5 特殊情形二：整行為零

**處理方法**：
1. 用前一行的係數建立**輔助多項式 A(s)**
2. 對 A(s) 微分得 dA/ds
3. 用 dA/ds 的係數取代零行
4. 繼續建表

> **重要**：輔助多項式的根就是特徵方程式中對稱於原點的根（如 ±jω 或 ±σ）。

**【例題 4】整行零的處理**

$s^5 + 2s^4 + 2s^3 + 4s^2 + s + 2 = 0$

| | 第一欄 | 第二欄 | 第三欄 |
|---|--------|--------|--------|
| s⁵ | 1 | 2 | 1 |
| s⁴ | 2 | 4 | 2 |
| s³ | (4-4)/2=**0** | (2-2)/2=**0** | ← 整行零！|

用 s⁴ 行建輔助多項式：$A(s) = 2s^4 + 4s^2 + 2$

$dA/ds = 8s^3 + 8s$

用 [8, 8] 取代 s³ 行：

| | 第一欄 | 第二欄 | 第三欄 |
|---|--------|--------|--------|
| s⁵ | 1 | 2 | 1 |
| s⁴ | 2 | 4 | 2 |
| s³ | 8 | 8 | 0 |
| s² | (8×4-2×8)/8 = 2 | 2 | |
| s¹ | (2×8-8×2)/2 = 0 → ε | | |
| s⁰ | 2 | | |

第一列：1, 2, 8, 2, ε, 2 → 全正（ε→0⁺）

正負號無變化，但有 ε = 0 → 有虛軸上的極點。

$A(s) = 2(s^4+2s^2+1) = 2(s^2+1)^2 = 0 \Rightarrow s = \pm j$（重根）

結論：有虛軸極點，**不是 BIBO 穩定**。

---

## 三、穩態誤差分析

### 3.1 穩態誤差的定義

在閉迴路系統中，穩態誤差 $e_{ss}$ 是系統穩定後，輸出與輸入之間的持久差距。

$$e_{ss} = \lim_{t \to \infty} e(t) = \lim_{s \to 0} sE(s) \quad \text{（終值定理）}$$

### 3.2 誤差轉移函數

標準閉迴路（負回授）：

```
R(s) → ⊕ → [G(s)] → Y(s)
       ↑-             |
       └── [H(s)] ←──┘
```

$$E(s) = R(s) - Y(s)H(s)$$

其中 $Y(s) = \frac{G(s)}{1+G(s)H(s)} R(s)$

對於**單位回授（H=1）**：

$$E(s) = \frac{R(s)}{1 + G(s)} \quad \Rightarrow \quad e_{ss} = \lim_{s \to 0} \frac{sR(s)}{1 + G(s)}$$

### 3.3 系統型別（System Type）

> **系統型別 = 開迴路轉移函數 G(s)H(s) 在 s=0 處的極點數（即分母中 s 的次方）**

$$G(s)H(s) = \frac{K \prod(s+z_i)}{s^N \prod(s+p_j)}$$

N 就是系統型別（Type N）。

| 型別 | G(s)H(s) 特徵 | 例子 |
|------|---------------|------|
| Type 0 | 分母沒有 s 因子 | K/((s+1)(s+2)) |
| Type 1 | 分母有一個 s | K/(s(s+1)) |
| Type 2 | 分母有 s² | K/(s²(s+1)) |

### 3.4 誤差常數與穩態誤差

以下針對**單位回授**系統：

#### 步階輸入 R(s) = 1/s

$$e_{ss} = \frac{1}{1 + K_p}, \quad K_p = \lim_{s \to 0} G(s) \quad \text{（位置誤差常數）}$$

#### 斜坡輸入 R(s) = 1/s²

$$e_{ss} = \frac{1}{K_v}, \quad K_v = \lim_{s \to 0} sG(s) \quad \text{（速度誤差常數）}$$

#### 拋物線輸入 R(s) = 1/s³

$$e_{ss} = \frac{1}{K_a}, \quad K_a = \lim_{s \to 0} s^2 G(s) \quad \text{（加速度誤差常數）}$$

### 3.5 穩態誤差速查表（超重要！必背！）

| 輸入類型 | Type 0 | Type 1 | Type 2 |
|----------|--------|--------|--------|
| 步階 (1/s) | 1/(1+Kp) | **0** | **0** |
| 斜坡 (1/s²) | **∞** | 1/Kv | **0** |
| 拋物線 (1/s³) | **∞** | **∞** | 1/Ka |

> **口訣**：Type N 系統對 s^(-N) 階的輸入有有限誤差，更低階為零，更高階為無窮。

---

## 四、數值例題

**【例題 5】計算穩態誤差**

$$G(s) = \frac{100}{s(s+2)(s+5)}, \quad H(s) = 1 \text{（單位回授）}$$

(a) 系統型別？
(b) 步階輸入的穩態誤差？
(c) 斜坡輸入的穩態誤差？

**解**：
(a) G(s) 分母有一個 s → **Type 1**

(b) Type 1 對步階：$e_{ss} = 0$

(c) 斜坡：
$$K_v = \lim_{s \to 0} sG(s) = \lim_{s \to 0} \frac{100}{(s+2)(s+5)} = \frac{100}{10} = 10$$

$$e_{ss} = \frac{1}{K_v} = \frac{1}{10} = 0.1$$

**【例題 6】設計 K 使穩態誤差滿足規格**

$$G(s) = \frac{K}{(s+1)(s+4)}, \quad H(s) = 1$$

要求步階輸入的穩態誤差 ≤ 5%。求 K 的最小值。

**解**：
Type 0 系統。

$$K_p = \lim_{s \to 0} G(s) = \frac{K}{1\times4} = \frac{K}{4}$$

$$e_{ss} = \frac{1}{1+K_p} = \frac{1}{1+K/4} = \frac{4}{4+K} \leq 0.05$$

$$4+K \geq 80 \Rightarrow K \geq 76$$

$$\boxed{K \geq 76}$$

但要注意：K 太大可能造成不穩定！需用 Routh 判據確認。

**【例題 7】非單位回授的穩態誤差**

$$G(s) = \frac{10}{s(s+2)}, \quad H(s) = \frac{s+1}{s+5}$$

求單位斜坡輸入的穩態誤差。

**解**：
注意！非單位回授時，$E(s) = R(s) - Y(s)$ 不能直接用簡化公式。

回到基本定義：
$$E(s) = R(s) - Y(s) = R(s)\left(1 - \frac{G(s)}{1+G(s)H(s)}\right) = \frac{R(s)(1+G(s)H(s)-G(s))}{1+G(s)H(s)}$$

$$e_{ss} = \lim_{s \to 0} s \cdot \frac{1}{s^2} \cdot \frac{1+G(s)H(s)-G(s)}{1+G(s)H(s)}$$

先算各極限：
$$G(0)H(0) = \frac{10}{0} \to \infty \quad \text{（注意 G(s) 有 s 在分母！）}$$

更仔細地：
$$\lim_{s \to 0} \frac{s[1+G(s)H(s)-G(s)]}{s^2[1+G(s)H(s)]}$$

$$= \lim_{s \to 0} \frac{1+G(s)H(s)-G(s)}{s[1+G(s)H(s)]}$$

$$G(s)H(s) = \frac{10(s+1)}{s(s+2)(s+5)}, \quad G(s) = \frac{10}{s(s+2)}$$

分子：$1 + \frac{10(s+1)}{s(s+2)(s+5)} - \frac{10}{s(s+2)}$

$= \frac{s(s+2)(s+5) + 10(s+1) - 10(s+5)}{s(s+2)(s+5)}$

$= \frac{s^3+7s^2+10s + 10s+10 - 10s-50}{s(s+2)(s+5)}$

$= \frac{s^3+7s^2+10s - 40}{s(s+2)(s+5)}$

這變得很複雜。對於非單位回授，通常需要很小心。

較好的方法是直接用終值定理：

$$e_{ss} = \lim_{s\to 0} sE(s) = \lim_{s\to 0} \frac{sR(s)}{1+G(s)H(s)} \cdot [1+G(s)H(s)-G(s)]/(1)$$

簡化起見，非單位回授的穩態誤差定義為 $e_{ss} = \lim_{s\to 0} sE(s)$，其中 $E(s) = R(s) - B(s) = R(s) - Y(s)H(s)$，那麼：

$$E(s) = \frac{R(s)}{1+G(s)H(s)}$$

$$e_{ss} = \lim_{s \to 0} \frac{s \cdot (1/s^2)}{1+G(s)H(s)} = \lim_{s \to 0} \frac{1}{s \cdot [1+G(s)H(s)]}$$

$$sG(s)H(s) = \frac{10(s+1)}{(s+2)(s+5)} \xrightarrow{s\to 0} \frac{10}{10} = 1$$

$$e_{ss} = \lim_{s\to 0} \frac{1}{s + sG(s)H(s)} = \frac{1}{0+1} = 1$$

> 注意：此 $e_{ss}$ 是 r(t) 與 b(t)=y(t)H(0) 之差，不是 r(t) 與 y(t) 之差。非單位回授時要特別注意誤差定義。

**【例題 8】Routh 判據 + 穩態誤差綜合題**

$$G(s) = \frac{K(s+1)}{s^2(s+2)(s+10)}, \quad H(s)=1$$

(a) 求使系統穩定的 K 範圍
(b) 在穩定範圍內，拋物線輸入的穩態誤差

**解**：
(a) 閉迴路特徵方程式：$1 + G(s) = 0$

$$s^2(s+2)(s+10) + K(s+1) = 0$$
$$s^4 + 12s^3 + 20s^2 + Ks + K = 0$$

Routh 表：

| | 第一欄 | 第二欄 | 第三欄 |
|---|--------|--------|--------|
| s⁴ | 1 | 20 | K |
| s³ | 12 | K | 0 |
| s² | (240-K)/12 | K | |
| s¹ | [K(240-K)/12 - 12K] / [(240-K)/12] | | |
| s⁰ | K | | |

s¹ 行分子：$\frac{K(240-K) - 144K}{12} = \frac{240K - K^2 - 144K}{12} = \frac{K(96-K)}{12}$

穩定條件（全正）：
1. (240-K)/12 > 0 → K < 240
2. K(96-K)/12 > 0（分母已確認正）→ K(96-K) > 0 → 0 < K < 96
3. K > 0

$$\boxed{0 < K < 96}$$

(b) Type 2 系統（分母有 s²），拋物線輸入：

$$K_a = \lim_{s \to 0} s^2 G(s) = \lim_{s \to 0} \frac{K(s+1)}{(s+2)(s+10)} = \frac{K}{20}$$

$$e_{ss} = \frac{1}{K_a} = \frac{20}{K}$$

例如 K = 40：$e_{ss} = 20/40 = 0.5$

---

## 五、關鍵術語表

| 中文 | 英文 | 白話解釋 | 例子 |
|------|------|----------|------|
| BIBO 穩定 | BIBO Stability | 有界輸入→有界輸出 | 所有極點在 LHP |
| 特徵方程式 | Characteristic Equation | 閉迴路分母=0 | s²+3s+2=0 |
| Routh 表 | Routh Array/Table | 不解方程式就判穩定的工具 | 看第一列正負號 |
| 穩態誤差 | Steady-State Error (ess) | 系統穩定後，輸出與目標的差 | ess=0.1 |
| 系統型別 | System Type | 開迴路原點極點數 | Type 1：分母有一個 s |
| 位置誤差常數 | Position Error Constant (Kp) | lim G(s) as s→0 | Kp=50 |
| 速度誤差常數 | Velocity Error Constant (Kv) | lim sG(s) as s→0 | Kv=10 |
| 加速度誤差常數 | Acceleration Error Const. (Ka) | lim s²G(s) as s→0 | Ka=5 |
| 輔助多項式 | Auxiliary Polynomial | Routh 整行零時使用 | 對稱根的多項式 |
| 臨界穩定 | Marginally Stable | 極點在虛軸上 | s=±jω |

---

## 六、題型鑑別表

| 題目特徵 | 解題方法 |
|----------|----------|
| 判斷系統穩不穩定 | Routh 表→第一列正負號 |
| 求穩定的 K 範圍 | Routh 表→第一列全正的條件 |
| 求右半平面極點數 | Routh 表→第一列正負號變化次數 |
| Routh 表第一列有零 | 用 ε 代替 |
| Routh 表整行零 | 輔助多項式微分 |
| 求穩態誤差 | 先判型別→查速查表→算 Kp/Kv/Ka |
| 設計 K 使 ess 滿足規格 | 由 ess 公式反推 K |
| 非單位回授穩態誤差 | 回到 E(s) 基本定義 |

---

## ✅ 自我檢測

<details>
<summary><strong>Q1：Routh 表第一列為 [1, 3, 2, -5, 7]，有幾個 RHP 極點？</strong></summary>

**答**：數正負號變化：1→3（無）→2（無）→-5（有！）→7（有！）= 2 次變化 → **2 個 RHP 極點**。
</details>

<details>
<summary><strong>Q2：Type 1 系統對步階輸入的穩態誤差是多少？</strong></summary>

**答**：**0**。Type 1 有一個積分器，步階輸入的穩態誤差為零。
</details>

<details>
<summary><strong>Q3：G(s)=50/[s(s+5)(s+10)]，H=1。Kv 是多少？斜坡輸入的 ess？</strong></summary>

**答**：Type 1 系統。$K_v = \lim_{s\to 0} sG(s) = 50/(5\times10) = 1$。$e_{ss} = 1/K_v = 1$。
</details>

<details>
<summary><strong>Q4：Routh 表出現整行零代表什麼物理意義？</strong></summary>

**答**：特徵方程式有**對稱於原點**的根，可能是：(1) 純虛數根 ±jω，(2) 實數對稱根 ±σ，(3) 四個一組的根 ±σ±jω。這些根可以從輔助多項式求得。
</details>

<details>
<summary><strong>Q5：為什麼 Type 0 系統步階誤差不為零？直覺理解？</strong></summary>

**答**：Type 0 沒有積分器。系統需要非零的誤差訊號來「驅動」輸出維持在穩態值——如果誤差為零，控制器就不出力，輸出就掉回去。積分器可以「記住」過去的誤差，即使當前誤差為零也能維持輸出，所以 Type 1 以上才能消除步階誤差。
</details>

<details>
<summary><strong>Q6：特徵方程式 s³ + Ks² + 2s + 1 = 0，求穩定的 K 範圍。</strong></summary>

Routh 表：

| | C1 | C2 |
|---|---|---|
| s³ | 1 | 2 |
| s² | K | 1 |
| s¹ | (2K-1)/K | |
| s⁰ | 1 | |

穩定：K > 0, (2K-1)/K > 0 → 2K-1 > 0 → K > 1/2, 且 1 > 0 ✓

**答**：$K > 1/2$
</details>

---

> **下一章預告**：穩定性 OK，穩態誤差可接受，但你還不知道增益 K 到底該調多大。根軌跡法告訴你：K 從 0 到 ∞ 時，閉迴路極點怎麼移動——這是控制系統最美的圖形之一！
