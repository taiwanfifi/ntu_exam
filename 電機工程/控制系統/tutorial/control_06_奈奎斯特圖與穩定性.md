# 控制系統（六）：奈奎斯特圖與穩定性

## 🔰 本章基礎觀念（零基礎必讀）

> 波德圖把 G(jω) 的增益和相位「分開」畫成兩張圖。**奈奎斯特圖（Nyquist Plot）**則是直接把 G(jω) 當成一個複數，在「實部-虛部」的複數平面上，隨著 ω 從 -∞ 到 +∞ 畫出一條封閉曲線。這條曲線和 (-1, 0) 這個特殊點的關係，直接告訴你系統穩不穩定。奈奎斯特判據比 Routh 和波德圖更通用，能處理**開迴路不穩定**和**含時間延遲**的系統。

---

## 一、奈奎斯特圖的基本概念

### 1.1 什麼是奈奎斯特圖？

將 $G(j\omega)H(j\omega)$ 的值，隨著 ω 從 0 到 +∞ 在複數平面上畫出的曲線，就是奈奎斯特圖（的上半部分）。

因為 G(-jω) = G*(jω)（共軛），所以 ω 從 0 到 -∞ 的部分是上半部分對實軸的鏡像。

完整的奈奎斯特圖：ω 從 -∞ 到 +∞ 走一圈，形成封閉曲線。

### 1.2 繪製步驟

1. 從 ω=0⁺ 開始，計算 G(jω) 的實部和虛部
2. 逐漸增加 ω 到 +∞，畫出上半軌跡
3. 將上半軌跡對實軸取鏡像，得到下半軌跡（ω: 0⁻ 到 -∞）
4. 如果 G(s) 在虛軸上有極點（如 1/s），需要用小半圓繞過（見特殊情形）

### 1.3 一些基本圖形

**一階系統** $G(s) = \frac{1}{1+s\tau}$：

$$G(j\omega) = \frac{1}{1+j\omega\tau} = \frac{1-j\omega\tau}{1+\omega^2\tau^2}$$

- ω=0：G = 1（實軸上）
- ω→∞：G → 0
- 軌跡是以 (1/2, 0) 為圓心、半徑 1/2 的半圓（下半平面）

**積分器** $G(s) = \frac{1}{s}$：

$$G(j\omega) = \frac{1}{j\omega} = -\frac{j}{\omega}$$

- ω=0⁺：|G|→∞，∠G=-90°（沿負虛軸往下趨近無窮）
- ω→∞：|G|→0

---

## 二、奈奎斯特穩定性判據

### 2.1 幅角原理（Argument Principle / Cauchy's Principle）

如果一個封閉曲線 C 在 s 平面上包圍了函數 F(s) 的 Z 個零點和 P 個極點，那麼 F(s) 沿 C 的映射曲線將繞原點：

$$N = Z - P \text{ 圈（順時針為正）}$$

### 2.2 應用到控制系統

閉迴路特徵方程式：$1 + G(s)H(s) = 0$

令 $F(s) = 1 + G(s)H(s)$

- F(s) 的**零點** = 閉迴路特徵方程的根 = **閉迴路極點**
- F(s) 的**極點** = G(s)H(s) 的極點 = **開迴路極點**

選取「奈奎斯特路徑」（Nyquist Contour）：包圍整個右半平面的 D 形封閉曲線：
- 虛軸（jω，ω: -∞ → +∞）
- 右半平面無窮大的半圓

則：

$$\boxed{Z = N + P}$$

其中：
- **Z**：右半平面（RHP）的閉迴路極點數（我們希望 Z = 0）
- **N**：奈奎斯特圖繞 **(-1, 0)** 點的圈數（**順時針為正**）
- **P**：開迴路 RHP 極點數（已知）

> 注意：因為 F(s) = 1 + G(s)H(s)，所以 F(s) 繞原點 = G(s)H(s) 繞 (-1, 0) 點。

### 2.3 穩定條件

$$Z = 0 \quad \Rightarrow \quad N = -P$$

- **如果開迴路穩定（P=0）**：N = 0，奈奎斯特圖**不繞 (-1, 0) 點** → 閉迴路穩定
- **如果開迴路有 P 個 RHP 極點**：N = -P，奈奎斯特圖**逆時針繞 (-1, 0) 點 P 圈** → 閉迴路穩定

### 2.4 如何數 N（繞 (-1,0) 的圈數）

**方法**：從 (-1, 0) 點向右畫一條射線（往正實軸方向），數奈奎斯特曲線穿越這條射線的次數：
- 由下往上穿越：+1（順時針）
- 由上往下穿越：-1（逆時針）

N = 穿越次數的代數和

---

## 三、特殊情形：開迴路極點在虛軸上

### 3.1 問題

如果 G(s)H(s) 有極點在虛軸上（如 1/s 或 1/s²），奈奎斯特路徑不能通過這些極點。

### 3.2 處理方法

在虛軸上的極點處，用一個**半徑趨近零的小半圓**繞過（繞到右半平面那一側）。

**1/s 的情況**：

在 s = 0 處用小半圓 $s = \epsilon e^{j\theta}$，θ: -90° → +90°

$$G(s) = \frac{1}{s} \Rightarrow G(\epsilon e^{j\theta}) = \frac{1}{\epsilon} e^{-j\theta}$$

當 ε→0：幅值→∞，角度從 +90° 變到 -90°。

在奈奎斯特圖上，這對應一個**無窮大半徑的半圓**，從 ω=0⁻ 的位置順時針掃到 ω=0⁺ 的位置。

**1/s² 的情況**：

$$G(\epsilon e^{j\theta}) = \frac{1}{\epsilon^2} e^{-j2\theta}$$

角度變化 2×180° = 360°，畫出無窮大的整圓。

---

## 四、數值例題

**【例題 1】簡單系統的奈奎斯特圖**

$$G(s)H(s) = \frac{K}{(s+1)(s+2)}$$

P = 0（開迴路穩定）。

$$G(j\omega) = \frac{K}{(j\omega+1)(j\omega+2)} = \frac{K}{(1+j\omega)(2+j\omega)}$$

- ω=0：$G = K/2$（正實軸上）
- ω→∞：$|G| → 0$，$\angle G = -\tan^{-1}\omega - \tan^{-1}(\omega/2) \to -180°$

軌跡從 (K/2, 0) 出發，在下半平面畫弧，趨近原點時角度趨近 -180°。

判穩定：奈奎斯特圖（含共軛部分）是否繞 (-1, 0)？

只要 K/2 > 0（K>0），圖的起點在正實軸，不會到 (-1, 0) 的左邊 → **N = 0 → Z = 0 + 0 = 0 → 穩定**（對所有 K > 0）。

但如果 K < 0 且 |K/2| > 1，即 K < -2，軌跡起點超過 (-1,0) → 可能繞 (-1,0) → 不穩定。

**【例題 2】三階系統——有條件穩定**

$$G(s)H(s) = \frac{K}{s(s+1)(s+2)}$$

P = 0（無 RHP 開迴路極點；s=0 在虛軸上，不算 RHP）。

**ω=0⁺ 到 ω→∞ 的軌跡**：

$$G(j\omega) = \frac{K}{j\omega(1+j\omega)(2+j\omega)}$$

- ω=0⁺：$|G| \to \infty$，$\angle G = -90° - 0° - 0° = -90°$
  （沿負虛軸從無窮遠處出發）
- ω→∞：$|G| \to 0$，$\angle G \to -90°-90°-90° = -270°$
  （趨近原點，角度 -270° = +90°，即沿正虛軸方向）

**關鍵：軌跡是否穿越負實軸？**

在負實軸上，$\text{Im}[G(j\omega)] = 0$。

$$G(j\omega) = \frac{K}{j\omega(1+j\omega)(2+j\omega)}$$

分母展開：$j\omega[(2+j\omega)+j\omega(2+j\omega)] = j\omega[2+3j\omega-\omega^2]$
$= j\omega(2-\omega^2) - 3\omega^2$
$= -3\omega^2 + j\omega(2-\omega^2)$

$$G(j\omega) = \frac{K}{-3\omega^2 + j\omega(2-\omega^2)}$$

有理化：
$$G(j\omega) = \frac{K[-3\omega^2 - j\omega(2-\omega^2)]}{9\omega^4 + \omega^2(2-\omega^2)^2}$$

虛部 = 0：$\omega(2-\omega^2) = 0$

$\omega = 0$ 或 $\omega = \sqrt{2}$

在 $\omega = \sqrt{2}$：

$$G(j\sqrt{2}) = \frac{K \cdot (-3\cdot2)}{9\cdot4+0} = \frac{-6K}{36} = \frac{-K}{6}$$

軌跡穿越負實軸的點是 $(-K/6, 0)$。

**穩定條件**（N=0 → 不繞 (-1,0)）：

$-K/6 > -1$（交點在 (-1,0) 的右邊）

$K/6 < 1 \Rightarrow K < 6$

$$\boxed{0 < K < 6 \text{ 時穩定}}$$

（與 Routh 判據結果一致！）

**【例題 3】開迴路不穩定系統**

$$G(s)H(s) = \frac{K}{(s-1)(s+2)}$$

P = 1（一個 RHP 開迴路極點 s=1）。

穩定條件：$Z = 0 \Rightarrow N = -P = -1$（奈奎斯特圖必須**逆時針繞 (-1,0) 一圈**）。

$$G(j\omega) = \frac{K}{(j\omega-1)(j\omega+2)}$$

- ω=0：$G = K/((-1)(2)) = -K/2$（負實軸上！）
- ω→∞：$|G| \to 0$，$\angle G \to -90°-90° = -180°$（但因為一個極點在 RHP，需更仔細計算角度）

嚴格：$\angle G = -[\angle(j\omega-1) + \angle(j\omega+2)]$

$\angle(j\omega-1) = \pi - \tan^{-1}\omega$（第二象限）
$\angle(j\omega+2) = \tan^{-1}(\omega/2)$（第一象限）

$\angle G = -[\pi - \tan^{-1}\omega + \tan^{-1}(\omega/2)]$

ω=0：$\angle G = -[\pi - 0 + 0] = -180°$ → 在負實軸 ✓
ω→∞：$\angle G = -[\pi - 90° + 90°] = -180°$ → 也是 -180°

需要更仔細地看中間頻率的相位變化。

在 ω 中間某處，相位會超過 -180° 再回來。

令 Im[G] = 0 找實軸交點：

$$G(j\omega) = \frac{K}{-\omega^2-2+j\omega \cdot 1} = \frac{K}{(-\omega^2-2)+j\omega}$$

有理化：$\frac{K[(-\omega^2-2)-j\omega]}{(\omega^2+2)^2+\omega^2}$

Im = 0：$\omega = 0$（唯一解），所以除了 ω=0 外不再穿越實軸。

在 ω=0 處：$G(0) = -K/2$

對於 K > 2：$G(0) = -K/2 < -1$，起點在 (-1,0) 左邊。

曲線從 (-K/2, 0) 出發（ω=0），在下半平面畫弧到原點（ω→∞），共軛部分在上半平面。

如果 K > 2：起點 (-K/2, 0) 在 (-1,0) 左邊，曲線繞 (-1,0) 逆時針一圈 → N = -1 → Z = -1+1 = 0 → **穩定**！

如果 0 < K < 2：起點在 (-1,0) 和原點之間，不繞 (-1,0) → N = 0 → Z = 1 → **不穩定**。

$$\boxed{K > 2 \text{ 時穩定}}$$

> 這個例子說明奈奎斯特判據可以處理開迴路不穩定的情況，而波德圖的簡單 GM/PM 準則則不適用。

**【例題 4】含時間延遲的系統**

$$G(s) = \frac{Ke^{-Ls}}{s+1}$$

L 為時間延遲。$e^{-jωL}$ 只影響相位（增加 -ωL 弧度），不影響增益。

$$G(j\omega) = \frac{K}{1+j\omega} \cdot e^{-j\omega L}$$

奈奎斯特圖：基本形狀和 K/(1+jω) 一樣，但隨著 ω 增加會不斷「旋轉」（因為 e^{-jωL} 的相位持續下降）。

這使得奈奎斯特圖可能繞 (-1,0)，導致系統不穩定。

穩定條件：在 |G|=1 時，相位不能超過 -180°。

$$|G| = K/\sqrt{1+\omega^2} = 1 \Rightarrow \omega_{gc} = \sqrt{K^2-1}$$

$$\angle G = -\tan^{-1}\omega_{gc} - \omega_{gc}L > -180°$$

這給出 K 和 L 的穩定條件。

---

## 五、增益邊限與相位邊限的圖形判讀

### 5.1 在奈奎斯特圖上讀 GM 和 PM

- **GM**：奈奎斯特曲線穿越負實軸的點到原點的距離為 $|G(j\omega_{pc})|$，則 $GM = 1/|G(j\omega_{pc})|$。即 (-1,0) 到交點的距離反映了增益邊限。

- **PM**：從原點畫半徑 1 的單位圓，奈奎斯特曲線與單位圓的交點角度為 $\angle G(j\omega_{gc})$，則 $PM = 180° + \angle G(j\omega_{gc})$。

```
        Im
        ↑
        |      ╱ 奈奎斯特曲線
        |    ╱
        |  ╱
────(-1)──╱──(交點)────── Re
        |╱    ↑
        |   這裡到(-1,0)
        |   的距離反映GM
```

### 5.2 與波德圖的對應

| 波德圖 | 奈奎斯特圖 |
|--------|-----------|
| |G(jω)| vs ω | 到原點的距離 |
| ∠G(jω) vs ω | 與正實軸的角度 |
| ωgc：0 dB 處 | 單位圓交點 |
| ωpc：-180° 處 | 負實軸交點 |
| GM > 0 dB | 負實軸交點在 (-1,0) 右邊 |
| PM > 0° | 穿越單位圓時角度 > -180° |

---

## 六、常見轉移函數的奈奎斯特圖形狀

| G(s)H(s) | 奈奎斯特圖描述 |
|-----------|---------------|
| K/(s+a) | 下半平面半圓，從 K/a 到 0 |
| K/[s(s+a)] | 從 -j∞ 出發，穿越負實軸到原點 |
| K/[(s+a)(s+b)] | 下半平面弧線，從 K/ab 到 0 |
| K/[s(s+a)(s+b)] | 從 -j∞ 出發，穿越負實軸 |
| K/[s²(s+a)] | 從 -∞ 出發（沿正實軸方向旋轉），較複雜 |

---

## 七、關鍵術語表

| 中文 | 英文 | 白話解釋 | 例子 |
|------|------|----------|------|
| 奈奎斯特圖 | Nyquist Plot | G(jω) 在複數平面上的軌跡 | 一條封閉曲線 |
| 奈奎斯特路徑 | Nyquist Contour | s 平面上包圍 RHP 的 D 形路徑 | 虛軸 + 大半圓 |
| 幅角原理 | Argument Principle | 映射繞原點圈數 = Z - P | N = Z - P |
| 包圍 (-1,0) | Encirclement of (-1,0) | 奈奎斯特曲線繞 (-1,0) 的圈數 | N = 2（順時針）|
| P | Open-loop RHP poles | 開迴路 RHP 極點數 | P = 0 表示開迴路穩定 |
| Z | Closed-loop RHP poles | 閉迴路 RHP 極點數 | Z = 0 才穩定 |
| N | Encirclements | 繞 (-1,0) 圈數（順時針正）| N = Z - P |
| 條件穩定 | Conditionally Stable | 只在某 K 範圍穩定 | K 太大或太小都不穩定 |
| 時間延遲 | Time Delay | e^(-Ls) 使相位持續下降 | 網路延遲、感測器延遲 |
| 最小相位 | Minimum Phase | 無 RHP 零點和極點 | 可用簡化判據 |

---

## 八、題型鑑別表

| 題目特徵 | 解題方法 |
|----------|----------|
| 畫奈奎斯特圖 | 求 G(jω) 的實虛部，找關鍵點（ω=0, ∞, 實軸交點）|
| 用奈奎斯特判穩定 | 數 N（繞 (-1,0) 圈數），Z = N + P |
| 開迴路不穩定系統 | P ≠ 0，需要 N = -P（逆時針 P 圈）|
| 求穩定 K 範圍 | 找負實軸交點，要求在 (-1,0) 右邊 |
| 虛軸上有極點 | 用小半圓繞過 |
| 讀 GM/PM | 看負實軸交點和單位圓交點 |
| 含時間延遲 | 相位額外減 ωL |

---

## ✅ 自我檢測

<details>
<summary><strong>Q1：奈奎斯特判據中的 (-1, 0) 點為什麼特殊？</strong></summary>

**答**：閉迴路特徵方程是 $1+G(s)H(s)=0$，即 $G(s)H(s)=-1$。所以 G(s)H(s) 是否等於 -1（即是否經過 (-1,0) 點）決定了穩定性的臨界。奈奎斯特圖繞 (-1,0) 的圈數直接反映閉迴路的 RHP 極點數。
</details>

<details>
<summary><strong>Q2：開迴路穩定（P=0）時，穩定條件簡化為什麼？</strong></summary>

**答**：Z = N + 0 = N。所以 Z = 0 要求 N = 0，即奈奎斯特圖**不包圍 (-1,0) 點**。
</details>

<details>
<summary><strong>Q3：N 為正（順時針）代表什麼？N 為負（逆時針）呢？</strong></summary>

**答**：N > 0（順時針）→ Z > P，閉迴路比開迴路「多出」RHP 極點。N < 0（逆時針）→ Z < P，回授「拉回」了一些不穩定極點。N = -P → Z = 0，全部拉回→穩定。
</details>

<details>
<summary><strong>Q4：為什麼奈奎斯特判據能處理時間延遲，而 Routh 不能？</strong></summary>

**答**：Routh 判據要求特徵方程式是 s 的多項式，但 $e^{-Ls}$ 不是多項式（它是超越函數）。奈奎斯特判據只需要畫出 G(jω) 的圖形，不管轉移函數的形式，所以能處理時間延遲。
</details>

<details>
<summary><strong>Q5：G(s)=K/[s(s+3)]，P=0。在奈奎斯特圖上，軌跡穿越負實軸的位置在哪裡？</strong></summary>

**答**：
$$G(j\omega) = \frac{K}{j\omega(j\omega+3)} = \frac{K}{-\omega^2+3j\omega}$$
有理化：$\frac{K(-\omega^2-3j\omega)}{\omega^4+9\omega^2}$

Im=0：$3\omega = 0 \Rightarrow \omega = 0$

只在 ω=0 穿越實軸（在無窮遠處）。**軌跡不穿越有限的負實軸** → 對所有 K>0 穩定（因為只有兩個極點，相位最多 -180°，不會超過）。
</details>

---

> **下一章預告**：知道了系統的穩定性和性能後，如果不滿意怎麼辦？第七章教你設計控制器——PID、超前補償、滯後補償——讓系統按你的要求表現！
