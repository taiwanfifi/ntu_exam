# 信號與系統 第三章：傅立葉級數

---

## 🔰 本章基礎觀念（零基礎必讀）

### 為什麼要做頻率分析？

想像你在聽一個管弦樂團演奏。你的耳朵同時接收到小提琴、大提琴、長笛、鼓的聲音——全部混在一起成為一個單一的聲波。

但你的大腦卻能分辨出不同樂器的聲音。為什麼？因為不同樂器發出**不同頻率**的聲音。

> **頻率分析就是把一個複雜的信號拆解成不同頻率的「純音」（正弦波）的組合。**

這就像用三稜鏡把白光分解成彩虹一樣：

```
白光（時域信號） → [三稜鏡/傅立葉分析] → 紅橙黃綠藍靛紫（各頻率分量）
```

### 時域 vs 頻域

- **時域（Time Domain）**：觀察信號「隨時間」如何變化 → x(t) 的圖
- **頻域（Frequency Domain）**：觀察信號「包含哪些頻率，各自多強」→ 頻譜圖

> **同一個信號，兩種不同的觀看角度。** 就像一棟建築的正面照和側面照，描述的是同一棟建築。

### 傅立葉級數的適用場景

**傅立葉級數（Fourier Series）** 專門用來分析**週期信號**。

> 週期信號 = 有限個（或無限個）正弦波的疊加

---

## 關鍵術語表

| 中文 | 英文 | 白話解釋 | 例子 |
|------|------|----------|------|
| 傅立葉級數 | Fourier Series (FS) | 把週期信號拆成一系列諧波的和 | 方波 = sin 的奇次諧波之和 |
| 基本頻率 | Fundamental frequency ω₀ | 最低的頻率分量，等於 2π/T | T=1s → ω₀=2π |
| 諧波 | Harmonic | 基本頻率的整數倍 | 2ω₀, 3ω₀, ... |
| 傅立葉係數 | Fourier coefficient aₖ | 第 k 個諧波的「強度和相位」| |
| 振幅譜 | Magnitude spectrum | 各諧波的振幅 \|aₖ\| | |
| 相位譜 | Phase spectrum | 各諧波的相位 ∠aₖ | |
| Parseval 定理 | Parseval's theorem | 時域能量 = 頻域能量 | |
| Gibbs 現象 | Gibbs phenomenon | 用有限項逼近不連續點時的過衝 | 方波的「耳朵」|
| CTFS | CT Fourier Series | 連續時間傅立葉級數 | |
| DTFS | DT Fourier Series | 離散時間傅立葉級數 | |
| 直流分量 | DC component | k=0 的分量，即信號平均值 | a₀ |

---

## 一、連續時間傅立葉級數（CTFS）

### 1.1 合成公式（Synthesis）

任何週期為 T 的信號 x(t) 可以表示為：

$$x(t) = \sum_{k=-\infty}^{\infty} a_k \, e^{jk\omega_0 t}$$

其中 ω₀ = 2π/T 是**基本角頻率**。

> **白話**：x(t) 是無限多個複指數 e^(jkω₀t)（不同頻率的「旋轉」）的加權和。

### 1.2 分析公式（Analysis）

傅立葉係數 aₖ 的計算方式：

$$a_k = \frac{1}{T} \int_{T} x(t) \, e^{-jk\omega_0 t} \, dt$$

積分區間是任意一個完整週期（通常取 [0, T] 或 [-T/2, T/2]）。

> **白話**：把 x(t) 乘以 e^(-jkω₀t) 再平均，就「篩出」了頻率 kω₀ 的分量有多少。

### 1.3 三角形式（等價表示）

$$x(t) = a_0 + 2\sum_{k=1}^{\infty} |a_k| \cos(k\omega_0 t + \angle a_k)$$

- a₀ = 信號的**直流分量**（平均值）
- |aₖ| = 第 k 次諧波的振幅
- ∠aₖ = 第 k 次諧波的相位

### 1.4 實信號的對稱性

如果 x(t) 是實數信號：

$$a_{-k} = a_k^*$$

也就是說：
- |a₋ₖ| = |aₖ|（振幅譜**偶對稱**）
- ∠a₋ₖ = -∠aₖ（相位譜**奇對稱**）

> 所以對實信號，只需要畫 k ≥ 0 的部分就夠了。

---

## 二、常見波形的傅立葉級數

### 2.1 方波（Square Wave）

週期 T，振幅 ±1，佔空比 50% 的方波：

$$x(t) = \begin{cases} 1, & 0 < t < T/2 \\ -1, & T/2 < t < T \end{cases}$$

傅立葉係數：

$$a_k = \begin{cases} \frac{2}{jk\pi}, & k \text{ 為奇數} \\ 0, & k \text{ 為偶數（含 } k=0\text{）} \end{cases}$$

> **方波只包含奇次諧波！** 這是重要的特徵。

等價寫法：

$$x(t) = \frac{4}{\pi}\left[\sin(\omega_0 t) + \frac{1}{3}\sin(3\omega_0 t) + \frac{1}{5}\sin(5\omega_0 t) + \cdots\right]$$

### 數值例題 2.1：方波的傅立葉係數

> **問題**：週期 T = 2、在 [-0.5, 0.5] 為 1、其餘為 0 的週期矩形脈衝（佔空比 50%），求 aₖ。

**解答**：

ω₀ = 2π/T = π。積分區間取 [-1, 1]：

$$a_k = \frac{1}{2} \int_{-0.5}^{0.5} 1 \cdot e^{-jk\pi t} \, dt$$

$$= \frac{1}{2} \left[\frac{e^{-jk\pi t}}{-jk\pi}\right]_{-0.5}^{0.5}$$

$$= \frac{1}{2} \cdot \frac{e^{-jk\pi/2} - e^{jk\pi/2}}{-jk\pi}$$

$$= \frac{1}{2} \cdot \frac{-2j\sin(k\pi/2)}{-jk\pi} = \frac{\sin(k\pi/2)}{k\pi}$$

所以 aₖ = sinc(k/2)（取樣函數形式），其中 sinc(x) = sin(πx)/(πx)。

k=0 時：a₀ = 1/T × (脈衝寬度) = 1/2 × 1 = **0.5**（直流分量 = 脈衝佔空比）

### 2.2 三角波（Triangle Wave）

週期 T 的對稱三角波：

$$a_k = \begin{cases} \frac{4}{k^2\pi^2}, & k \text{ 為奇數} \\ 0, & k \text{ 為偶數（} k \neq 0 \text{）} \end{cases}$$

> 三角波的係數衰減如 1/k²（比方波的 1/k 快），所以三角波比較「平滑」。

### 2.3 鋸齒波（Sawtooth Wave）

從 -1 線性上升到 1 的鋸齒波（週期 T）：

$$a_k = \frac{(-1)^{k+1}}{jk\pi} = \frac{j(-1)^k}{k\pi}, \quad k \neq 0$$

$$a_0 = 0 \text{（平均值為 0）}$$

等價：

$$x(t) = \frac{2}{\pi}\left[\sin(\omega_0 t) - \frac{1}{2}\sin(2\omega_0 t) + \frac{1}{3}\sin(3\omega_0 t) - \cdots\right]$$

> 鋸齒波包含**所有**諧波（偶次和奇次都有），這跟方波不同。

---

## 三、頻譜圖

### 3.1 振幅譜（Magnitude Spectrum）

畫出 |aₖ| 對 k（或 kω₀）的圖。

- 橫軸：頻率 kω₀（或諧波編號 k）
- 縱軸：|aₖ|

### 3.2 相位譜（Phase Spectrum）

畫出 ∠aₖ 對 k 的圖。

### 數值例題 3.1：畫頻譜圖

> **問題**：x(t) = 1 + 2cos(3t) + 4sin(6t)，求傅立葉係數並畫頻譜。

**解答**：

先轉成複指數形式：

$$x(t) = 1 + 2 \cdot \frac{e^{j3t} + e^{-j3t}}{2} + 4 \cdot \frac{e^{j6t} - e^{-j6t}}{2j}$$

$$= 1 + e^{j3t} + e^{-j3t} + \frac{4}{2j}e^{j6t} - \frac{4}{2j}e^{-j6t}$$

$$= 1 + e^{j3t} + e^{-j3t} - 2je^{j6t} + 2je^{-j6t}$$

基本頻率 ω₀ = 3（因為 GCD(3,6) = 3），T = 2π/3。

$$a_0 = 1, \quad a_1 = 1, \quad a_{-1} = 1, \quad a_2 = -2j, \quad a_{-2} = 2j$$

振幅譜：
- |a₀| = 1
- |a₁| = |a₋₁| = 1
- |a₂| = |a₋₂| = 2

相位譜：
- ∠a₀ = 0
- ∠a₁ = ∠a₋₁ = 0
- ∠a₂ = -π/2，∠a₋₂ = π/2

---

## 四、Parseval 定理

### 4.1 連續時間版本

$$\frac{1}{T} \int_T |x(t)|^2 \, dt = \sum_{k=-\infty}^{\infty} |a_k|^2$$

> **白話**：信號在一個週期內的**平均功率** = 各諧波功率之和。

左邊是時域計算的平均功率，右邊是頻域計算的功率。

### 數值例題 4.1：Parseval 定理驗證

> **問題**：x(t) = cos(t)，驗證 Parseval 定理。

**解答**：

**時域**：
$$P = \frac{1}{2\pi}\int_0^{2\pi} \cos^2(t) \, dt = \frac{1}{2\pi} \cdot \pi = \frac{1}{2}$$

**頻域**：cos(t) = (1/2)e^(jt) + (1/2)e^(-jt)，所以 a₁ = 1/2, a₋₁ = 1/2。

$$\sum |a_k|^2 = |a_1|^2 + |a_{-1}|^2 = \frac{1}{4} + \frac{1}{4} = \frac{1}{2}$$

兩邊相等 ✓

### 數值例題 4.2：利用 Parseval 求功率

> **問題**：某週期信號的傅立葉係數為 a₀ = 2, a₁ = 1-j, a₂ = 0.5j，x(t) 為實信號。求平均功率。

**解答**：

x(t) 為實信號 → a₋ₖ = aₖ*

$$P = |a_0|^2 + 2|a_1|^2 + 2|a_2|^2$$

$$= 4 + 2(1+1) + 2(0.25) = 4 + 4 + 0.5 = 8.5$$

（注意：因為 a₋ₖ = aₖ*，所以 |a₋ₖ|² = |aₖ|²，正負加起來就是 2|aₖ|²。）

---

## 五、Gibbs 現象

### 5.1 什麼是 Gibbs 現象？

當我們用**有限項**傅立葉級數去逼近一個有不連續點的信號（如方波），在不連續點附近會出現約 **9%** 的過衝（overshoot）。

> 不管取多少項，這個 9% 的過衝永遠不會消失——只是過衝的寬度會越來越窄。

### 5.2 為什麼重要？

- 在數位信號處理中，Gibbs 現象會造成「波紋」（ripple）
- 實際濾波器設計需要考慮這個效應
- 可以用「窗函數」（如 Hamming window）來緩解

---

## 六、離散時間傅立葉級數（DTFS）

### 6.1 定義

對週期為 N 的離散時間信號 x[n]：

**合成公式**：

$$x[n] = \sum_{k=0}^{N-1} a_k \, e^{jk(2\pi/N)n}$$

**分析公式**：

$$a_k = \frac{1}{N} \sum_{n=0}^{N-1} x[n] \, e^{-jk(2\pi/N)n}$$

### 6.2 DTFS 與 CTFS 的關鍵差異

| 項目 | CTFS | DTFS |
|------|------|------|
| 諧波數量 | 無限多個 | 只有 N 個（k = 0, 1, ..., N-1）|
| 頻率 | kω₀ 可以無限高 | 頻率是週期性的（2π 週期）|
| 收斂性 | 可能有 Gibbs 現象 | 有限和，無收斂問題 |

> **離散信號的頻譜是週期性的**，這是離散系統最重要的特性之一！

### 數值例題 6.1：DTFS 計算

> **問題**：x[n] = {1, 0, -1, 0}（週期 N = 4），求 DTFS 係數。

**解答**：

ω₀ = 2π/4 = π/2。

$$a_k = \frac{1}{4}\sum_{n=0}^{3} x[n] \, e^{-jk(\pi/2)n}$$

**k = 0**：
$$a_0 = \frac{1}{4}(1 + 0 + (-1) + 0) = 0$$

**k = 1**：
$$a_1 = \frac{1}{4}(1 \cdot 1 + 0 + (-1) \cdot e^{-j\pi} + 0) = \frac{1}{4}(1 + (-1)(-1)) = \frac{1}{4}(1+1) = \frac{1}{2}$$

**k = 2**：
$$a_2 = \frac{1}{4}(1 + 0 + (-1) \cdot e^{-j2\pi} + 0) = \frac{1}{4}(1 + (-1)(1)) = 0$$

**k = 3**：
$$a_3 = \frac{1}{4}(1 + 0 + (-1) \cdot e^{-j3\pi} + 0) = \frac{1}{4}(1 + (-1)(-1)) = \frac{1}{2}$$

**答：a₀ = 0, a₁ = 1/2, a₂ = 0, a₃ = 1/2**

驗證：x[n] = (1/2)e^(j(π/2)n) + (1/2)e^(j(3π/2)n)
= (1/2)e^(j(π/2)n) + (1/2)e^(-j(π/2)n) = cos(πn/2) ✓

---

## 七、傅立葉級數的收斂條件

### Dirichlet 條件

若 x(t) 滿足以下條件，傅立葉級數就會收斂：

1. x(t) 在一個週期內**絕對可積**：∫_T |x(t)| dt < ∞
2. x(t) 在一個週期內只有**有限個不連續點**
3. x(t) 在一個週期內只有**有限個極值點**

> 工程上遇到的信號幾乎都滿足 Dirichlet 條件，所以通常不必擔心收斂問題。

---

## 八、題型鑑別

| 看到什麼 | 用什麼方法 |
|----------|-----------|
| 「求週期信號的傅立葉係數 aₖ」 | 用分析公式 aₖ = (1/T)∫x(t)e^(-jkω₀t)dt |
| 「由係數重建信號」 | 用合成公式 x(t) = Σaₖe^(jkω₀t) |
| 「畫頻譜圖」 | 算出 aₖ，畫 \|aₖ\| vs k 和 ∠aₖ vs k |
| 「求平均功率」 | Parseval：P = Σ\|aₖ\|² |
| 「x(t) = A + Bcos(ωt) + ...」 | 直接讀出：a₀ = A, 其餘用尤拉公式轉 |
| 「實信號的對稱性」 | a₋ₖ = aₖ*，\|aₖ\| 偶對稱，∠aₖ 奇對稱 |
| 「方波的係數」 | 只有奇次諧波，衰減如 1/k |
| 「離散週期信號的 DTFS」 | 只有 N 個係數，用 DTFS 公式 |

---

## ✅ 自我檢測

### 問題 1
x(t) = 3 + 4cos(5t) - 2sin(10t) 的基本週期和基本角頻率是什麼？

<details>
<summary>點擊查看答案</summary>

cos(5t) 的角頻率是 5，sin(10t) 的角頻率是 10。

基本角頻率 ω₀ = GCD(5, 10) = **5 rad/s**。

基本週期 T = 2π/ω₀ = **2π/5 s**。

</details>

### 問題 2
週期為 2 的信號 x(t) = t，0 ≤ t < 2（鋸齒波），求 a₀。

<details>
<summary>點擊查看答案</summary>

$$a_0 = \frac{1}{T}\int_0^T x(t) dt = \frac{1}{2}\int_0^2 t \, dt = \frac{1}{2} \cdot \frac{t^2}{2}\Big|_0^2 = \frac{1}{2} \cdot 2 = 1$$

a₀ = 1，也就是信號在一個週期內的平均值。

</details>

### 問題 3
某週期信號的傅立葉係數為 aₖ = 1/(1+k²)，求平均功率。（提示：Σ_{k=-∞}^{∞} 1/(1+k²)² 的值可用查表或近似。）

<details>
<summary>點擊查看答案</summary>

$$P = \sum_{k=-\infty}^{\infty} |a_k|^2 = \sum_{k=-\infty}^{\infty} \frac{1}{(1+k^2)^2}$$

這個級數可以用 Parseval 定理的反向應用或數值計算。

$$= 1 + 2\sum_{k=1}^{\infty} \frac{1}{(1+k^2)^2}$$

精確值為 $\frac{\pi \cosh(\pi)(1+\pi\coth(\pi))}{2\sinh^2(\pi)} \approx 1.4465$

考試中如果不需精確值，可以用有限項近似：
$$\approx 1 + 2(\frac{1}{4} + \frac{1}{25} + \frac{1}{100} + \cdots) \approx 1.60$$

（取前幾項即可得到不錯的近似。）

</details>

### 問題 4
為什麼方波的傅立葉級數只包含奇次諧波？

<details>
<summary>點擊查看答案</summary>

佔空比 50% 的方波具有**半波對稱性**：x(t + T/2) = -x(t)。

把這個性質代入 aₖ 的計算，可以證明偶數 k 的 aₖ = 0。

直覺理解：偶次諧波在半個週期後會回到自己（cos(kω₀(t+T/2)) = cos(kω₀t) for even k），但方波在半個週期後是相反的值。所以偶次諧波無法表達方波的這種「正負交替」特性。

</details>

### 問題 5
已知 x(t) 的傅立葉係數為 aₖ，求 x(t-t₀) 的傅立葉係數。

<details>
<summary>點擊查看答案</summary>

$$x(t-t_0) = \sum_k a_k e^{jk\omega_0(t-t_0)} = \sum_k \underbrace{(a_k e^{-jk\omega_0 t_0})}_{b_k} e^{jk\omega_0 t}$$

所以 x(t-t₀) 的傅立葉係數為：

$$b_k = a_k \cdot e^{-jk\omega_0 t_0}$$

振幅不變（|bₖ| = |aₖ|），相位多了一個線性偏移（∠bₖ = ∠aₖ - kω₀t₀）。

**時移不改變振幅譜，只改變相位譜。**

</details>

---

> **下一章預告**：傅立葉級數只能處理週期信號。接下來的**傅立葉轉換**將把頻率分析推廣到**非週期信號**，讓我們能分析任何信號的頻率內容。
