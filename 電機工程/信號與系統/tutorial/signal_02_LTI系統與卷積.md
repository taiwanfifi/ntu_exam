# 信號與系統 第二章：LTI 系統與卷積

---

## 🔰 本章基礎觀念（零基礎必讀）

### 為什麼要學系統性質？

想像你在選購音響。你會問：
- 「如果我調大音量（輸入加倍），聲音也加倍嗎？」→ 這在問**線性**
- 「今天跟明天播同一首歌，出來的聲音一樣嗎？」→ 這在問**時不變**
- 「聲音會不會在我還沒按下播放之前就跑出來？」→ 這在問**因果性**
- 「音量會不會突然爆炸到無限大？」→ 這在問**穩定性**

這些性質不只是數學定義，它們直接決定了我們能不能用某些數學工具（如卷積、傅立葉轉換）來分析系統。

### 為什麼 LTI 系統這麼重要？

**LTI = Linear Time-Invariant（線性時不變）**

如果一個系統同時是線性的、又是時不變的，那麼只要知道一個信號——**脈衝響應 h(t)**——就能完全描述這個系統對任何輸入的反應。

> 這就像：只要你知道一家餐廳對「白飯」的處理方式（加多少醬、炒多久），你就能推斷它對所有食材的處理方式。（當然現實餐廳不是LTI，但LTI系統就是這麼「乖」。）

---

## 關鍵術語表

| 中文 | 英文 | 白話解釋 | 例子 |
|------|------|----------|------|
| 線性 | Linearity | 加倍輸入→加倍輸出；兩信號混合→輸出也混合 | 理想放大器 |
| 時不變 | Time-invariance | 輸入延遲→輸出同樣延遲 | 不老化的系統 |
| 因果性 | Causality | 輸出只取決於現在和過去的輸入 | 所有現實即時系統 |
| 穩定性 | Stability (BIBO) | 有界輸入必產生有界輸出 | 不會爆炸的音響 |
| 記憶性 | Memory | 輸出是否只取決於當前時刻的輸入 | 放大器(無記憶) vs 積分器(有記憶) |
| 脈衝響應 | Impulse response h(t) | 系統對 δ(t) 的輸出 | LTI 系統的「身分證」 |
| 卷積 | Convolution | 計算 LTI 系統輸出的核心運算 | y(t) = x(t) * h(t) |
| BIBO | Bounded-Input Bounded-Output | 有界輸入有界輸出的穩定性定義 | |

---

## 一、系統性質判斷

### 1.1 線性（Linearity）

**定義**：系統 T 是線性的，若且唯若對所有信號 x₁, x₂ 和常數 a, b：

$$T\{a \cdot x_1 + b \cdot x_2\} = a \cdot T\{x_1\} + b \cdot T\{x_2\}$$

這包含兩個子性質：
- **齊次性（Homogeneity）**：T{ax} = aT{x}（輸入放大 a 倍，輸出也放大 a 倍）
- **可加性（Additivity）**：T{x₁ + x₂} = T{x₁} + T{x₂}

**判斷方法**：
1. 令 y₁ = T{x₁}，y₂ = T{x₂}
2. 計算 T{ax₁ + bx₂}
3. 檢查是否等於 ay₁ + by₂

### 數值例題 1.1：判斷線性

> **問題**：y(t) = 3x(t) + 2 是否為線性系統？

**解答**：

令 y₁(t) = 3x₁(t) + 2，y₂(t) = 3x₂(t) + 2。

對 ax₁ + bx₂ 的輸出：
$$T\{ax_1 + bx_2\} = 3(ax_1 + bx_2) + 2 = 3ax_1 + 3bx_2 + 2$$

但我們期望的是：
$$ay_1 + by_2 = a(3x_1 + 2) + b(3x_2 + 2) = 3ax_1 + 3bx_2 + 2(a+b)$$

因為 2 ≠ 2(a+b)（除非 a+b=1），兩者**不相等**。

**答：不是線性系統。** 那個 "+2" 破壞了線性（直流偏移）。

### 1.2 時不變（Time-Invariance）

**定義**：如果輸入延遲 t₀，輸出也延遲 t₀：

$$x(t) \to y(t) \implies x(t - t_0) \to y(t - t_0)$$

**判斷方法**：
1. 先算 y(t) = T{x(t)}
2. 把 y(t) 中的 t 換成 t - t₀，得到 y(t - t₀)
3. 把 x(t) 中的 t 換成 t - t₀，得到 x(t - t₀)，再送入系統
4. 比較步驟 2 和 3 的結果

### 數值例題 1.2：判斷時不變

> **問題**：y(t) = x(2t) 是否為時不變系統？

**解答**：

**方法一（延遲輸出）**：y(t-t₀) = x(2(t-t₀)) = x(2t - 2t₀)

**方法二（延遲輸入再通過系統）**：令 x₁(t) = x(t-t₀)，則
$$T\{x_1(t)\} = x_1(2t) = x(2t - t_0)$$

比較：x(2t - 2t₀) ≠ x(2t - t₀)（延遲量不同！）

**答：不是時不變系統。** 時間尺度變換會破壞時不變性。

### 1.3 因果性（Causality）

**定義**：系統的輸出 y(t₀) 只取決於 t ≤ t₀ 的輸入值。

> **白話**：系統不能「預知未來」。

- y(t) = x(t) + x(t-1) → 因果（只用現在和過去）✓
- y(t) = x(t+1) → 非因果（用到未來的 x(t+1)）✗

### 1.4 穩定性（BIBO Stability）

**定義**：如果輸入有界（|x(t)| ≤ M < ∞），則輸出也有界（|y(t)| ≤ N < ∞）。

> **白話**：正常大小的輸入不會讓系統「爆炸」。

### 1.5 記憶性（Memory）

- **無記憶（Memoryless）**：y(t) 只取決於 x(t)（同一時刻）
  - 例如：y(t) = 5x(t)（純放大）
- **有記憶（Has Memory）**：y(t) 取決於 x(t) 以外其他時刻的值
  - 例如：y(t) = ∫₋∞ᵗ x(τ)dτ（積分器）

### 數值例題 1.3：綜合判斷

> **問題**：判斷 y[n] = nx[n] 的性質（線性、時不變、因果、穩定）。

**解答**：

**線性**：T{ax₁[n] + bx₂[n]} = n(ax₁[n] + bx₂[n]) = anx₁[n] + bnx₂[n] = aT{x₁} + bT{x₂} ✓

**時不變**：
- 延遲輸出：y[n-n₀] = (n-n₀)x[n-n₀]
- 延遲輸入：T{x[n-n₀]} = n·x[n-n₀]
- (n-n₀)x[n-n₀] ≠ n·x[n-n₀] → **不是時不變** ✗

**因果**：y[n] = nx[n] 只用到 x[n]（當前時刻）→ **因果** ✓

**穩定**：若 |x[n]| ≤ M，則 |y[n]| = |n||x[n]| = |n|M → 當 n→∞ 時輸出趨向無限 → **不穩定** ✗

---

## 二、LTI 系統與脈衝響應

### 2.1 核心概念

對 LTI 系統，如果我們知道系統對 δ(t) 的響應 h(t)：

$$\delta(t) \longrightarrow \boxed{\text{LTI 系統}} \longrightarrow h(t)$$

那麼對任意輸入 x(t)，輸出就是：

$$y(t) = x(t) * h(t) = \int_{-\infty}^{\infty} x(\tau) h(t - \tau) \, d\tau$$

> **這就是卷積（Convolution）！** 整門課最重要的運算之一。

**為什麼？** 直覺解釋：
1. 任何信號 x(t) 都可以分解成無數個「微小脈衝」的加權和
2. 線性：系統對每個微小脈衝分別處理再加起來
3. 時不變：每個脈衝的響應形狀相同，只是位移

### 2.2 LTI 系統的性質由 h(t) 決定

| 系統性質 | 用 h(t) 的條件 |
|----------|---------------|
| **因果** | h(t) = 0, for t < 0 |
| **BIBO 穩定** | ∫₋∞^∞ \|h(t)\| dt < ∞ |
| **無記憶** | h(t) = Kδ(t)（某常數 K 倍的脈衝）|

---

## 三、卷積（Convolution）

### 3.1 連續時間卷積

$$y(t) = x(t) * h(t) = \int_{-\infty}^{\infty} x(\tau) h(t - \tau) \, d\tau$$

### 3.2 離散時間卷積

$$y[n] = x[n] * h[n] = \sum_{k=-\infty}^{\infty} x[k] \, h[n - k]$$

### 3.3 圖解法卷積步驟（連續時間）

這是初學者最需要掌握的方法：

**步驟 1：反褶（Flip）**
- 畫出 x(τ) 和 h(τ)
- 把 h(τ) 反褶成 h(-τ)

**步驟 2：滑動（Shift）**
- 把 h(-τ) 往右移 t 個單位，變成 h(t-τ)
- 參數 t 就是「滑動量」

**步驟 3：相乘（Multiply）**
- 把 x(τ) 和 h(t-τ) 逐點相乘

**步驟 4：積分（Integrate）**
- 對相乘結果在 τ 從 -∞ 到 ∞ 積分
- 得到 y(t) 在該 t 值的輸出

**步驟 5：重複**
- 對每個 t 值重複步驟 2-4，畫出完整的 y(t)

> **口訣：翻、移、乘、積**

### 數值例題 3.1：矩形脈衝卷積矩形脈衝

> **問題**：x(t) = u(t) - u(t-1)（寬度 1 的矩形），h(t) = u(t) - u(t-2)（寬度 2 的矩形），求 y(t) = x(t) * h(t)。

**解答**：

x(t) 在 [0,1] 為 1，其餘為 0。
h(t) 在 [0,2] 為 1，其餘為 0。

用圖解法，h(t-τ) 在 [t-2, t] 為 1。

分段討論（找 x(τ) 和 h(t-τ) 的重疊區間）：

**情況 1：t < 0**
兩者不重疊 → y(t) = 0

**情況 2：0 ≤ t < 1**
重疊區間 [0, t]
$$y(t) = \int_0^t 1 \cdot 1 \, d\tau = t$$

**情況 3：1 ≤ t < 2**
重疊區間 [0, 1]
$$y(t) = \int_0^1 1 \cdot 1 \, d\tau = 1$$

**情況 4：2 ≤ t < 3**
重疊區間 [t-2, 1]
$$y(t) = \int_{t-2}^1 1 \cdot 1 \, d\tau = 1 - (t-2) = 3-t$$

**情況 5：t ≥ 3**
兩者不重疊 → y(t) = 0

**結果**：y(t) 是一個梯形，上升段 [0,1]、平頂段 [1,2]、下降段 [2,3]。

> **觀察**：卷積結果的持續時間 = 兩個信號持續時間之和（1 + 2 = 3）。這是通用規則！

### 數值例題 3.2：離散卷積計算

> **問題**：x[n] = {1, 2, 3}（n = 0,1,2），h[n] = {1, 1}（n = 0,1），求 y[n]。

**解答**：

逐項計算 y[n] = Σ x[k]h[n-k]：

$$y[0] = x[0]h[0] = 1 \times 1 = 1$$

$$y[1] = x[0]h[1] + x[1]h[0] = 1 \times 1 + 2 \times 1 = 3$$

$$y[2] = x[1]h[1] + x[2]h[0] = 2 \times 1 + 3 \times 1 = 5$$

$$y[3] = x[2]h[1] = 3 \times 1 = 3$$

**答：y[n] = {1, 3, 5, 3}**（n = 0,1,2,3）

> **觀察**：輸出長度 = len(x) + len(h) - 1 = 3 + 2 - 1 = 4。

### 數值例題 3.3：指數信號卷積

> **問題**：x(t) = e^(-t)u(t)，h(t) = e^(-2t)u(t)，求 y(t) = x(t) * h(t)。

**解答**：

因為 x(t) 和 h(t) 都是因果的（t < 0 時為 0）：

$$y(t) = \int_0^t e^{-\tau} \cdot e^{-2(t-\tau)} \, d\tau \quad (t \geq 0)$$

$$= e^{-2t} \int_0^t e^{-\tau + 2\tau} \, d\tau = e^{-2t} \int_0^t e^{\tau} \, d\tau$$

$$= e^{-2t} [e^{\tau}]_0^t = e^{-2t}(e^t - 1) = e^{-t} - e^{-2t}$$

**答：y(t) = (e^(-t) - e^(-2t))u(t)**

### 3.4 卷積的重要性質

| 性質 | 數學表示 | 意義 |
|------|----------|------|
| **交換律** | x * h = h * x | 反褶誰都一樣 |
| **結合律** | (x * h₁) * h₂ = x * (h₁ * h₂) | 串聯系統的順序可交換 |
| **分配律** | x * (h₁ + h₂) = x*h₁ + x*h₂ | 並聯系統 |
| **與 δ 卷積** | x * δ = x | δ 是卷積的單位元素 |
| **與 δ(t-t₀) 卷積** | x(t) * δ(t-t₀) = x(t-t₀) | 卷積可以做時移 |

### 數值例題 3.4：利用卷積性質

> **問題**：x(t) * δ(t-3) = ？

**解答**：

$$x(t) * \delta(t-3) = x(t-3)$$

直接把信號延遲 3 個單位。

### 數值例題 3.5：串聯系統

> **問題**：兩個 LTI 系統串聯，h₁(t) = e^(-t)u(t)，h₂(t) = e^(-2t)u(t)。整體脈衝響應是什麼？

**解答**：

串聯系統的整體脈衝響應 = h₁(t) * h₂(t)。

由例題 3.3 我們已經算過：

$$h(t) = h_1(t) * h_2(t) = (e^{-t} - e^{-2t})u(t)$$

---

## 四、BIBO 穩定性的判斷

### 4.1 連續時間

LTI 系統 BIBO 穩定的充要條件：

$$\int_{-\infty}^{\infty} |h(t)| \, dt < \infty$$

> **白話**：脈衝響應的絕對值面積有限。

### 4.2 離散時間

$$\sum_{n=-\infty}^{\infty} |h[n]| < \infty$$

> **白話**：脈衝響應的絕對值加起來有限。

### 數值例題 4.1：穩定性判斷

> **問題**：判斷以下系統的穩定性。
> (a) h(t) = e^(-3t)u(t)
> (b) h(t) = e^(2t)u(t)
> (c) h[n] = (0.5)ⁿu[n]
> (d) h[n] = 2ⁿu[n]

**解答**：

**(a)** ∫₀^∞ e^(-3t) dt = 1/3 < ∞ → **穩定** ✓

**(b)** ∫₀^∞ e^(2t) dt = ∞ → **不穩定** ✗（指數增長）

**(c)** Σ_{n=0}^∞ (0.5)ⁿ = 1/(1-0.5) = 2 < ∞ → **穩定** ✓

**(d)** Σ_{n=0}^∞ 2ⁿ = ∞ → **不穩定** ✗

> **規律**：衰減的指數→穩定；增長的指數→不穩定。

---

## 五、因果性的判斷

LTI 系統因果的充要條件：

$$h(t) = 0, \quad \text{for } t < 0$$

> **白話**：脈衝響應在 t < 0 之前沒有值，表示系統不會在刺激之前就反應。

| 範例 | 因果？ |
|------|--------|
| h(t) = e^(-t)u(t) | ✓ 因果（u(t) 保證 t<0 時為 0）|
| h(t) = e^(-\|t\|) | ✗ 非因果（t<0 時也有值）|
| h[n] = (0.8)ⁿu[n] | ✓ 因果 |
| h[n] = δ[n+1] | ✗ 非因果（在 n=-1 有響應）|

---

## 六、題型鑑別

| 看到什麼 | 用什麼方法 |
|----------|-----------|
| 「判斷系統是否線性」 | 令 T{ax₁+bx₂} 展開，看是否等於 aT{x₁}+bT{x₂} |
| 「判斷系統是否時不變」 | 比較「延遲輸出」和「延遲輸入通過系統」|
| 「判斷因果/穩定」 | 看 h(t) 是否在 t<0 為 0 / 看 ∫\|h(t)\|dt 是否有限 |
| 「求 y(t) = x(t)*h(t)」 | 圖解法（翻移乘積）或公式法 |
| 「離散卷積 y[n]」 | 列表法逐項計算，或多項式乘法 |
| 「串聯系統整體 h(t)」 | h = h₁ * h₂ |
| 「並聯系統整體 h(t)」 | h = h₁ + h₂ |
| 「x(t) * δ(t-a)」 | 直接得 x(t-a) |

---

## ✅ 自我檢測

### 問題 1
y(t) = x(t)cos(t) 是否為線性系統？是否為時不變系統？

<details>
<summary>點擊查看答案</summary>

**線性**：T{ax₁+bx₂} = (ax₁+bx₂)cos(t) = ax₁cos(t) + bx₂cos(t) = aT{x₁} + bT{x₂} → **是線性** ✓

**時不變**：
- 延遲輸出：y(t-t₀) = x(t-t₀)cos(t-t₀)
- 延遲輸入：T{x(t-t₀)} = x(t-t₀)cos(t)
- cos(t-t₀) ≠ cos(t) → **不是時不變** ✗

</details>

### 問題 2
x[n] = {2, 1, 3}（n = -1, 0, 1），h[n] = {1, -1}（n = 0, 1），求 y[n]。

<details>
<summary>點擊查看答案</summary>

逐項：
- y[-1] = x[-1]h[0] = 2×1 = 2
- y[0] = x[-1]h[1] + x[0]h[0] = 2×(-1) + 1×1 = -1
- y[1] = x[0]h[1] + x[1]h[0] = 1×(-1) + 3×1 = 2
- y[2] = x[1]h[1] = 3×(-1) = -3

**y[n] = {2, -1, 2, -3}**（n = -1, 0, 1, 2）

</details>

### 問題 3
h(t) = e^(-t)u(t) + e^(t)u(-t)，這個系統是因果的嗎？穩定嗎？

<details>
<summary>點擊查看答案</summary>

**因果？** h(t) 在 t < 0 時有 e^(t)u(-t) ≠ 0 → **不是因果** ✗

**穩定？**
$$\int_{-\infty}^{0} e^t dt + \int_0^{\infty} e^{-t} dt = 1 + 1 = 2 < \infty$$
→ **穩定** ✓

這是一個穩定但非因果的系統。

</details>

### 問題 4
證明：如果 h₁(t) 和 h₂(t) 都對應穩定的 LTI 系統，則它們串聯後的系統也是穩定的。

<details>
<summary>點擊查看答案</summary>

串聯系統 h(t) = h₁(t) * h₂(t)。

$$\int_{-\infty}^{\infty} |h(t)| dt = \int_{-\infty}^{\infty} |h_1(t) * h_2(t)| dt$$

$$\leq \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} |h_1(\tau)||h_2(t-\tau)| d\tau \, dt$$

$$= \left(\int_{-\infty}^{\infty} |h_1(\tau)| d\tau\right) \left(\int_{-\infty}^{\infty} |h_2(t)| dt\right) < \infty$$

因為兩個都有限，乘積也有限。→ **串聯後仍穩定** ✓

</details>

### 問題 5
y[n] = x[n] - x[n-1]（差分器）。這個系統的脈衝響應是什麼？是因果的嗎？穩定嗎？

<details>
<summary>點擊查看答案</summary>

**脈衝響應**：令 x[n] = δ[n]
$$h[n] = \delta[n] - \delta[n-1]$$

即 h[0] = 1, h[1] = -1，其餘為 0。

**因果？** h[n] = 0 for n < 0 → **因果** ✓

**穩定？** Σ|h[n]| = |1| + |-1| = 2 < ∞ → **穩定** ✓

</details>

---

> **下一章預告**：有了 LTI 系統和卷積的基礎，我們將進入**頻域分析**的世界——首先從**傅立葉級數**開始，學習如何把信號分解成不同頻率的正弦波。
