# 機率 補充題庫 — 劉長遠教授考題

---

# 第一部分：104下 劉長遠 期中考 (2016春)

---

## 題目 S1.1（劉長遠 104-2 期中考）
Mary and Tom park their cars in an empty parking lot that consists of N parking spaces in a row. Assume that each possible pair of parking locations is equally likely. Calculate the probability that the parking spaces they select are at most 2 apart (that is, at most one empty space between them).

### 詳解
**考點**：古典機率、組合計數

**解題思路**：從 N 個停車位中選 2 個（有序對，因為 Mary 和 Tom 是不同人），計算「距離至多為 2」的方式數。

**步驟一：樣本空間**

Mary 選一個車位，Tom 選一個車位（可能不同也可能相同？題意暗示是不同的車位，因為是一對 pair of locations）。總共有 $N(N-1)$ 種有序配對（或 $\binom{N}{2}$ 種無序配對）。我們用無序配對：

$$|\Omega| = \binom{N}{2} = \frac{N(N-1)}{2}$$

**步驟二：有利事件**

「at most 2 apart」表示兩車位的距離 $|i - j| \leq 2$，即 $|i-j| = 1$ 或 $|i-j| = 2$。

- $|i-j|=1$（相鄰）：位置對 $(1,2),(2,3),\ldots,(N-1,N)$，共 $N-1$ 對
- $|i-j|=2$（隔一格）：位置對 $(1,3),(2,4),\ldots,(N-2,N)$，共 $N-2$ 對

有利事件數 = $(N-1) + (N-2) = 2N - 3$

**步驟三：計算機率**

$$P = \frac{2N-3}{\binom{N}{2}} = \frac{2N-3}{\frac{N(N-1)}{2}} = \frac{2(2N-3)}{N(N-1)}$$

$$\boxed{P = \frac{2(2N-3)}{N(N-1)}}$$

**驗證**：當 $N=3$ 時，$P = \frac{2 \times 3}{3 \times 2} = 1$，確實 3 個車位中任兩個距離都 $\leq 2$。

---

## 題目 S1.2（劉長遠 104-2 期中考）
Out of the students in a class, 60% are geniuses, 70% love chocolate, and 40% fall into both categories. Determine the probability that a randomly selected student is neither a genius nor a chocolate lover.

### 詳解
**考點**：排容原理（Inclusion-Exclusion）

**解題思路**：求「既不是天才也不愛巧克力」的機率，即兩事件聯集的餘事件。

設 $G$ = 天才，$C$ = 愛巧克力。

已知：
- $P(G) = 0.6$
- $P(C) = 0.7$
- $P(G \cap C) = 0.4$

由排容原理：

$$P(G \cup C) = P(G) + P(C) - P(G \cap C) = 0.6 + 0.7 - 0.4 = 0.9$$

所求為：

$$P(\overline{G} \cap \overline{C}) = P(\overline{G \cup C}) = 1 - P(G \cup C) = 1 - 0.9 = 0.1$$

$$\boxed{P(\text{neither genius nor chocolate lover}) = 0.1 = 10\%}$$

---

## 題目 S1.3（劉長遠 104-2 期中考）
Assume that every gasoline filling station in Cambridge is open each day for a single, continuous, two-hour period. The opening times, $t$ for all stations are identically distributed, mutually independent random variables with the PDF:

$$f_t(t_0) = \begin{cases} K, & 6\text{am} \leq t_0 \leq 10\text{am} \\ 0, & \text{otherwise} \end{cases}$$

(a) Determine the numerical value of $K$.

(b) If Oscar visits a randomly selected station at 9:30 a.m., what is the probability the station is open when he arrives?

(c) Each day, Oscar visits his first station at 9:30 am. If it is closed, he tries another at 10:30 am. If the second station is also closed, he tries a third station at 11:30 am. If all three tries fail, he gives up for the day.

   (1) What is the probability Oscar was able to purchase gasoline on the first day he tried to do so?

   (2) Given that Oscar was able to purchase gasoline today, what is the probability he visited a total of exactly two gas stations today?

   (3) Given that Oscar bought gasoline at 11:30 am today, determine the conditional expected value and the conditional variance for today's opening time at the particular station at which he bought gasoline.

   (4) Let $x$ be the number of days up to and including the first day on which Oscar is successful in his attempt to purchase gasoline. Determine the PMF $P_x(x_0)$.

### 詳解
**考點**：連續均勻分布、條件機率、幾何分布

#### (a) 求 K 值

PDF 必須積分為 1：

$$\int_{6}^{10} K \, dt_0 = K \times 4 = 1$$

$$\boxed{K = \frac{1}{4}}$$

#### (b) 9:30 am 到訪，站是 open 的機率

加油站開放 2 小時。開門時間 $t$ 均勻分布在 [6, 10]。加油站在時刻 9:30 開著的條件是：

$$t \leq 9.5 \leq t + 2 \quad \Rightarrow \quad 7.5 \leq t \leq 9.5$$

（開門時間 $t$ 必須在 7:30am 到 9:30am 之間，站才會在 9:30 還開著）

但 $t$ 只在 [6, 10] 上有定義，所以有效範圍是 $t \in [7.5, 9.5]$。

$$P(\text{open at 9:30}) = \int_{7.5}^{9.5} \frac{1}{4} \, dt = \frac{2}{4} = \frac{1}{2}$$

$$\boxed{P(\text{open at 9:30}) = \frac{1}{2}}$$

#### (c)(1) 第一天成功加油的機率

Oscar 三次嘗試：9:30am、10:30am、11:30am，各去不同站（獨立）。

**在 10:30am 站是 open 的機率**：需 $t \leq 10.5 \leq t + 2$，即 $8.5 \leq t \leq 10$（因為 $t \leq 10$）。

$$P(\text{open at 10:30}) = \int_{8.5}^{10} \frac{1}{4} \, dt = \frac{1.5}{4} = \frac{3}{8}$$

**在 11:30am 站是 open 的機率**：需 $t \leq 11.5 \leq t + 2$，即 $9.5 \leq t \leq 10$。

$$P(\text{open at 11:30}) = \int_{9.5}^{10} \frac{1}{4} \, dt = \frac{0.5}{4} = \frac{1}{8}$$

設 $p_1 = 1/2$, $p_2 = 3/8$, $p_3 = 1/8$。

成功機率 = 至少一次成功：

$$P(\text{success}) = 1 - P(\text{all fail}) = 1 - (1 - p_1)(1 - p_2)(1 - p_3)$$

$$= 1 - \frac{1}{2} \times \frac{5}{8} \times \frac{7}{8} = 1 - \frac{35}{128} = \frac{93}{128}$$

$$\boxed{P(\text{購買成功}) = \frac{93}{128} \approx 0.7266}$$

#### (c)(2) 已知成功，恰好去了 2 站的機率

「恰好去了 2 站」表示：第 1 站失敗、第 2 站成功。

$$P(\text{exactly 2 stations}) = (1 - p_1) \cdot p_2 = \frac{1}{2} \times \frac{3}{8} = \frac{3}{16}$$

條件機率：

$$P(\text{exactly 2} \mid \text{success}) = \frac{P(\text{exactly 2})}{P(\text{success})} = \frac{3/16}{93/128} = \frac{3}{16} \times \frac{128}{93} = \frac{24}{93} = \frac{8}{31}$$

$$\boxed{P(\text{恰好去2站} \mid \text{成功}) = \frac{8}{31}}$$

#### (c)(3) 已知 11:30 買到油，開門時間的條件期望與條件變異數

在 11:30 買到油，表示第 3 站在 11:30 是開著的。條件是 $9.5 \leq t \leq 10$。

在此條件下，$t$ 在 $[9.5, 10]$ 上均勻分布（因為原始分布在此區間也是均勻的）。

條件期望值：

$$E[t \mid \text{open at 11:30}] = \frac{9.5 + 10}{2} = 9.75 \text{ (即 9:45am)}$$

條件變異數（均勻分布 $[a,b]$ 的變異數 = $(b-a)^2/12$）：

$$\text{Var}[t \mid \text{open at 11:30}] = \frac{(10 - 9.5)^2}{12} = \frac{0.25}{12} = \frac{1}{48}$$

$$\boxed{E[t \mid \text{11:30買到}] = 9.75 \text{ (9:45am)}, \quad \text{Var} = \frac{1}{48} \text{ hr}^2}$$

#### (c)(4) 第 $x$ 天首次成功的 PMF

每天成功機率 $p = 93/128$，失敗機率 $q = 35/128$，各天獨立。

$x$ 是第一次成功的天數，服從**幾何分布**：

$$P_x(x_0) = q^{x_0 - 1} \cdot p = \left(\frac{35}{128}\right)^{x_0 - 1} \cdot \frac{93}{128}, \quad x_0 = 1, 2, 3, \ldots$$

$$\boxed{P_x(x_0) = \left(\frac{35}{128}\right)^{x_0 - 1} \cdot \frac{93}{128}, \quad x_0 = 1, 2, 3, \ldots}$$

---

## 題目 S1.4（劉長遠 104-2 期中考）
The compound PDF for random variables $x$ and $y$ is:

$$f_{x,y}(x_0, y_0) = \begin{cases} A \cdot x_0, & \text{if } x_0 \geq 0, \; y_0 \geq 0, \; x_0 + y_0 \leq 1 \\ 0, & \text{otherwise} \end{cases}$$

Let $g = xy$. Derive the PDF $f_g(g_0)$.

### 詳解
**考點**：聯合分布、隨機變數函數的 PDF（CDF 法）

#### 步驟一：求常數 A

$$\int_0^1 \int_0^{1-x_0} A \cdot x_0 \, dy_0 \, dx_0 = 1$$

$$A \int_0^1 x_0 (1 - x_0) \, dx_0 = A \int_0^1 (x_0 - x_0^2) \, dx_0 = A \left[\frac{1}{2} - \frac{1}{3}\right] = A \cdot \frac{1}{6} = 1$$

$$A = 6$$

#### 步驟二：求 $g = xy$ 的 CDF

$g_0$ 的範圍：在定義域 $x \geq 0, y \geq 0, x+y \leq 1$ 上，$g = xy$ 的最大值。由 AM-GM 不等式，在 $x+y=1$ 上 $xy \leq (x+y)^2/4 = 1/4$，所以 $0 \leq g_0 \leq 1/4$。

$$F_g(g_0) = P(xy \leq g_0) = \iint_{xy \leq g_0, \, x \geq 0, \, y \geq 0, \, x+y \leq 1} 6x \, dy \, dx$$

對於 $0 < g_0 < 1/4$，我們用 $y \leq g_0/x$ 的條件。

分兩個區域：
- 當 $x$ 很小時（$g_0/x > 1-x$），$y$ 的上限是 $1-x$（整個三角形條內 $xy \leq g_0$ 自然滿足）
- 當 $x$ 較大時（$g_0/x < 1-x$），$y$ 的上限是 $g_0/x$

臨界點：$g_0/x = 1-x$，即 $x^2 - x + g_0 = 0$，解為：

$$x = \frac{1 \pm \sqrt{1 - 4g_0}}{2}$$

設 $x_1 = \frac{1 - \sqrt{1-4g_0}}{2}$ 和 $x_2 = \frac{1 + \sqrt{1-4g_0}}{2}$。

在三角形內（$0 \leq x \leq 1$），$g_0/x \geq 1-x$ 當 $x \leq x_1$ 或 $x \geq x_2$。

但要注意 $x+y \leq 1$ 的限制，所以 $x \leq 1$ 且 $y \leq 1-x$。

$$F_g(g_0) = \int_0^{x_1} 6x(1-x) \, dx + \int_{x_1}^{x_2} 6x \cdot \frac{g_0}{x} \, dx + \int_{x_2}^{1} 6x(1-x) \, dx$$

其中第二個積分中，$y$ 只到 $g_0/x$（因為 $g_0/x < 1-x$），而第一和第三個積分中 $y$ 到 $1-x$。

但注意第三個區間 $[x_2, 1]$：當 $x \geq x_2$ 時，$g_0/x \leq 1-x$，因為 $x \geq x_2 > 1/2$（當 $g_0 < 1/4$ 時），且 $1-x < 1/2$，而 $g_0/x < g_0/(1/2) = 2g_0 < 1/2$...

我們需要更仔細地分析。實際上，$xy \leq g_0$ 的區域在三角形內是：對於每個 $x$，$y \leq \min(g_0/x, 1-x)$。

所以 CDF 用餘事件更方便。用 $P(g > g_0) = P(xy > g_0)$。

$$P(xy > g_0) = \int_{x_1}^{x_2} \int_{g_0/x}^{1-x} 6x \, dy \, dx$$

（因為在 $[x_1, x_2]$ 區間內，$g_0/x < 1-x$，才有 $xy > g_0$ 的部分）

$$= \int_{x_1}^{x_2} 6x \left(1 - x - \frac{g_0}{x}\right) dx = \int_{x_1}^{x_2} 6(x - x^2 - g_0) \, dx$$

$$= 6 \left[\frac{x^2}{2} - \frac{x^3}{3} - g_0 x\right]_{x_1}^{x_2}$$

取 PDF 更直接，用 $f_g(g_0) = -\frac{d}{dg_0} P(g > g_0)$。

利用 Leibniz 法則：

$$\frac{d}{dg_0} P(g > g_0) = \frac{d}{dg_0} \int_{x_1}^{x_2} 6(x - x^2 - g_0) \, dx$$

注意 $x_1, x_2$ 也是 $g_0$ 的函數，且在 $x = x_1$ 和 $x = x_2$ 處，$x - x^2 - g_0 = 0$（因為 $x^2 - x + g_0 = 0$），所以邊界項為 0。

$$\frac{d}{dg_0} P(g > g_0) = \int_{x_1}^{x_2} (-6) \, dx = -6(x_2 - x_1) = -6\sqrt{1 - 4g_0}$$

因此：

$$f_g(g_0) = -\frac{d}{dg_0} P(g > g_0) = 6\sqrt{1 - 4g_0}, \quad 0 \leq g_0 \leq \frac{1}{4}$$

**驗證**：$\int_0^{1/4} 6\sqrt{1-4g_0} \, dg_0$。令 $u = 1-4g_0$, $du = -4 \, dg_0$：

$$= 6 \int_1^0 \sqrt{u} \cdot \frac{-du}{4} = \frac{6}{4} \int_0^1 u^{1/2} \, du = \frac{3}{2} \cdot \frac{2}{3} = 1 \quad \checkmark$$

$$\boxed{f_g(g_0) = 6\sqrt{1 - 4g_0}, \quad 0 \leq g_0 \leq \frac{1}{4}}$$

---

## 題目 S1.5（劉長遠 104-2 期中考）
Random variables $x$ and $y$ are independent and are described by the PMFs:

$$P_x(x_0): P(x=0)=1/2, \; P(x=1)=1/2$$
$$P_y(y_0): P(y=1)=1/3, \; P(y=7)=2/3$$

Let $x_1, x_2, \ldots$ be independent experimental values of $x$. Let $y_1, y_2, \ldots$ be independent experimental values of $y$. Consider:

$$\mu = x_1 + x_2 + x_3 + x_4 + y_1 + y_2 + y_3$$
$$\gamma = 4x_1 + 3y_1$$

(a) How do you think the variance of $\mu$ and $\gamma$ will compare?

(b) Determine the Z-transforms and variances for random variables $\mu$ and $\gamma$.

### 詳解
**考點**：Z-transform（機率生成函數）、獨立隨機變數之和的性質

#### 基本統計量

對 $x$：$E[x] = 0 \times 1/2 + 1 \times 1/2 = 1/2$

$E[x^2] = 0 \times 1/2 + 1 \times 1/2 = 1/2$

$\text{Var}(x) = 1/2 - 1/4 = 1/4$

對 $y$：$E[y] = 1 \times 1/3 + 7 \times 2/3 = 1/3 + 14/3 = 5$

$E[y^2] = 1 \times 1/3 + 49 \times 2/3 = 1/3 + 98/3 = 33$

$\text{Var}(y) = 33 - 25 = 8$

#### Z-transforms

$x$ 的 Z-transform：$P_x(z) = \frac{1}{2} z^0 + \frac{1}{2} z^1 = \frac{1}{2}(1 + z)$

$y$ 的 Z-transform：$P_y(z) = \frac{1}{3} z^1 + \frac{2}{3} z^7 = \frac{z}{3}(1 + 2z^6)$

#### (a) 直覺比較

$\mu$ 的期望值 = $4 \times 1/2 + 3 \times 5 = 2 + 15 = 17$

$\gamma$ 的期望值 = $4 \times 1/2 + 3 \times 5 = 2 + 15 = 17$

兩者期望值相同！但變異數不同，因為 $\mu$ 是 7 個獨立隨機變數的和，而 $\gamma$ 是 2 個隨機變數的加權和（但有較大的係數）。

#### (b) Z-transforms 與變異數

**$\mu$ 的 Z-transform**：獨立隨機變數之和的 Z-transform 是個別 Z-transform 的乘積。

$$P_\mu(z) = [P_x(z)]^4 \cdot [P_y(z)]^3 = \left[\frac{1+z}{2}\right]^4 \cdot \left[\frac{z(1+2z^6)}{3}\right]^3$$

$$= \frac{(1+z)^4}{16} \cdot \frac{z^3(1+2z^6)^3}{27}$$

$$\boxed{P_\mu(z) = \frac{z^3 (1+z)^4 (1+2z^6)^3}{432}}$$

$\mu$ 的變異數：獨立隨機變數之和的變異數等於變異數之和。

$$\text{Var}(\mu) = 4 \cdot \text{Var}(x) + 3 \cdot \text{Var}(y) = 4 \times \frac{1}{4} + 3 \times 8 = 1 + 24 = 25$$

$$\boxed{\text{Var}(\mu) = 25}$$

**$\gamma$ 的 Z-transform**：$\gamma = 4x_1 + 3y_1$。

$4x_1$ 的 Z-transform：$P_{4x_1}(z) = P_{x_1}(z^4) = \frac{1}{2}(1 + z^4)$

$3y_1$ 的 Z-transform：$P_{3y_1}(z) = P_{y_1}(z^3) = \frac{1}{3}z^3 + \frac{2}{3}z^{21} = \frac{z^3}{3}(1 + 2z^{18})$

$$P_\gamma(z) = P_{4x_1}(z) \cdot P_{3y_1}(z) = \frac{(1+z^4)}{2} \cdot \frac{z^3(1+2z^{18})}{3}$$

$$\boxed{P_\gamma(z) = \frac{z^3(1+z^4)(1+2z^{18})}{6}}$$

$\gamma$ 的變異數：

$$\text{Var}(\gamma) = 4^2 \cdot \text{Var}(x) + 3^2 \cdot \text{Var}(y) = 16 \times \frac{1}{4} + 9 \times 8 = 4 + 72 = 76$$

$$\boxed{\text{Var}(\gamma) = 76}$$

**比較**：$\text{Var}(\gamma) = 76 > 25 = \text{Var}(\mu)$。雖然期望值相同，但 $\gamma$ 由於使用較大的係數（4 和 3）將變異數放大了，所以變異數遠大於 $\mu$。

---

## 題目 S1.6（劉長遠 104-2 期中考）
The country hospital is located at the center of a square whose sides are 3 miles wide. If an accident occurs within this square, then the hospital sends out an ambulance. The road network is rectangular, so the travel distance from the hospital whose coordinates are $(0,0)$ to the point $(x,y)$ is $|x|+|y|$. If an accident occurs at a point that is uniformly distributed in the square, find the expected travel distance of the ambulance.

### 詳解
**考點**：二維均勻分布、期望值計算、曼哈頓距離

**解題思路**：正方形邊長 3，中心在 $(0,0)$，所以正方形為 $[-3/2, 3/2] \times [-3/2, 3/2]$。事故點 $(X,Y)$ 在此均勻分布。曼哈頓距離 $D = |X| + |Y|$。

聯合 PDF：$f(x,y) = \frac{1}{9}$（面積為 $3 \times 3 = 9$）。

$$E[D] = E[|X| + |Y|] = E[|X|] + E[|Y|]$$

由對稱性，$E[|X|] = E[|Y|]$。

$$E[|X|] = \int_{-3/2}^{3/2} |x| \cdot \frac{1}{3} \, dx = \frac{2}{3} \int_0^{3/2} x \, dx = \frac{2}{3} \cdot \frac{(3/2)^2}{2} = \frac{2}{3} \cdot \frac{9/4}{2} = \frac{2}{3} \cdot \frac{9}{8} = \frac{3}{4}$$

因此：

$$E[D] = E[|X|] + E[|Y|] = \frac{3}{4} + \frac{3}{4} = \frac{3}{2}$$

$$\boxed{E[\text{travel distance}] = \frac{3}{2} \text{ miles} = 1.5 \text{ miles}}$$

---

# 第二部分：102下 劉長遠 期末考 (2014春)

---

## 題目 S2.1（劉長遠 102-2 期末考）
**Markov Chain Property**

We are observing and recording the weather in a special place every day. The possible weather types in the place are sunny, cloudy, and rainy. The probability of each weather type is dependent of weather type from previous day which may be modelled as Markov chain. The probability that weather type in one day is different from the type in previous day is equal to $P$ for each different type. However, the weather prediction cannot perfectly be modelled by the assumed Markov model, so the probability that the true weather in one day is not the predicted weather type is equal to $F$ for each weather type other than predicted one, which is independent of all previous and future errors.

Notation:
- $s_n, c_n, r_n$: Observed sunny/cloudy/rainy day on day $n$
- $S_n, C_n, R_n$: Predicted sunny/cloudy/rainy day on day $n$

Can the possible weather sequences of our observations be modeled as the state history of a three-state Markov process?

### 詳解
**考點**：隱藏馬可夫模型（Hidden Markov Model）、Markov 性質的判定

**解題思路**：這是一個典型的 HMM 問題。底層的（預測的）天氣是 Markov chain，但觀測到的天氣受到觀測誤差的影響。問題是：觀測序列本身是否構成 Markov chain？

**步驟一：建立模型**

底層 Markov chain 的轉移矩陣（預測天氣）：三個狀態 $\{S, C, R\}$，從任何狀態轉移到不同狀態的機率都是 $P$，留在原狀態的機率是 $1-2P$。

$$\mathbf{T} = \begin{pmatrix} 1-2P & P & P \\ P & 1-2P & P \\ P & P & 1-2P \end{pmatrix}$$

觀測誤差矩陣：預測為某天氣，觀測到錯誤天氣的機率為 $F$（對每種其他天氣），觀測正確的機率為 $1-2F$。

$$\mathbf{O} = \begin{pmatrix} 1-2F & F & F \\ F & 1-2F & F \\ F & F & 1-2F \end{pmatrix}$$

**步驟二：分析觀測序列是否為 Markov chain**

**答案是：可以（Yes）。**

**理由**：由於轉移矩陣 $\mathbf{T}$ 和觀測矩陣 $\mathbf{O}$ 都是對稱的（doubly stochastic），且具有特殊的均勻結構（每行中，對角線元素相同、非對角線元素也相同），我們可以推導觀測序列的轉移機率。

由全機率法則，觀測到 $o_{n+1}$ 給定 $o_n$ 的機率為：

$$P(o_{n+1} | o_n) = \sum_{H_n, H_{n+1}} P(o_{n+1} | H_{n+1}) P(H_{n+1} | H_n) P(H_n | o_n)$$

由矩陣的對稱結構，$P(H_n | o_n)$ 只取決於「$H_n$ 是否等於 $o_n$」（正確的機率是 $1-2F$，各錯誤的機率是 $F$），這是跟前面的觀測歷史無關的。

因此，觀測序列的條件機率可以用矩陣乘法寫成：

$$P(\text{obs}_{n+1} = j \mid \text{obs}_n = i)$$

透過逐步計算，觀測到的天氣「相同」和「不同」的轉移機率：

- $P(\text{obs same}) = (1-2P)(1-2F)^2 + 2P \cdot F^2 + 2F(1-2F) \cdot P + 2F(1-2F)(1-2P) + 4PF^2$

整理後（由對稱性）觀測序列的轉移只取決於「相同或不同」，即：

$$P(\text{obs}_{n+1} = i \mid \text{obs}_n = i) = (1-2P)(1-2F)^2 + 2P \cdot 2F^2 + 2 \cdot P \cdot F(1-2F) + 2F(1-2F)(1-2P) + ...$$

更簡潔的做法：觀測矩陣的等效轉移矩陣為 $\mathbf{M} = \mathbf{O} \cdot \mathbf{T} \cdot \mathbf{O}$... 但由於結構特殊，可以直接說明結果矩陣仍然是同樣的「對角元素相同、非對角元素相同」的形式，因此觀測序列確實滿足 Markov 性質。

等效轉移機率矩陣為：

令 $Q = (1-2P)(1-2F)^2 + 2P \cdot F^2$，則觀測到相同天氣的機率為某個函數 $Q'$，不同天氣的機率為 $(1-Q')/2$，仍然構成 Markov chain。

$$\boxed{\text{是的，觀測序列可以被建模為三狀態 Markov process，因為轉移與觀測矩陣的對稱結構保證了 Markov 性質。}}$$

具體而言，觀測序列的轉移矩陣也具有相同的對稱結構，自轉移機率為 $(1-2F)^2(1-2P) + 2F^2 \cdot 2P + 4PF(1-2F)$，不同狀態轉移的機率為 $\frac{1 - \text{自轉移}}{2}$。

---

## 題目 S2.2（劉長遠 102-2 期末考）
**Gaussian Distribution**

A noise signal $x$ may be considered to be a Gaussian random variable with an expected value of 0 and a variance of $\sigma_x^2$. Assume that any experimental value of $x$ will cause an error in a digital communication system if it is larger than $+A$.

1. Determine the probability that any particular experimental value of $x$ will cause an error if:
   (a) $\sigma_x^2 = 10^{-2} A^2$
   (b) $\sigma_x^2 = A^2$
   (c) $\sigma_x^2 = 9A^2$

2. For a given value of $A$, what is the largest $\sigma_x^2$ may be to obtain an error probability for any experimental value of $x$ less than $10^{-2}$? $10^{-4}$?

### 詳解
**考點**：高斯分布、標準化（Z-score）、查表

**解題思路**：$x \sim N(0, \sigma_x^2)$，$P(\text{error}) = P(x > A) = P\left(Z > \frac{A}{\sigma_x}\right) = 1 - \Phi\left(\frac{A}{\sigma_x}\right)$，其中 $Z = x/\sigma_x$ 為標準常態。

#### 1(a) $\sigma_x^2 = 10^{-2} A^2$，即 $\sigma_x = 0.1A$

$$P(\text{error}) = P\left(Z > \frac{A}{0.1A}\right) = P(Z > 10) = 1 - \Phi(10)$$

$\Phi(10)$ 幾乎等於 1，所以：

$$\boxed{P(\text{error}) \approx 0 \quad (\text{極小值，約 } 7.6 \times 10^{-24})}$$

#### 1(b) $\sigma_x^2 = A^2$，即 $\sigma_x = A$

$$P(\text{error}) = P(Z > 1) = 1 - \Phi(1) \approx 1 - 0.8413 = 0.1587$$

$$\boxed{P(\text{error}) \approx 0.1587}$$

#### 1(c) $\sigma_x^2 = 9A^2$，即 $\sigma_x = 3A$

$$P(\text{error}) = P\left(Z > \frac{1}{3}\right) = 1 - \Phi(0.333) \approx 1 - 0.6306 = 0.3694$$

$$\boxed{P(\text{error}) \approx 0.3694}$$

#### 2. 求最大 $\sigma_x^2$

**錯誤機率 < $10^{-2}$**：

$$P(Z > A/\sigma_x) < 0.01 \quad \Rightarrow \quad \Phi(A/\sigma_x) > 0.99$$

查表：$\Phi(2.326) \approx 0.99$，所以：

$$\frac{A}{\sigma_x} \geq 2.326 \quad \Rightarrow \quad \sigma_x \leq \frac{A}{2.326}$$

$$\sigma_x^2 \leq \frac{A^2}{2.326^2} \approx \frac{A^2}{5.41}$$

$$\boxed{\sigma_x^2 \leq \frac{A^2}{5.41} \approx 0.1849 A^2 \quad (\text{for } P_e < 10^{-2})}$$

**錯誤機率 < $10^{-4}$**：

$$\Phi(A/\sigma_x) > 0.9999$$

查表：$\Phi(3.719) \approx 0.9999$，所以：

$$\frac{A}{\sigma_x} \geq 3.719 \quad \Rightarrow \quad \sigma_x \leq \frac{A}{3.719}$$

$$\sigma_x^2 \leq \frac{A^2}{3.719^2} \approx \frac{A^2}{13.83}$$

$$\boxed{\sigma_x^2 \leq \frac{A^2}{13.83} \approx 0.0723 A^2 \quad (\text{for } P_e < 10^{-4})}$$

---

## 題目 S2.3（劉長遠 102-2 期末考）
**Level of Significance (假設檢定)**

A random variable $x$ is known to be characterized by either a Gaussian PDF with $E(x)=4$ and $\sigma_x=0.8$ or by a Gaussian PDF with $E(x)=5$ and $\sigma_x=1$. Consider the null hypothesis $H_0[E(x)=4, \sigma_x=0.8]$. We wish to test $H_0$ at the 0.05 level of significance. Our statistic is to be the sum of three experimental values of random variable $x$.

1. Determine the conditional probability of false acceptance of $H_0$.
2. Determine the conditional probability of false rejection of $H_0$.
3. Determine an upper bound on the probability that we shall arrive at an incorrect conclusion from this hypothesis test.

### 詳解
**考點**：假設檢定、Type I / Type II error、高斯分布的和

**解題思路**：

設檢定統計量 $S = x_1 + x_2 + x_3$。

**在 $H_0$ 下**（$E(x)=4, \sigma_x = 0.8$）：
$$E[S] = 3 \times 4 = 12, \quad \text{Var}(S) = 3 \times 0.64 = 1.92$$
$$\sigma_S = \sqrt{1.92} \approx 1.386$$

**在 $H_1$ 下**（$E(x)=5, \sigma_x = 1$）：
$$E[S] = 3 \times 5 = 15, \quad \text{Var}(S) = 3 \times 1 = 3$$
$$\sigma_S = \sqrt{3} \approx 1.732$$

由於 $H_1$ 的均值較大，所以使用**右尾檢定**（right-sided test）。

**步驟一：確定臨界值**

在 $H_0$ 下，0.05 的顯著水準意味著：

$$P(S > s^* \mid H_0) = 0.05$$

$$P\left(Z > \frac{s^* - 12}{1.386}\right) = 0.05 \quad \Rightarrow \quad \frac{s^* - 12}{1.386} = 1.645$$

$$s^* = 12 + 1.645 \times 1.386 = 12 + 2.280 = 14.280$$

#### 1. 條件假接受機率（Type II error, $\beta$）

假接受 $H_0$ = 在 $H_1$ 為真時，$S \leq s^*$：

$$\beta = P(S \leq 14.280 \mid H_1) = P\left(Z \leq \frac{14.280 - 15}{1.732}\right) = P(Z \leq -0.4157) = \Phi(-0.4157)$$

$$\beta = 1 - \Phi(0.4157) \approx 1 - 0.6612 = 0.3388$$

$$\boxed{P(\text{false acceptance of } H_0) = \beta \approx 0.339}$$

#### 2. 條件假拒絕機率（Type I error, $\alpha$）

這就是顯著水準本身：

$$\alpha = P(S > s^* \mid H_0) = 0.05$$

$$\boxed{P(\text{false rejection of } H_0) = \alpha = 0.05}$$

#### 3. 不正確結論的機率上界

不正確結論的機率為：

$$P(\text{incorrect}) = P(H_0 \text{ true}) \cdot \alpha + P(H_1 \text{ true}) \cdot \beta$$

由於我們不知道先驗機率 $P(H_0)$ 和 $P(H_1)$，上界為：

$$P(\text{incorrect}) \leq \max(\alpha, \beta) = \max(0.05, 0.339) = 0.339$$

或者更一般地，$P(\text{incorrect}) \leq P(H_0)\alpha + P(H_1)\beta \leq \max(\alpha, \beta)$，因為 $P(H_0) + P(H_1) = 1$。

$$\boxed{P(\text{incorrect conclusion}) \leq \beta \approx 0.339}$$

---

## 題目 S2.4（劉長遠 102-2 期末考）
**Probability About Coins**

1. For 3600 independent tosses of a fair coin, determine the probability that the number of heads is within $\pm 1\%$ of its expected value.

2. The outcomes of successive flips of another particular coin are dependent and are found to be described fully by:
   $$P(H_{n+1} | H_n) = 3/4, \quad P(T_{n+1} | T_n) = 2/3$$
   where $H_k$: Heads on $k$-th toss, $T_k$: Tails on $k$-th toss. The first toss came up heads.

   (a) Determine the probability that the first tail will occur on the $k$-th toss ($k = 2, 3, 4, \ldots$).

   (b) What is the probability that flip 5000 will come up heads?

   (c) Given that flips 5001, 5002, ..., 5000+m all have the same result, what is the probability that all of these $m$ outcomes are heads? Simplify your answer as much as possible and interpret your result for large values of $m$.

3. Consider the problem of estimating the parameter $P$ (the probability of heads) for one more particular coin. To begin, we assume the following a priori probability mass function for $P$:

   $$p_P(P_0) = \begin{cases} 0.2, & P_0 = 0.4 \\ 0.6, & P_0 = 0.5 \\ 0.2, & P_0 = 0.6 \end{cases}$$

   We are now told that the coin was flipped $n$ times. The first flip resulted in head, and the remaining $n-1$ flips resulted in tails. Determine the a posteriori PMF for $P$ as a function of $n$ for $n \geq 2$. Prepare neat sketches of this function for $n=2$ and $n=5$ and briefly state your findings.

### 詳解
**考點**：中央極限定理、Markov chain、貝氏推論

#### 第 1 部分：3600 次公平硬幣

設 $X$ = 正面次數，$X \sim \text{Binomial}(3600, 1/2)$。

$E[X] = 1800$，$\text{Var}(X) = 3600 \times 1/4 = 900$，$\sigma = 30$。

「在 $\pm 1\%$ 以內」即 $|X - 1800| \leq 1800 \times 0.01 = 18$，即 $1782 \leq X \leq 1818$。

由中央極限定理，$\frac{X - 1800}{30} \approx Z \sim N(0,1)$。

$$P(|X - 1800| \leq 18) = P\left(|Z| \leq \frac{18}{30}\right) = P(|Z| \leq 0.6)$$

$$= 2\Phi(0.6) - 1 = 2 \times 0.7257 - 1 = 0.4514$$

$$\boxed{P(\text{within } \pm 1\%) \approx 0.4514}$$

#### 第 2 部分 (a)：第一次出現反面在第 $k$ 次

第 1 次是正面。要使第 $k$ 次是第一個反面，需要第 2, 3, ..., $k-1$ 次全部是正面，第 $k$ 次是反面。

$$P(H_{n+1}|H_n) = 3/4 \implies P(T_{n+1}|H_n) = 1/4$$

所以：第 2 到 $k-1$ 次都是正面的機率 = $(3/4)^{k-2}$，第 $k$ 次是反面的機率 = $1/4$。

$$\boxed{P(\text{first tail on toss } k) = \left(\frac{3}{4}\right)^{k-2} \cdot \frac{1}{4}, \quad k = 2, 3, 4, \ldots}$$

#### 第 2 部分 (b)：第 5000 次是正面的機率

這是一個 Markov chain，轉移矩陣為：

$$\mathbf{P} = \begin{pmatrix} 3/4 & 1/4 \\ 1/3 & 2/3 \end{pmatrix}$$

（行：$H, T$，列：$H, T$，即 $P(H|H) = 3/4, P(T|H) = 1/4, P(H|T) = 1/3, P(T|T) = 2/3$）

求穩態分布 $\pi$：$\pi_H (1/4) = \pi_T (1/3)$，且 $\pi_H + \pi_T = 1$。

$$\pi_H / \pi_T = (1/3)/(1/4) = 4/3 \implies \pi_H = 4/7, \; \pi_T = 3/7$$

經過 4999 步轉移（從第 1 步到第 5000 步），系統幾乎已達穩態。要精確計算，需要特徵值。

特徵值：$\lambda_1 = 1$，$\lambda_2 = 3/4 - 1/3 = 5/12$。

$$P(H_{5000} | H_1) = \pi_H + (\pi_T)(1) \cdot \lambda_2^{4999} \cdot \text{(coefficient)}$$

更精確地，用特徵值分解：

$$\mathbf{P}^n = \begin{pmatrix} 4/7 & 3/7 \\ 4/7 & 3/7 \end{pmatrix} + \left(\frac{5}{12}\right)^n \begin{pmatrix} 3/7 & -3/7 \\ -4/7 & 4/7 \end{pmatrix}$$

$$P(H_{5000} | H_1) = \frac{4}{7} + \frac{3}{7}\left(\frac{5}{12}\right)^{4999}$$

由於 $(5/12)^{4999} \approx 0$：

$$\boxed{P(H_{5000} | H_1) = \frac{4}{7} + \frac{3}{7}\left(\frac{5}{12}\right)^{4999} \approx \frac{4}{7} \approx 0.5714}$$

#### 第 2 部分 (c)：5001 到 $5000+m$ 結果相同，求全為正面的機率

設事件 $A_m$：「5001 到 $5000+m$ 全部相同」。

由於 $n=5000$ 已很大，系統在穩態，$P(H_{5001}) \approx 4/7$。

- $P(\text{全部是 H}) = P(H_{5001}) \cdot (3/4)^{m-1} \approx \frac{4}{7} \cdot (3/4)^{m-1}$
- $P(\text{全部是 T}) = P(T_{5001}) \cdot (2/3)^{m-1} \approx \frac{3}{7} \cdot (2/3)^{m-1}$

$$P(\text{all same}) = \frac{4}{7}\left(\frac{3}{4}\right)^{m-1} + \frac{3}{7}\left(\frac{2}{3}\right)^{m-1}$$

$$P(\text{all H} \mid \text{all same}) = \frac{\frac{4}{7}(3/4)^{m-1}}{\frac{4}{7}(3/4)^{m-1} + \frac{3}{7}(2/3)^{m-1}}$$

$$= \frac{4 \cdot (3/4)^{m-1}}{4 \cdot (3/4)^{m-1} + 3 \cdot (2/3)^{m-1}}$$

化簡：乘以 $4^{m-1}/3^{m-1}$：

$$= \frac{4 \cdot 3^{m-1}/4^{m-1} \cdot 4^{m-1}/3^{m-1}}{4 \cdot 3^{m-1}/4^{m-1} \cdot 4^{m-1}/3^{m-1} + 3 \cdot 2^{m-1}/3^{m-1} \cdot 4^{m-1}/3^{m-1}}$$

$$= \frac{4}{4 + 3 \cdot (8/9)^{m-1}}$$

（因為 $\frac{(2/3)^{m-1}}{(3/4)^{m-1}} = \left(\frac{8}{9}\right)^{m-1}$）

$$\boxed{P(\text{all H} \mid \text{all same}) = \frac{4}{4 + 3(8/9)^{m-1}}}$$

**大 $m$ 的極限**：$(8/9)^{m-1} \to 0$，所以：

$$\lim_{m \to \infty} P(\text{all H} \mid \text{all same}) = \frac{4}{4+0} = 1$$

**解讀**：連續多次結果相同，當 $m$ 很大時，幾乎確定全部是正面。因為正面的自相關 $(3/4)$ 大於反面的自相關 $(2/3)$，正面更容易連續出現。

#### 第 3 部分：後驗 PMF

觀測到 1 次正面和 $n-1$ 次反面。利用貝氏定理：

$$P(P_0 \mid \text{data}) \propto P(\text{data} \mid P_0) \cdot P(P_0)$$

$P(\text{data} \mid P_0) = P_0^1 \cdot (1-P_0)^{n-1} = P_0(1-P_0)^{n-1}$

計算各 $P_0$ 的似然值乘以先驗：

| $P_0$ | $P(\text{data} \mid P_0)$ | Prior | Product |
|-------|---------------------------|-------|---------|
| 0.4 | $0.4 \times 0.6^{n-1}$ | 0.2 | $0.08 \times 0.6^{n-1}$ |
| 0.5 | $0.5 \times 0.5^{n-1} = 0.5^n$ | 0.6 | $0.6 \times 0.5^n = 0.3 \times 0.5^{n-1}$ |
| 0.6 | $0.6 \times 0.4^{n-1}$ | 0.2 | $0.12 \times 0.4^{n-1}$ |

歸一化常數：

$$C = 0.08 \times 0.6^{n-1} + 0.3 \times 0.5^{n-1} + 0.12 \times 0.4^{n-1}$$

後驗 PMF：

$$\boxed{P(P_0 \mid \text{data}) = \frac{1}{C} \times \begin{cases} 0.08 \times 0.6^{n-1}, & P_0 = 0.4 \\ 0.3 \times 0.5^{n-1}, & P_0 = 0.5 \\ 0.12 \times 0.4^{n-1}, & P_0 = 0.6 \end{cases}}$$

**$n=2$ 時**：

$$C = 0.08 \times 0.6 + 0.3 \times 0.5 + 0.12 \times 0.4 = 0.048 + 0.15 + 0.048 = 0.246$$

- $P(P_0 = 0.4) = 0.048/0.246 \approx 0.1951$
- $P(P_0 = 0.5) = 0.15/0.246 \approx 0.6098$
- $P(P_0 = 0.6) = 0.048/0.246 \approx 0.1951$

**$n=5$ 時**：

- $0.08 \times 0.6^4 = 0.08 \times 0.1296 = 0.010368$
- $0.3 \times 0.5^4 = 0.3 \times 0.0625 = 0.01875$
- $0.12 \times 0.4^4 = 0.12 \times 0.0256 = 0.003072$

$C = 0.010368 + 0.01875 + 0.003072 = 0.03219$

- $P(P_0 = 0.4) = 0.010368/0.03219 \approx 0.3220$
- $P(P_0 = 0.5) = 0.01875/0.03219 \approx 0.5825$
- $P(P_0 = 0.6) = 0.003072/0.03219 \approx 0.0954$

**結論**：隨著 $n$ 增大（觀察到越多反面），$P_0 = 0.4$（反面機率最高的假設）的後驗機率逐漸增加，而 $P_0 = 0.6$ 的後驗機率逐漸下降。數據逐漸壓倒先驗，後驗向最可能的參數值集中。

---

# 第三部分：102下 劉長遠 期中考 (2014春)

---

## 題目 S3.1（劉長遠 102-2 期中考）
**Probability basics — Independence**

1. Random variables $A, B, C, D$ satisfy:
   (a) $P(A)<1, P(B)<1, P(C)<1, P(D)<1$.
   (b) $A$ and $B$ are independent, and $C$ and $D$ are independent.
   (c) $A$ and $C$ are independent.
   Are $B$ and $D$ independent? Why?

2. Random variables $A, B, C, D$ satisfy:
   (a) $P(A)<1, P(B)<1, P(C)<1, P(D)<1$.
   (b) $A$ and $B$ are mutually exclusive, and $C$ and $D$ are mutually exclusive.
   (c) $A$ and $C$ are independent.
   Are $B$ and $D$ independent? Why?

3. In a communication network, link failures are independent, and each link has a probability of failure of $P$. The network is a bridge/ladder structure between nodes $A$ and $B$:

   ```
                a       b       c       d
          +--||--+--||--+--||--+--||--+
          |      |      |      |      |
    A ----+      |      |      |      +---- B
          |      | i    | j    | k    |
          +--||--+--||--+--||--+--||--+
                e       f       g       h
   ```

   (a) Given that exactly 7 links have failed, determine the probability that $A$ can still communicate with $B$.

   (b) Given that $a$, $h$, and $j$ have failed without information about conditions of other links, determine the probability that $A$ can still communicate with $B$.

### 詳解
**考點**：獨立性、互斥性、網路可靠度

#### 第 1 小題：$B$ 和 $D$ 是否獨立？

**答案：不一定（Not necessarily）。**

**反例**：設 $\Omega = \{1,2,3,4\}$，每個元素等機率 $1/4$。

令 $A = \{1,2\}, B = \{1,3\}, C = \{1,3\}, D = \{1,2\}$。

- $P(A) = P(B) = P(C) = P(D) = 1/2$（都 < 1）
- $A \cap B = \{1\}, P(A \cap B) = 1/4 = P(A)P(B)$，所以 $A, B$ 獨立
- $C \cap D = \{1\}, P(C \cap D) = 1/4 = P(C)P(D)$，所以 $C, D$ 獨立
- $A \cap C = \{1,2\} \cap \{1,3\} = \{1\}, P(A \cap C) = 1/4 = P(A)P(C)$，所以 $A, C$ 獨立
- $B \cap D = \{1,3\} \cap \{1,2\} = \{1\}, P(B \cap D) = 1/4 = P(B)P(D)$，$B, D$ 獨立

此例中 $B, D$ 恰好獨立。但改構例子可使其不獨立。

設 $\Omega = \{(i,j) : i,j \in \{0,1\}\}$，等機率。$A = \{i=0\}, B = \{j=0\}, C = \{i=0\}, D = \{j=0\}$。那 $B=D$，則 $P(B \cap D) = P(B) = 1/2 \neq 1/4 = P(B)P(D)$...但 $A=C$ 不是好的例子。

更好的反例需精心構造。一般來說，**僅知 (A,B) 獨立、(C,D) 獨立、(A,C) 獨立，不能推出 (B,D) 獨立**。

$$\boxed{\text{不一定獨立。三組獨立性無法推出 } B \text{ 和 } D \text{ 的獨立性。}}$$

#### 第 2 小題：$B$ 和 $D$ 是否獨立（互斥情形）？

已知：$A \cap B = \emptyset$（互斥）、$C \cap D = \emptyset$（互斥）、$A$ 和 $C$ 獨立。

**答案：不一定獨立。**

互斥意味著 $B \subset A^c$，$D \subset C^c$。但從 $A \perp C$ 不能推出 $B \perp D$，因為 $B$ 和 $D$ 可以是 $A^c$ 和 $C^c$ 的任意子集。

$$\boxed{\text{不一定獨立。互斥加上 } A \perp C \text{ 不足以保證 } B \perp D。}$$

#### 第 3 小題 (a)：恰好 7 條鏈路故障，A 仍能與 B 通信

網路有 11 條鏈路：$a, b, c, d, e, f, g, h, i, j, k$。恰好 7 條故障，即 4 條正常。

$A$ 和 $B$ 通信需要至少一條完整路徑。可能的路徑：
- 上方路徑：$a \to b \to c \to d$（4 條鏈路）
- 下方路徑：$e \to f \to g \to h$（4 條鏈路）
- 混合路徑（經由垂直鏈路 $i, j, k$）

恰好 4 條正常（即 7 故障），A-B 仍通的情況：

**路徑 1**：上方路徑 $\{a,b,c,d\}$ 全好。這恰好用了 4 條，且構成通路。
**路徑 2**：下方路徑 $\{e,f,g,h\}$ 全好。同理。
**其他**：可能經由垂直鏈路構成混合路徑。

例如：$\{a, b, j, g, h\}$ 是一條路（5條，太多）。只有 4 條正常的話，混合路徑需要很巧妙。

例如 $\{a, i, f, g, h\}$（5條）也太多。

4 條正常鏈路能構成 A-B 路徑的最短路徑恰好是 4（上方或下方）。

混合路徑最少需要 5 條鏈路（如 $a, b, j, g, h$），所以 4 條正常鏈路**無法**構成混合路徑。

因此，僅有上方路徑和下方路徑可行。但兩者不能同時成立（因為只有 4 條正常鏈路）。

有利事件數 = 2（上方全好 或 下方全好）。

總事件數 = $\binom{11}{4} = 330$。

但要檢查上方和下方是否有重疊：$\{a,b,c,d\} \cap \{e,f,g,h\} = \emptyset$，所以不會重疊。

$$P = \frac{2}{\binom{11}{4}} = \frac{2}{330} = \frac{1}{165}$$

$$\boxed{P(A \text{ can communicate with } B \mid 7 \text{ failures}) = \frac{1}{165}}$$

#### 第 3 小題 (b)：$a, h, j$ 故障，求 A-B 通信機率

已知 $a, h, j$ 故障。其餘 8 條鏈路（$b, c, d, e, f, g, i, k$）各自獨立地以機率 $P$ 故障。

$a$ 故障意味著上方路徑 $a-b-c-d$ 不通。$h$ 故障意味著下方路徑 $e-f-g-h$ 不通。$j$ 故障意味著中間垂直連結斷開。

A 到 B 的可能路徑（避開 $a, h, j$）：

A 的兩個出口是上方（$a$，已斷）和下方（$e$）。所以 A 只能走 $e$。

B 的兩個入口是上方（$d$）和下方（$h$，已斷）。所以 B 只能從 $d$ 進入。

A 從下方出發（經 $e$），需到達上方的 $d$ 入口。中間必須經過 $i$ 或 $k$（$j$ 已斷）。

可能的路徑：
1. $e \to i \to b \to c \to d$：需要 $e, i, b, c, d$ 都好
2. $e \to f \to g \to k \to d$：需要 $e, f, g, k, d$ 都好
3. $e \to i \to b \to c \to k^{-1} \to g \to \ldots$：更長路徑（不太可能需要）
4. $e \to f \to g \to k \to c^{-1} \to b \to \ldots$

由於是無向圖，路徑 1 和 2 是最直接的。

$A$ 能與 $B$ 通信等價於存在至少一條 $e$ 到 $d$ 的路徑（在剩餘正常鏈路中）。

路徑 1 需要 $\{e, i, b, c, d\}$ 全好。
路徑 2 需要 $\{e, f, g, k, d\}$ 全好。

兩條路徑共同需要 $e$ 和 $d$。如果 $e$ 或 $d$ 壞了，就完全不通。

$$P(\text{connect}) = P(\text{path 1 or path 2 works})$$

設 $q = 1-P$（鏈路正常機率）。

需要 $e$ 和 $d$ 都好（必要條件），機率 $q^2$。

在 $e, d$ 都好的條件下，還需要 $\{i, b, c\}$ 中至少有一條完整路或 $\{f, g, k\}$ 中至少有一條完整路。

不對，路徑 1 需要 $i, b, c$ 三條都好，路徑 2 需要 $f, g, k$ 三條都好。

$$P(\text{connect}) = q^2 \cdot P(\text{path 1 or path 2 } | \; e, d \text{ good})$$

$$= q^2 \cdot [1 - P(\text{neither path works})]$$

$$= q^2 \cdot [1 - (1 - q^3)(1 - q^3)]$$

$$= q^2 [1 - (1-q^3)^2]$$

$$= q^2 [2q^3 - q^6]$$

$$= q^2 \cdot q^3(2 - q^3)$$

$$= q^5(2 - q^3)$$

等等，我需要更仔細地考慮。路徑 1 需 $\{i, b, c\}$ 好，路徑 2 需 $\{f, g, k\}$ 好。這兩組沒有交集，所以在 $e, d$ 好的條件下它們是獨立的。

$$P(\text{connect}) = P(e \text{ good}) \cdot P(d \text{ good}) \cdot [1 - P(\{i,b,c\} \text{ not all good}) \cdot P(\{f,g,k\} \text{ not all good})]$$

$$= q^2 \cdot [1 - (1-q^3)(1-q^3)]$$

但是也有更複雜的路徑，如 $e \to f \to i^{-1}$... 不對，我需要仔細看圖的拓撲。

根據圖的結構：
- 上排節點（從左到右）：$A$, 節點1, 節點2, 節點3, $B$
- 下排節點：$A$, 節點4, 節點5, 節點6, $B$
- 上排鏈路：$a$(A-1), $b$(1-2), $c$(2-3), $d$(3-B)
- 下排鏈路：$e$(A-4), $f$(4-5), $g$(5-6), $h$(6-B)
- 垂直鏈路：$i$(1-4), $j$(2-5), $k$(3-6)

已斷：$a$(A-1), $h$(6-B), $j$(2-5)

A 只能經 $e$ 到節點4。B 只能從節點3 經 $d$。

從節點4 到節點3 的路徑：
1. $4 \xrightarrow{i} 1 \xrightarrow{b} 2 \xrightarrow{c} 3$：需 $i, b, c$
2. $4 \xrightarrow{f} 5 \xrightarrow{g} 6 \xrightarrow{k} 3$：需 $f, g, k$
3. $4 \xrightarrow{i} 1 \xrightarrow{b} 2 \xrightarrow{c} 3$（同 1）
4. $4 \xrightarrow{f} 5 \xrightarrow{j} 2 \xrightarrow{c} 3$：不行，$j$ 已斷
5. $4 \xrightarrow{i} 1 \xrightarrow{b} 2 \xrightarrow{j} 5 \xrightarrow{g} 6 \xrightarrow{k} 3$：$j$ 斷
6. $4 \xrightarrow{f} 5 \xrightarrow{g} 6 \xrightarrow{k} 3$（同 2）

所以只有路徑 1 和路徑 2，互相獨立。

$$P(\text{connect}) = q^2 \cdot [1 - (1-q^3)^2] = q^2(2q^3 - q^6)$$

以 $q = 1-P$ 代入：

$$\boxed{P(A \leftrightarrow B \mid a, h, j \text{ failed}) = (1-P)^2 \left[2(1-P)^3 - (1-P)^6\right] = (1-P)^5[2-(1-P)^3]}$$

---

## 題目 S3.2（劉長遠 102-2 期中考）
**Random variables — PMF**

1. We are given the following information about random variable $x$:
   $E[x]=24$, $E[x^2]=625$, $E[x \mid x > E[x]+\sigma_x]=40$, $P(x > E[x]+\sigma_x) = 0.2$.
   Determine the numerical value of $E[x \mid x \leq E[x]+\sigma_x]$.

2. Discrete random variable $x$ is described by the PMF:

   $$p_x(x_0) = \begin{cases} K - x_0/15, & x_0 = 0, 1, 2 \\ 0, & \text{otherwise} \end{cases}$$

   Let $d_1, d_2, \ldots, d_N$ represent $N$ successive independent experimental values of random variable $x$.

   (a) Determine the numerical value of $K$.
   (b) Determine the probability that $d_1 > d_2$.
   (c) Determine the probability that $\sum_{i=1}^{N} d_i \leq 1.0$.

### 詳解
**考點**：條件期望值、PMF 基本性質

#### 第 1 小題

已知：$E[x] = 24$，$E[x^2] = 625$。

$$\sigma_x^2 = E[x^2] - (E[x])^2 = 625 - 576 = 49 \implies \sigma_x = 7$$

所以 $E[x] + \sigma_x = 24 + 7 = 31$。

利用全期望值法則（total expectation）：

$$E[x] = E[x \mid x > 31] \cdot P(x > 31) + E[x \mid x \leq 31] \cdot P(x \leq 31)$$

$$24 = 40 \times 0.2 + E[x \mid x \leq 31] \times 0.8$$

$$24 = 8 + 0.8 \cdot E[x \mid x \leq 31]$$

$$E[x \mid x \leq 31] = \frac{24 - 8}{0.8} = \frac{16}{0.8} = 20$$

$$\boxed{E[x \mid x \leq E[x] + \sigma_x] = 20}$$

#### 第 2 小題 (a)：求 $K$

PMF 之和為 1：

$$\sum_{x_0=0}^{2} \left(K - \frac{x_0}{15}\right) = 1$$

$$\left(K - 0\right) + \left(K - \frac{1}{15}\right) + \left(K - \frac{2}{15}\right) = 1$$

$$3K - \frac{3}{15} = 1 \implies 3K - \frac{1}{5} = 1 \implies 3K = \frac{6}{5} \implies K = \frac{2}{5}$$

**驗證**：$p(0) = 2/5, \; p(1) = 2/5 - 1/15 = 6/15 - 1/15 = 5/15 = 1/3, \; p(2) = 2/5 - 2/15 = 6/15 - 2/15 = 4/15$。

$$2/5 + 1/3 + 4/15 = 6/15 + 5/15 + 4/15 = 15/15 = 1 \; \checkmark$$

$$\boxed{K = \frac{2}{5}}$$

#### 第 2 小題 (b)：$P(d_1 > d_2)$

列舉所有 $(d_1, d_2)$ 使得 $d_1 > d_2$：

| $(d_1, d_2)$ | $P$ |
|---|---|
| $(1, 0)$ | $\frac{1}{3} \times \frac{2}{5} = \frac{2}{15}$ |
| $(2, 0)$ | $\frac{4}{15} \times \frac{2}{5} = \frac{8}{75}$ |
| $(2, 1)$ | $\frac{4}{15} \times \frac{1}{3} = \frac{4}{45}$ |

$$P(d_1 > d_2) = \frac{2}{15} + \frac{8}{75} + \frac{4}{45}$$

通分（公分母 225）：

$$= \frac{30}{225} + \frac{24}{225} + \frac{20}{225} = \frac{74}{225}$$

$$\boxed{P(d_1 > d_2) = \frac{74}{225}}$$

#### 第 2 小題 (c)：$P\left(\sum_{i=1}^{N} d_i \leq 1\right)$

由於 $d_i \in \{0, 1, 2\}$，$\sum d_i \leq 1$ 意味著所有 $d_i$ 都是 0 或 1，且最多一個 $d_i = 1$，其餘全為 0。

- **情況 1**：全部 $d_i = 0$。機率 = $(2/5)^N$。
- **情況 2**：恰好一個 $d_i = 1$，其餘 $d_i = 0$。機率 = $\binom{N}{1} \cdot (1/3) \cdot (2/5)^{N-1} = \frac{N}{3} \cdot (2/5)^{N-1}$。

$$P\left(\sum d_i \leq 1\right) = \left(\frac{2}{5}\right)^N + \frac{N}{3}\left(\frac{2}{5}\right)^{N-1}$$

$$= \left(\frac{2}{5}\right)^{N-1} \left(\frac{2}{5} + \frac{N}{3}\right)$$

$$= \left(\frac{2}{5}\right)^{N-1} \cdot \frac{6 + 5N}{15}$$

$$\boxed{P\left(\sum_{i=1}^{N} d_i \leq 1\right) = \left(\frac{2}{5}\right)^{N-1} \cdot \frac{5N+6}{15}}$$

---

## 題目 S3.3（劉長遠 102-2 期中考）
**Z-transform**

Let $k$ be a random variable with z-transform:
$$P_k(z) = 0.25 z^T + 0.25 z^4 + 0.5 e^{-2(z-1)(z-2)}$$

(Note: $T$ in the original may be a specific value; we interpret this as $T$ being a parameter or possibly $T=0$ based on context.)

Let $x$ be a random variable with s-transform:
$$f_x(s) = \frac{0.5}{s + 0.5}$$

Let $w$ be the sum of $k$ independent experimental values of random variable $x$.

1. $E(k^2)$
2. $E(w)$

### 詳解
**考點**：Z-transform（機率生成函數）、s-transform（拉普拉斯轉換）、隨機和

**注意**：原題中的 $T$ 不太明確。我們假設 $T=0$，這是最常見的解讀（基本上代表一個在 0 處的質量點）。如果 $T$ 是其他值，只需替換即可。

以下我們以 $T=0$ 進行計算。

$$P_k(z) = 0.25 + 0.25 z^4 + 0.5 e^{-2(z-1)(z-2)}$$

但更合理的解讀是：$e^{-2(z-1)(z-2)}$ 展開在 $z=1$ 處。

注意：在 z-transform 的框架中，$P_k(z) = E[z^k]$。在 $z=1$ 處：$P_k(1) = 1$。

$$P_k(1) = 0.25 \cdot 1^0 + 0.25 \cdot 1^4 + 0.5 \cdot e^{-2(0)(-1)} = 0.25 + 0.25 + 0.5 \cdot e^0 = 0.25 + 0.25 + 0.5 = 1 \; \checkmark$$

#### 1. 求 $E(k^2)$

$E[k] = P_k'(1)$ 和 $E[k(k-1)] = P_k''(1)$，所以 $E[k^2] = P_k''(1) + P_k'(1)$。

**計算 $P_k'(z)$**：

$$P_k'(z) = 0.25 \cdot 0 + 0.25 \cdot 4z^3 + 0.5 \cdot \frac{d}{dz}e^{-2(z-1)(z-2)}$$

$(z-1)(z-2) = z^2 - 3z + 2$，所以 $\frac{d}{dz}[-2(z^2-3z+2)] = -2(2z-3) = -4z+6$。

$$\frac{d}{dz}e^{-2(z-1)(z-2)} = (-4z+6) \cdot e^{-2(z-1)(z-2)}$$

在 $z=1$：$(-4+6) \cdot e^{0} = 2$

$$P_k'(1) = 0 + 1 + 0.5 \times 2 = 2$$

$$E[k] = 2$$

**計算 $P_k''(z)$**：

$$P_k''(z) = 0.25 \cdot 12z^2 + 0.5 \cdot \frac{d}{dz}\left[(-4z+6)e^{-2(z-1)(z-2)}\right]$$

$$= 3z^2 + 0.5\left[-4 \cdot e^{-2(z-1)(z-2)} + (-4z+6)^2 e^{-2(z-1)(z-2)}\right]$$

在 $z=1$：

$$P_k''(1) = 3 + 0.5\left[-4 \cdot 1 + (2)^2 \cdot 1\right] = 3 + 0.5(-4+4) = 3 + 0 = 3$$

$$E[k^2] = P_k''(1) + P_k'(1) = 3 + 2 = 5$$

$$\boxed{E(k^2) = 5}$$

#### 2. 求 $E(w)$

$x$ 的 s-transform（Laplace transform of PDF）：$f_x(s) = \frac{0.5}{s+0.5}$

這是指數分布 $x \sim \text{Exponential}(\lambda = 0.5)$，PDF: $f(x) = 0.5 e^{-0.5x}$，$E[x] = 1/0.5 = 2$。

$w = x_1 + x_2 + \cdots + x_k$（$k$ 個獨立 $x$ 的和），其中 $k$ 是隨機的。

由隨機和的期望值公式（Wald's equation）：

$$E[w] = E[k] \cdot E[x] = 2 \times 2 = 4$$

$$\boxed{E(w) = 4}$$

---

## 題目 S3.4（劉長遠 102-2 期中考）
**Poisson Process**

A woman is seated beside a conveyor belt, and her job is to remove certain items from the belt. She has a narrow line of vision and can get these items only when they are right in front of her. She has noted that the probability that exactly $k$ of her items will arrive in a minute is given by:

$$p_k(k_0) = \frac{2^{k_0} e^{-2}}{k_0!}, \quad k_0 = 0, 1, 2, 3, \ldots$$

and she assumes that the arrivals of her items constitute a Poisson process.

1. If she wishes to sneak out to have a beer but will not allow the expected value of the number of items she misses to be greater than 5, how much time can she take?

2. If she leaves for two minutes, what is the probability that she will miss a total of exactly 4 items?

3. The union has installed a bell which rings once a minute with precisely one-minute intervals between gongs. If, between two successive gongs, more than 3 items come along the belt, she will handle only 3 of them properly and will destroy the rest. Under this system, what is the probability that any particular item will be destroyed?

### 詳解
**考點**：Poisson 過程、Poisson 分布的性質

到達率 $\lambda = 2$ items/minute（由 PMF 可知）。

#### 第 1 小題：最長離開時間

離開 $t$ 分鐘，期望遺漏數 = $\lambda t = 2t$。

要求 $2t \leq 5$：

$$t \leq 2.5 \text{ 分鐘}$$

$$\boxed{t = 2.5 \text{ 分鐘（即 2 分 30 秒）}}$$

#### 第 2 小題：離開 2 分鐘，恰好遺漏 4 件

離開 2 分鐘，到達的物品數服從 $\text{Poisson}(\lambda \times 2 = 4)$。

$$P(k = 4) = \frac{4^4 e^{-4}}{4!} = \frac{256 \cdot e^{-4}}{24} = \frac{32 e^{-4}}{3}$$

$$\approx \frac{32 \times 0.01832}{3} = \frac{0.5861}{3} \approx 0.1954$$

$$\boxed{P(\text{miss exactly 4}) = \frac{256 e^{-4}}{24} = \frac{32}{3} e^{-4} \approx 0.1954}$$

#### 第 3 小題：任何特定物品被銷毀的機率

每分鐘內到達 $n$ 個物品（$n \sim \text{Poisson}(2)$）。如果 $n > 3$，她只處理 3 個，銷毀 $n - 3$ 個。

**給定 $n$ 個物品到達**：每個物品被銷毀的機率（對稱性下）= $(n-3)/n$（如果 $n > 3$），$= 0$（如果 $n \leq 3$）。

更正式地：一個「特定物品」到達時，該分鐘內的其他物品數量也需要考慮。

但實際上，由 PASTA（Poisson Arrivals See Time Averages）：一個特定物品到達某一分鐘，該分鐘內的總到達數為 $N$，那麼該物品被銷毀的機率為：

$$P(\text{destroyed} \mid N = n) = \begin{cases} 0, & n \leq 3 \\ \frac{n-3}{n}, & n > 3 \end{cases}$$

但由 Poisson 過程的性質，給定某個特定物品到達了這一分鐘，那一分鐘的「其他物品數」服從 $\text{Poisson}(2)$，即 $M = N - 1 \sim \text{Poisson}(2)$（移除這個物品本身後，其餘仍為 Poisson）。

所以在 $N = n$ 個物品（含此物品）中，若 $n > 3$，此物品是 $n$ 個之一，被銷毀的 $n-3$ 個之一的機率為 $\frac{n-3}{n}$。

$$P(\text{destroyed}) = \sum_{n=4}^{\infty} P(N=n) \cdot \frac{n-3}{n}$$

但 $N$ 是什麼分布？如果我們已知此物品在這一分鐘到達，$N$ 的分布需要用 size-biasing 或直接條件。

更直接的方法：在某一分鐘內，被銷毀的物品數 = $\max(N-3, 0)$。每個物品被銷毀的機率相同（對稱性）。

$$E[\text{destroyed in 1 min}] = E[\max(N-3, 0)] = \sum_{n=4}^{\infty} (n-3) P(N=n)$$

$$E[\text{total in 1 min}] = E[N] = 2$$

$$P(\text{特定物品被銷毀}) = \frac{E[\text{destroyed}]}{E[N]} = \frac{\sum_{n=4}^{\infty}(n-3)P(N=n)}{2}$$

計算 $\sum_{n=4}^{\infty}(n-3)P(N=n)$（$N \sim \text{Poisson}(2)$）：

$$= \sum_{n=4}^{\infty}(n-3)\frac{2^n e^{-2}}{n!}$$

$$= E[N-3 \mid N \geq 4] \cdot P(N \geq 4) = E[\max(N-3, 0)]$$

$$= E[N] - 3 + 3P(N=0) + 2P(N=1) + P(N=2) + 0 \cdot P(N=3) - \sum_{n=0}^{3}(n-3)P(N=n)$$

更簡單地直接算：

$$E[\max(N-3,0)] = E[N-3] + E[\min(3-N,3)\cdot \mathbf{1}_{N<3}] + 3P(N\leq 3) - E[N \cdot \mathbf{1}_{N\leq 3}]$$

其實最直接是：

$$E[\max(N-3,0)] = \sum_{n=0}^{\infty} \max(n-3,0) P(N=n) = \sum_{n=4}^{\infty}(n-3)P(N=n)$$

$P(N=n)$ for $N \sim \text{Poisson}(2)$：
- $P(4) = 16e^{-2}/24 = 2e^{-2}/3$
- $P(5) = 32e^{-2}/120 = 4e^{-2}/15$
- $P(6) = 64e^{-2}/720 = 4e^{-2}/45$
- ...

$$\sum_{n=4}^{\infty}(n-3)P(N=n) = 1 \cdot P(4) + 2 \cdot P(5) + 3 \cdot P(6) + \cdots$$

令 $m = n-3$：

$$= \sum_{m=1}^{\infty} m \cdot \frac{2^{m+3} e^{-2}}{(m+3)!}$$

用另一種方式：

$$E[\max(N-3,0)] = E[N] - E[\min(N,3)]$$

$$E[\min(N,3)] = \sum_{n=0}^{\infty} \min(n,3) P(N=n) = \sum_{n=1}^{3} n \cdot P(N=n) + 3 \sum_{n=3}^{\infty} P(N=n)$$

不，更仔細地：

$$E[\min(N,3)] = \sum_{n=0}^{2} n \cdot P(N=n) + 3 \cdot P(N \geq 3)$$

$$= 0 \cdot P(0) + 1 \cdot P(1) + 2 \cdot P(2) + 3[1 - P(0) - P(1) - P(2)]$$

$$= P(1) + 2P(2) + 3 - 3P(0) - 3P(1) - 3P(2)$$

$$= 3 - 3P(0) - 2P(1) - P(2)$$

$P(0) = e^{-2}$，$P(1) = 2e^{-2}$，$P(2) = 2e^{-2}$。

$$E[\min(N,3)] = 3 - 3e^{-2} - 4e^{-2} - 2e^{-2} = 3 - 9e^{-2}$$

$$E[\max(N-3,0)] = E[N] - E[\min(N,3)] = 2 - (3 - 9e^{-2}) = -1 + 9e^{-2}$$

$$= 9e^{-2} - 1 \approx 9 \times 0.1353 - 1 = 1.2181 - 1 = 0.2181$$

$$P(\text{destroyed}) = \frac{9e^{-2} - 1}{2}$$

$$\boxed{P(\text{任何特定物品被銷毀}) = \frac{9e^{-2}-1}{2} \approx 0.1091}$$

---
