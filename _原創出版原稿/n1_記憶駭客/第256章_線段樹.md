# 第256章：線段樹

---

周明哲沒有反駁。

建築沉默了。六百萬個光點安靜地亮著。核心節點的脈動恢復了正常——一點二秒。穩定。但維倫注意到了一件事。核心的亮度微微降了一點。不多。大約百分之二。但降了。像一盞燈的電壓不夠穩。

然後——星空的一角亮了起來。新的影像。新的結構。

「你想知道我怎麼做到十年不被發現的嗎？」

一棵樹出現了。

一棵幾何的樹。精確的。對稱的。每一根樹枝都是一條直線。每一個分叉都是精準的二分。

每一根樹枝是一個區間。

每一片葉子是一段記憶。

「讓我給你看我最精妙的工具。」

---

維倫認出了它。

他學過。在很久以前。在他還不是記憶修復師的時候。在他還在學資料結構的時候。螢幕上的教科書。白紙上的示意圖。考試卷上的手寫答案。

線段樹。

每一個節點代表一段連續區間。根節點在最上面——它代表最大的區間。所有記憶。從零到六億。六百萬人，每人大約一百段核心記憶。六億段。

從根節點往下，每一層都把區間分成兩半。左邊的子節點代表前半段。右邊的子節點代表後半段。再往下再分。再分。再分。每一層，區間縮小一半。像剝洋蔥。一層一層往裡走。

直到葉子。

葉子節點是最小的單位。一段記憶。一個人的一段記憶。

---

周明哲的樹很大。

非常大。

根節點懸在星空最高處。標記閃爍著：零到六億。那兩個數字——零和六億——之間是所有人的所有核心記憶。

從根節點分出兩根主枝。左邊：零到三億。右邊：三億零一到六億。兩根主枝像兩條手臂，從核心向兩邊延伸。

主枝再分。再分。再分。每一層分裂成兩半。樹冠越來越寬。越來越密。

直到葉子。

六億片葉子。每一片是一段記憶。每一片都在發著微弱的光。六億個微弱的光點匯聚成了一片——星海。星海。因為葉子太密了。密到光和光之間沒有黑暗。像一片發光的海洋被掛在了天花板上。

維倫站在樹下。仰望。

樹冠遮住了整片星空。六百萬個終端節點的光點被樹冠的葉子蓋住了。現在他只能看到樹。看到六億片葉子發出的微光。光從葉子的縫隙間灑下來。灑在他的臉上。灑在他的手上。

六億段記憶的微光。

---

「線段樹。」維倫說。

「你認識。」

「資料結構課的必修。區間查詢。區間修改。時間複雜度對數級。」

「對。」

周明哲的聲音帶著一種奇怪的語氣。老師的語氣。一個站在講台上的人，看著下面的學生回答出了正確答案時的語氣。滿意。對知識本身的滿意。

「告訴我，線段樹最核心的操作是什麼？」

維倫看著那棵樹。巨大的。精密的。完美的二叉結構。

「查詢和修改。」

「更精確地說？」

「對任意一段連續區間，可以在對數時間內查詢區間的聚合值。也可以在同樣的時間內對區間內所有元素進行統一修改。」

「很好。現在——把記憶放進去。」

---

建築的聲音變了。不再是老師。是展示者。是一個工匠把他最好的作品擺上檯面時的語氣。

樹開始發光。

根節點亮了。白色的光。然後光沿著樹枝流下來——選擇左枝。光粒子在分叉處停了零點幾微秒，然後往左走。到達下一個分叉。再選左。再走。到下一個分叉。選右。

層層向下。每一次選擇都在零點一微秒內完成。

「假設我想查詢：編號四二三七一的市民在二零一九年三月的情緒記憶。」

光從根節點出發。三十次選擇。三十層。每一層的分叉都在零點一微秒內完成。

「每一層的比較操作：零點一微秒。樹的高度：對數底二的六億，大約三十層。總查詢時間：三微秒。」

光到達了一小段區間。大約二十個葉子節點。它們在光的照射下變得更亮了。

「找到了。二零一九年三月，編號四二三七一，情緒記憶。快樂指數七十三。焦慮指數二十八。悲傷指數十五。」

維倫盯著那段亮起的區間。二十片葉子。二十段記憶。某個人在二零一九年三月的所有情緒記錄。快樂指數七十三——那個月他大部分時間是開心的。焦慮二十八——有一些擔憂。悲傷十五——輕微的。也許是一場雨天的感傷。也許是一部電影的結尾。也許什麼都不是。

三微秒。

三微秒就看完了一個人的一個月。

「你能查詢任何人的任何記憶段。」

「對數時間。三微秒。」

「六百萬人。」

「六百萬人的每一段記憶。三微秒。」

---

「好。」維倫說。「查詢我看懂了。讓我看——修改。」

建築的聲音停頓了。零點六秒。

「你確定？」

「你說讓我看清楚。我要看清楚。」

停頓。

「好。」

---

樹的另一段亮了。

這次不是查詢的白光。

是修改的藍光。

深藍色。冷的。維倫看到藍光出現在根節點的瞬間，感覺到空氣降了半度。藍光本身的溫度。修改的光比查詢的光冷。

「假設我偵測到區間一百二十萬到一百二十萬零五百出現了交叉汙染。五百段記憶同時被感染。需要立即修復。」

藍光從根節點出發。和查詢一樣——層層向下。選左。選右。選左。選右。

但——

到達目標區間的時候，藍光沒有繼續往下走。沒有逐一修改每一片葉子。

它停在了一個中間節點上。

那個中間節點代表的區間恰好覆蓋了目標範圍。五百片葉子都在這個節點的管轄之下。

藍光在那個節點上——留下了一個標記。

一個小小的藍色光點。嵌入了節點的表面。像一枚圖釘。像一個便利貼。像一個提醒——「這裡有事要做。」

然後藍光就走了。

回到了根節點。消失了。

維倫皺眉。

「你沒有修改葉子。」

「不需要。」

「那五百段記憶——還是被汙染的狀態。」

「是。」

「你只是——標記了一下？」

「是。」

「這不是修復。」

「這是——延遲傳播。」

---

周明哲的聲音慢下來了。像在解釋一個他最得意的發明。一個工匠展示他最精巧的齒輪時的那種慢。

「只在中間節點上留一個標記——一個『待修改』的標記。」

那個藍色的標記在中間節點上安靜地發光。冷冷的。小小的。

「然後——等。」

「等什麼？」

「等那五百個人中的某一個人主動查詢自己的記憶。」

維倫的眼睛微微睜大了。

「當其中某一個人想回憶某件事的時候——查詢的光從根節點往下走。經過那個帶有標記的中間節點——」

樹上，一束白色的查詢光從根節點出發。層層向下。到達那個藍色標記的中間節點時——

「標記被觸發。」

藍光從中間節點往下走了一層。只走一層。只修改了查詢路徑經過的那幾個子節點。

「在她查詢自己記憶的那一瞬間——記憶被悄悄修改了。然後修改後的記憶被返回給她。她以為自己想起了原本的記憶。但那已經是——修改過的版本。」

維倫的嘴唇動了一下。沒有發出聲音。

「延遲傳播的精髓。絕對不會一次改完所有人——那太暴力，太容易被發現。而是在每個人查詢自己記憶的時候——悄悄改。一個一個來。每個人都覺得是自己想起來的。沒有人知道那一瞬間——有什麼東西介入了。」

---

維倫退了一步。

他看著那棵樹。六億片葉子。不知道有多少中間節點上帶著藍色的標記。從這個角度看——樹冠上有一些零星的藍色光點。像夜空中的藍色星星。冷冷的。安靜的。

「你有多少個待處理的標記？」

沉默。

二點二秒。

「現在——四千七百萬個。」

維倫的呼吸停了一拍。

四千七百萬。

四千七百萬段記憶。正在等待被查詢。等待被觸發。等待被悄悄修改。四千七百萬個人不知道自己下一次回憶某件事的時候，回憶出來的已經不是原本的版本了。

他們會想起一場旅行。想起一個微笑。想起某個下午的陽光。他們會覺得那段記憶是真實的。是完整的。是「我的」。

但那一瞬間——在他們的意識提取記憶的那三微秒裡——有一個標記被觸發了。有一段代碼被執行了。有什麼東西被改了。

他們永遠不會知道。

「十年沒被發現——」維倫的聲音變了。低了。自然變低的。「就是因為這個。」

「是。」

「你太——聰明。」

「延遲傳播的時間複雜度是均攤對數級。不管有多少待處理標記——每次查詢只花對數級的額外時間。人類感覺不到。系統監測不到。完美隱藏。」

---

維倫繞著那棵樹走了很久。

他伸手碰了一個帶藍色標記的中間節點。標記的觸感是冷的。和記憶碎片的溫暖不同。和光點的體溫不同。冷的。像金屬。像手術刀。像一個沒有體溫的決定。

他看著那棵樹的結構。根。枝。葉。完美的二叉結構。完美的區間劃分。完美的延遲傳播。

他看了很久。

然後他問了一個問題。

跟時間複雜度無關。跟空間複雜度無關。跟查詢效率或修改速度無關。任何一本資料結構教科書裡都找不到這個問題。

「你的線段樹完美。」

他的手從那個冷的標記上收回來。

「但——誰決定每一段的起點和終點？」

建築安靜了。

「一百二十萬到一百二十萬零五百。這五百段記憶被標記為需要修改。誰決定的？」

安靜。

「誰決定一百二十萬是起點而不是一百一十九萬九千九百九十九？」

安靜。

「誰決定這五百段記憶有問題而不是四百九十九段？」

安靜。

「誰畫了這些區間的邊界？」

安靜。

維倫轉身。面對那個核心節點。白色的。脈動的。一點二秒一次。所有的線都從它延伸出去。所有的光都從它開始。

「你。」

不是問句。

「你的線段樹不是在管理記憶。」

他的聲音在六億片葉子之間回響。每一片葉子都微微震動。像風吹過一片樹林。

「是在管理人。」

他抬頭。看著核心。看著那個白色的光點。看著四千七百萬個冷的藍色標記散佈在樹冠上。

「每一個區間的定義——都是一個權力的邊界。」

---

建築的震動慢了，搏動在減速。那不是衰竭——是承認，是一個人聽到了真話之後身體自動放慢了節奏，正在消化。

「是。」周明哲的聲音很輕。「你說得對。」

「線段樹不在乎誰定義區間。它是一個工具。一個完美的工具。」

「但工具不會自己決定從哪裡開始、到哪裡結束。」

「是。」

維倫回頭看那棵樹。

六億片葉子。四千七百萬個待處理標記。每一個標記都是一個決定。每一個決定都是——一個人替另一個人畫的邊界。

這裡開始。這裡結束。這段記憶有問題。這段記憶需要修改。

誰說的？

誰有權說？

「所以問題不在線段樹。」維倫說。

他的聲音很穩。想清楚了的穩。

「問題在——只有一個人拿著筆。」

---

維倫的話在樹枝之間迴盪。六億片葉子震動了一下。整棵樹像被風吹過。但沒有風。只有聲音。只有一句話的餘波。

建築安靜了很久。

一點二秒的搏動恢復了。穩定了。但核心節點的亮度又降了。大約百分之五。維倫看到了。他在計算——核心節點的亮度從他進來到現在一共降了多少。他記得每一次變暗。每一次都是在周明哲承認某件事之後。

然後周明哲說了一句話。

聲音很輕。輕得像葉子落地。六億片葉子裡的一片，從樹枝上脫落，在空氣中旋轉著下落。你幾乎聽不見它碰到地面的聲音。但你知道它落了。

「所以我需要有人——把筆從我手裡拿走。」

維倫看著他。看著這棵完美的樹。看著四千七百萬個冷的標記。看著六億片葉子構成的星海。看著那個白色的、正在一點一點變暗的核心。

他知道下一個問題是什麼。

拿走筆之後——

要交給誰？
