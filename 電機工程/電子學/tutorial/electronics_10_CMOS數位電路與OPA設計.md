# 電子學（十）：CMOS 數位電路與運算放大器設計

## 🔰 本章基礎觀念（零基礎必讀）

### 從類比到數位

前面九章我們一直在討論**類比電路**——信號是連續變化的，放大器的任務是忠實地放大信號。

但你每天使用的電腦、手機處理的都是**數位信號**——只有 0 和 1。

> **白話比喻**：類比電路像是用一支筆畫出平滑的曲線，數位電路像是用積木搭建——只用兩種高度的方塊（高=1，低=0）。

### 為什麼 CMOS？

**CMOS（Complementary MOS）**技術同時使用 NMOS 和 PMOS，是現代所有數位 IC 的基礎。

**CMOS 的最大優勢**：**靜態功耗幾乎為零！** 在不切換的時候，從 VDD 到地之間沒有直流路徑。

### 本章兩大主題

1. **CMOS 數位電路**：反相器、邏輯閘、傳輸閘
2. **運算放大器（OPA）設計**：將前面所有類比知識整合

---

## 一、CMOS 反相器完整分析

### 1.1 基本結構

CMOS 反相器由一個 NMOS（下拉網路）和一個 PMOS（上拉網路）組成：

- **PMOS**：源極接 VDD，閘極接輸入，汲極接輸出
- **NMOS**：源極接 GND，閘極接輸入，汲極接輸出

### 1.2 工作原理

| 輸入 Vin | NMOS 狀態 | PMOS 狀態 | 輸出 Vout | 直流路徑 |
|---------|----------|----------|----------|---------|
| 0（GND） | 截止 | 導通 | VDD（1） | **無** |
| VDD（1） | 導通 | 截止 | 0（GND） | **無** |
| 過渡中間 | 都導通 | 都導通 | 中間值 | **有** |

> **關鍵**：在穩態（輸入為 0 或 VDD），一定有一個管截止，所以沒有從 VDD 到 GND 的直流通路 → **靜態功耗為零！**

### 1.3 VTC 曲線（Voltage Transfer Characteristic）

VTC 曲線描述 Vout 對 Vin 的靜態關係，有五個區域：

| 區域 | Vin 範圍 | NMOS | PMOS | Vout |
|------|---------|------|------|------|
| 1 | 0 ~ Vthn | 截止 | 線性 | VDD |
| 2 | Vthn ~ VM | 飽和 | 線性 | 高→中 |
| 3 | ≈ VM | 飽和 | 飽和 | **快速下降** |
| 4 | VM ~ VDD+Vthp | 線性 | 飽和 | 中→低 |
| 5 | VDD+Vthp ~ VDD | 線性 | 截止 | 0 |

### 1.4 開關閾值（Switching Threshold, VM）

VM 是 Vin = Vout 的點，此時兩管都在飽和區：

$$V_M = \frac{V_{DD} + V_{thp} + V_{thn}\sqrt{k_r}}{1 + \sqrt{k_r}}$$

其中 kr = kn/kp = [kn'(W/L)n]/[kp'(W/L)p]

**對稱反相器**（VM = VDD/2）的條件：

$$k_n' \left(\frac{W}{L}\right)_n = k_p' \left(\frac{W}{L}\right)_p$$

因為 μn ≈ 2~3μp，所以通常需要 **(W/L)p = 2~3 × (W/L)n**

### 數值例題 10.1：對稱反相器設計

> **題目**：VDD = 1.8V，Vthn = 0.4V，Vthp = -0.4V，kn' = 200μA/V²，kp' = 80μA/V²。
> (W/L)n = 2。要求 VM = VDD/2 = 0.9V。求 (W/L)p。
>
> **解答**：
> 對稱條件：kn'(W/L)n = kp'(W/L)p
> 200μ × 2 = 80μ × (W/L)p
> (W/L)p = 400μ/80μ = **5**
>
> 驗證：kr = (200×2)/(80×5) = 400/400 = 1
> VM = (1.8 + (-0.4) + 0.4×1)/(1+1) = 1.8/2 = **0.9V** ✓

### 1.5 雜訊邊限（Noise Margin）

$$NM_H = V_{OH} - V_{IH}$$
$$NM_L = V_{IL} - V_{OL}$$

其中：
- VOH：輸出高電位（理想 = VDD）
- VOL：輸出低電位（理想 = 0）
- VIH：輸入高電位門檻（VTC 斜率 = -1 的上方點）
- VIL：輸入低電位門檻（VTC 斜率 = -1 的下方點）

**理想 CMOS 反相器**：VOH = VDD，VOL = 0
**對稱反相器**：NMH = NML ≈ VDD × 0.4（經驗值）

### 數值例題 10.2：雜訊邊限

> **題目**：VDD = 1.8V 的對稱 CMOS 反相器，VOH = 1.8V，VOL = 0V。
> VIH = 1.0V，VIL = 0.8V（由 VTC 求得）。求雜訊邊限。
>
> **解答**：
> NMH = VOH - VIH = 1.8 - 1.0 = **0.8V**
> NML = VIL - VOL = 0.8 - 0 = **0.8V**
>
> 兩邊都有 0.8V 的雜訊容忍空間。

---

## 二、動態特性

### 2.1 傳播延遲（Propagation Delay, tpd）

$$t_{pd} = \frac{t_{pHL} + t_{pLH}}{2}$$

- tpHL：輸出從高到低的延遲
- tpLH：輸出從低到高的延遲

### 2.2 延遲的計算

$$t_{pHL} = 0.69 \cdot R_{eq,n} \cdot C_L$$
$$t_{pLH} = 0.69 \cdot R_{eq,p} \cdot C_L$$

其中 CL 是負載電容，Req,n 和 Req,p 是 NMOS 和 PMOS 的等效導通電阻。

$$R_{eq} \approx \frac{1}{k'(W/L)(V_{DD} - V_{th})} \quad (\text{近似})$$

### 數值例題 10.3：傳播延遲

> **題目**：CMOS 反相器，Req,n = 5kΩ，Req,p = 12kΩ，CL = 50fF。求 tpd。
>
> **解答**：
> tpHL = 0.69 × 5k × 50f = 0.69 × 250p = 172.5 ps
> tpLH = 0.69 × 12k × 50f = 0.69 × 600p = 414 ps
> tpd = (172.5 + 414)/2 = **293 ps**
>
> **PMOS 較慢**（因為電洞遷移率低），通常是速度瓶頸。

### 2.3 功率消耗

**靜態功耗**：
$$P_{static} = V_{DD} \cdot I_{leakage} \approx 0 \quad (\text{理想情況})$$

**動態功耗（主要功耗來源）**：
$$P_{dynamic} = C_L \cdot V_{DD}^2 \cdot f_{clk}$$

其中 fclk 是切換頻率。

**短路功耗**：
切換過程中兩管同時導通的短暫時間消耗的功率。

$$P_{total} = P_{dynamic} + P_{short-circuit} + P_{static}$$

### 數值例題 10.4：功率消耗

> **題目**：CMOS 反相器，VDD = 1.8V，CL = 100fF，fclk = 1GHz。
> 求動態功率。若晶片有 10⁹ 個等效反相器，假設 10% 同時切換，求總功率。
>
> **解答**：
> 每個反相器：P = CL × VDD² × f = 100f × 1.8² × 1G
> = 100×10⁻¹⁵ × 3.24 × 10⁹ = 324 × 10⁻⁶ = **324 μW**
>
> 全晶片：P = 10⁹ × 0.1 × 324μ = 10⁸ × 324μ = **32.4 W**
>
> 這就是為什麼現代處理器需要散熱器！

---

## 三、CMOS 邏輯閘

### 3.1 設計原則

- **NMOS 做下拉網路（Pull-down Network, PDN）**：連接輸出和 GND
- **PMOS 做上拉網路（Pull-up Network, PUN）**：連接輸出和 VDD
- **PDN 和 PUN 是互補的**：PDN 中的串聯對應 PUN 中的並聯，反之亦然

### 3.2 CMOS NAND 閘

**功能**：Y = (A·B)' = NOT(A AND B)

**結構**：
- PDN：兩個 NMOS **串聯**（A 和 B 都為 1 才下拉）
- PUN：兩個 PMOS **並聯**（A 或 B 為 0 就上拉）

| A | B | NMOS串聯 | PMOS並聯 | Y |
|---|---|---------|---------|---|
| 0 | 0 | 斷路 | 導通 | 1 |
| 0 | 1 | 斷路 | 導通 | 1 |
| 1 | 0 | 斷路 | 導通 | 1 |
| 1 | 1 | **導通** | 斷路 | **0** |

### 3.3 CMOS NOR 閘

**功能**：Y = (A+B)' = NOT(A OR B)

**結構**：
- PDN：兩個 NMOS **並聯**（A 或 B 為 1 就下拉）
- PUN：兩個 PMOS **串聯**（A 和 B 都為 0 才上拉）

| A | B | NMOS並聯 | PMOS串聯 | Y |
|---|---|---------|---------|---|
| 0 | 0 | 斷路 | **導通** | **1** |
| 0 | 1 | 導通 | 斷路 | 0 |
| 1 | 0 | 導通 | 斷路 | 0 |
| 1 | 1 | 導通 | 斷路 | 0 |

### 3.4 複雜邏輯閘

**例**：Y = ((A·B) + C)' = NOT((A AND B) OR C)

PDN 結構：
- A 和 B 串聯，再與 C 並聯

PUN 結構（互補）：
- A 和 B 並聯，再與 C 串聯

### 3.5 NAND vs NOR 的速度比較

- **NAND 通常更快**：PDN 是 NMOS 串聯（慢一點），但 PUN 是 PMOS 並聯（快一點）
- **NOR 較慢**：PUN 是 PMOS 串聯（最慢的組合）

> **實務**：NAND 閘是 CMOS 設計中最常用的基本閘。

### 數值例題 10.5：NAND 閘的電晶體尺寸

> **題目**：2 輸入 CMOS NAND 閘，要求等效於反相器（相同的 Req）。
> 反相器的 (W/L)n = 2，(W/L)p = 5。
> 求 NAND 閘中每個 NMOS 和 PMOS 的 W/L。
>
> **解答**：
> **NMOS（串聯 ×2）**：每個管的 W/L 要加倍 → **(W/L)n = 4**
>（兩個串聯的等效電阻是單個的 2 倍，要維持相同 Req 就要 W 加倍）
>
> **PMOS（並聯 ×2）**：每個管的 W/L 不變 → **(W/L)p = 5**
>（兩個並聯的等效電阻是單個的一半，本來就更低了）
>
> **結果**：每個 NMOS W/L = 4，每個 PMOS W/L = 5
> 總電晶體面積 = 2×4 + 2×5 = 18（反相器 = 2+5 = 7，NAND 約 2.6 倍）

---

## 四、傳輸閘（Transmission Gate）

### 4.1 為什麼需要傳輸閘？

單獨的 NMOS 開關有問題：
- 傳遞邏輯 1 時（VDD），VGS = VDD - Vout，當 Vout 接近 VDD 時 VGS 接近 0，NMOS 進入截止→**無法完整傳遞高電位**

PMOS 開關也有問題：
- **無法完整傳遞低電位**

### 4.2 傳輸閘的結構

**NMOS 和 PMOS 並聯**，閘極信號互補（φ 和 φ'）：

- 當 φ = VDD、φ' = 0：兩管都導通→ 信號完整傳遞
- 當 φ = 0、φ' = VDD：兩管都截止→ 信號阻斷

**優點**：可以完美傳遞從 0 到 VDD 的所有電壓。

---

## 五、運算放大器（OPA）設計基礎

### 5.1 理想運算放大器回顧

| 特性 | 理想值 | 實際 |
|------|-------|------|
| 開迴路增益 | ∞ | 60~120 dB |
| 輸入阻抗 | ∞ | > 1MΩ |
| 輸出阻抗 | 0 | < 100Ω |
| 頻寬 | ∞ | GBW = 1~1000 MHz |
| CMRR | ∞ | 60~120 dB |
| 失調電壓 | 0 | 0.1~10 mV |
| 迴轉率 | ∞ | 0.1~1000 V/μs |

### 5.2 兩級 OTA 架構（最經典）

**OTA = Operational Transconductance Amplifier**

**第一級**：差動輸入對 + 主動負載
- 提供高增益的第一級放大
- 差模輸入、單端輸出
- NMOS 差動對 + PMOS 電流鏡負載

**第二級**：共源極放大器 + 主動負載
- 再提供一級增益
- CS 放大器（通常是 NMOS）+ PMOS 電流源負載

**偏壓電路**：
- 電流鏡提供穩定的偏壓電流

**補償**：
- 米勒電容 Cc 跨接在第二級

### 5.3 增益計算

**第一級增益**：
$$A_1 = -g_{m1}(r_{o2} \| r_{o4})$$

**第二級增益**：
$$A_2 = -g_{m6}(r_{o6} \| r_{o7})$$

**總增益**：
$$A_v = A_1 \times A_2 = g_{m1}(r_{o2}\|r_{o4}) \times g_{m6}(r_{o6}\|r_{o7})$$

### 數值例題 10.6：兩級 OTA 增益

> **題目**：兩級 OTA 參數：
> 第一級：gm1 = 0.5mS，ro2 = 200kΩ，ro4 = 300kΩ
> 第二級：gm6 = 2mS，ro6 = 100kΩ，ro7 = 150kΩ
> 求總開迴路增益。
>
> **解答**：
> A1 = gm1 × (ro2 ∥ ro4) = 0.5m × (200k ∥ 300k) = 0.5m × 120k = 60
> A2 = gm6 × (ro6 ∥ ro7) = 2m × (100k ∥ 150k) = 2m × 60k = 120
> Av = 60 × 120 = **7200 = 77.1 dB**

### 數值例題 10.7：完整 OTA 設計

> **題目**：設計兩級 OTA，規格：
> - 增益 ≥ 70 dB，GBW ≥ 10 MHz
> - CL = 5 pF，VDD = 3.3V
> - kn' = 200μA/V²，kp' = 80μA/V²，Vthn = 0.5V，Vthp = -0.6V
> - λn = 0.05V⁻¹，λp = 0.04V⁻¹
>
> **設計步驟**：
>
> 步驟一：從 GBW 和 CL 求 gm1
> GBW = gm1/(2πCc)
> 選 Cc = 1.5pF（通常 Cc > CL × 0.22）
> gm1 = GBW × 2π × Cc = 10M × 2π × 1.5p = 94.2 μS ≈ **100 μA/V**
>
> 步驟二：求第一級偏壓電流
> 選 VOV1 = 0.2V
> gm1 = 2ID1/VOV1 → ID1 = gm1 × VOV1/2 = 100μ × 0.2/2 = 10μA
> ISS = 2ID1 = **20 μA**
>
> 步驟三：求 (W/L)1,2
> ID1 = ½kn'(W/L)1VOV1²
> 10μ = ½ × 200μ × (W/L)1 × 0.04
> (W/L)1 = 10μ/4μ = **2.5 → 取 3**
>
> 步驟四：設計第二級
> 選 ID6 = 100μA（較大以驅動負載）
> 選 VOV6 = 0.3V
> gm6 = 2 × 100μ/0.3 = **667 μA/V**
> (W/L)6 = 2ID6/(kn'VOV6²) = 200μ/(200μ × 0.09) = **11.1 → 取 12**
>
> 步驟五：驗證增益
> ro2 = 1/(0.05 × 10μ) = 2MΩ
> ro4 = 1/(0.04 × 10μ) = 2.5MΩ
> A1 = 100μ × (2M ∥ 2.5M) = 100μ × 1.11M = **111**
>
> ro6 = 1/(0.05 × 100μ) = 200kΩ
> ro7 = 1/(0.04 × 100μ) = 250kΩ
> A2 = 667μ × (200k ∥ 250k) = 667μ × 111k = **74.1**
>
> Av = 111 × 74.1 = **8225 = 78.3 dB** ≥ 70 dB ✓
>
> 步驟六：補償
> Cc = 1.5 pF（已選）
> 第二極點：fp2 ≈ gm6/(2πCL) = 667μ/(2π×5p) = 21.2 MHz
> GBW = gm1/(2πCc) = 100μ/(2π×1.5p) = 10.6 MHz
> PM ≈ 90° - arctan(10.6/21.2) = 90° - 26.6° = **63.4°** ✓

---

## 六、迴轉率（Slew Rate）

### 6.1 定義

$$SR = \frac{I_{tail}}{C_C} = \frac{I_{SS}}{C_C}$$

**物理意義**：大信號輸入時，輸出電壓變化的最大速率。

### 6.2 為什麼有迴轉率限制？

當大信號使差動對完全偏向一邊時，尾電流全部流入補償電容 Cc，充電速率被限制：

$$\frac{dV_{out}}{dt}\bigg|_{max} = \frac{I_{SS}}{C_C}$$

### 數值例題 10.8：迴轉率

> **題目**：兩級 OTA，ISS = 20μA，Cc = 1.5pF。
> 求迴轉率。若輸出要在 100ns 內變化 2V，夠嗎？
>
> **解答**：
> SR = ISS/Cc = 20μ/1.5p = 13.3 × 10⁶ V/s = **13.3 V/μs**
>
> 需要的速率 = 2V/100ns = 20 V/μs > 13.3 V/μs
> **不夠！** 需要增大 ISS 或減小 Cc。
>
> 若 ISS = 30μA：SR = 30μ/1.5p = 20 V/μs → 剛好夠 ✓

---

## 七、CMRR 和 PSRR

### 7.1 CMRR（Common Mode Rejection Ratio）

$$CMRR = \frac{A_{dm}}{A_{cm}}$$

OPA 的 CMRR 主要取決於差動輸入級。

### 7.2 PSRR（Power Supply Rejection Ratio）

$$PSRR = \frac{A_{dm}}{A_{PS}}$$

其中 APS 是電源變化引起的輸出變化。

**為什麼重要**：電源線上有雜訊（如數位切換雜訊），PSRR 越高，對電源雜訊的抑制越好。

### 數值例題 10.9：CMRR 和 PSRR

> **題目**：OPA 的 Adm = 80dB，Acm = 10dB，APS+ = 15dB。
> 求 CMRR 和 PSRR+。
>
> **解答**：
> CMRR = Adm - Acm = 80 - 10 = **70 dB**
> PSRR+ = Adm - APS+ = 80 - 15 = **65 dB**

---

## 八、設計規格與折衷（Design Trade-offs）

### 8.1 主要折衷

| 想要 | 需要 | 代價 |
|------|------|------|
| 高增益 | 大 gm、大 ro | 高功耗、大面積 |
| 高頻寬 | 小寄生電容、大 gm | 大功耗 |
| 大迴轉率 | 大 ISS | 大功耗 |
| 低失調 | 大元件、好匹配 | 大面積 |
| 低雜訊 | 大 gm、大元件 | 大功耗、大面積 |
| 大輸出擺幅 | 小 VOV | 小 gm（若功耗不變） |

### 8.2 gm/ID 設計方法論簡介

現代類比設計越來越多使用 **gm/ID 方法論**：

$$\frac{g_m}{I_D} = \frac{2}{V_{OV}} \quad (\text{強反轉})$$

- 大 gm/ID（弱反轉，VOV 小）：功率效率高，但速度慢
- 小 gm/ID（強反轉，VOV 大）：速度快，但功率效率低

### 數值例題 10.10：設計折衷

> **題目**：需要 gm = 1mS。比較兩種設計：
> (a) VOV = 0.2V（強反轉）
> (b) VOV = 0.05V（接近弱反轉）
>
> **解答**：
> (a) ID = gm × VOV/2 = 1m × 0.2/2 = **100 μA**
>     gm/ID = 2/0.2 = 10 V⁻¹
>     (W/L) = 2ID/(kn'VOV²) = 200μ/(200μ×0.04) = 25
>
> (b) ID = 1m × 0.05/2 = **25 μA**（省 4 倍功率）
>     gm/ID = 2/0.05 = 40 V⁻¹
>     (W/L) = 50μ/(200μ×0.0025) = 100（面積大 4 倍）
>     fT 較低（速度慢）
>
> **結論**：弱反轉省功率但犧牲面積和速度——設計就是不斷折衷。

---

## 關鍵術語表

| 中文 | 英文 | 白話解釋 | 例子 |
|------|------|---------|------|
| CMOS | Complementary MOS | NMOS+PMOS 互補技術 | 所有現代IC |
| 反相器 | Inverter | 最基本的數位閘，0→1，1→0 | NOT 閘 |
| VTC | Voltage Transfer Characteristic | 輸出電壓對輸入電壓的靜態曲線 | 判斷雜訊邊限 |
| 開關閾值 | Switching Threshold (VM) | Vin = Vout 的點 | 理想為 VDD/2 |
| 雜訊邊限 | Noise Margin (NM) | 能容忍的最大雜訊電壓 | NMH, NML |
| 傳播延遲 | Propagation Delay (tpd) | 輸入變化到輸出穩定的時間 | 越小越快 |
| 動態功耗 | Dynamic Power | 切換時消耗的功率 | CL·VDD²·f |
| NAND 閘 | NAND Gate | 反及閘，最常用的基本閘 | NMOS串聯+PMOS並聯 |
| NOR 閘 | NOR Gate | 反或閘 | NMOS並聯+PMOS串聯 |
| 傳輸閘 | Transmission Gate | NMOS+PMOS並聯的雙向開關 | 完美傳遞0到VDD |
| OTA | Operational Transconductance Amplifier | 跨導運算放大器 | IC內部OPA |
| 迴轉率 | Slew Rate (SR) | 輸出電壓的最大變化速率 | ISS/Cc |
| PSRR | Power Supply Rejection Ratio | 抑制電源雜訊的能力 | 越大越好 |
| 米勒補償 | Miller Compensation | 跨接電容穩定多級放大器 | Cc |

---

## 題型鑑別

| 看到什麼條件 | 用什麼方法 |
|-------------|-----------|
| 「CMOS 反相器 VTC」 | 分五個區域分析兩管狀態 |
| 「對稱反相器、求 W/L」 | kn'(W/L)n = kp'(W/L)p |
| 「雜訊邊限」 | NMH = VOH - VIH，NML = VIL - VOL |
| 「傳播延遲」 | tpd = 0.69 × Req × CL |
| 「動態功耗」 | P = CL × VDD² × f |
| 「設計 NAND/NOR」 | 串聯↔並聯互補，NMOS串聯要加倍W |
| 「OTA 增益」 | A = gm1(ro∥ro) × gm6(ro∥ro) |
| 「迴轉率」 | SR = ISS/Cc |
| 「GBW 和補償」 | GBW = gm1/(2πCc)，PM 要 > 45° |

---

## ✅ 自我檢測

### 概念題

1. CMOS 反相器的靜態功耗為什麼接近零？
2. 為什麼 NAND 閘比 NOR 閘更常用？
3. 傳輸閘為什麼需要 NMOS 和 PMOS 並聯？
4. 兩級 OTA 中，米勒補償電容 Cc 的作用是什麼？
5. 迴轉率和什麼參數有關？如何提高迴轉率？

<details>
<summary>點擊查看答案</summary>

1. **因為在穩態下，NMOS 和 PMOS 必有一個截止，不存在從 VDD 到 GND 的直流通路。** 沒有電流流過就沒有功率消耗。功率只在切換瞬間產生（動態功耗）。

2. **因為 NAND 閘的 PUN 是 PMOS 並聯（較快），而 NOR 閘的 PUN 是 PMOS 串聯（最慢）。** 由於 PMOS 的遷移率本來就低，串聯更使情況惡化。此外 NAND 的電晶體尺寸通常更小。

3. **因為單獨的 NMOS 無法完整傳遞高電位（接近 VDD 時 VGS 不足），PMOS 無法完整傳遞低電位。** 並聯後互補——NMOS 負責傳低電位，PMOS 負責傳高電位，整個 0~VDD 範圍都能完美傳遞。

4. **Cc 利用米勒效應實現極點分離（pole splitting）。** 使第一級的等效電容大幅增加（主極點降低），同時將第二級極點推高。這確保在增益交越頻率處只有一個極點主導，相位邊限充足，系統穩定。

5. **SR = ISS/Cc，與尾電流源電流和補償電容有關。** 提高迴轉率的方法：增大 ISS（增加功耗）或減小 Cc（但可能影響穩定性）。另一種方法是使用 Class-AB 輸出級。

</details>

### 計算題

6. CMOS 反相器，kn'=200μA/V²，kp'=80μA/V²，(W/L)n=1。
   要求 VM = VDD/2，求 (W/L)p。

7. CL = 30fF，Req,n = 8kΩ，Req,p = 20kΩ。求 tpd。

8. VDD = 1.2V，CL = 50fF，f = 2GHz。求單個反相器的動態功耗。

9. 兩級 OTA，gm1 = 200μS，ro1 = ro2 = 500kΩ，
   gm6 = 1mS，ro6 = ro7 = 200kΩ。求增益。

10. ISS = 40μA，Cc = 2pF。求 SR 和 GBW（gm1 = 200μS）。

<details>
<summary>點擊查看答案</summary>

6. kp'(W/L)p = kn'(W/L)n → 80×(W/L)p = 200×1
   (W/L)p = **2.5**

7. tpHL = 0.69 × 8k × 30f = 165.6 ps
   tpLH = 0.69 × 20k × 30f = 414 ps
   tpd = (165.6 + 414)/2 = **290 ps**

8. P = CL × VDD² × f = 50f × 1.44 × 2G = 50×10⁻¹⁵ × 2.88×10⁹ = **144 μW**

9. A1 = gm1(ro1∥ro2) = 200μ × (500k∥500k) = 200μ × 250k = 50
   A2 = gm6(ro6∥ro7) = 1m × (200k∥200k) = 1m × 100k = 100
   Av = 50 × 100 = **5000 = 74 dB**

10. SR = ISS/Cc = 40μ/2p = 20 × 10⁶ = **20 V/μs**
    GBW = gm1/(2πCc) = 200μ/(2π×2p) = 200μ/12.57p = **15.9 MHz**

</details>

---

## 總結：電子學十章完整知識架構

```
半導體基礎(Ch1) → 二極體(Ch2) → BJT(Ch3-4) → MOSFET(Ch5-6)
                                        ↓               ↓
                                  差動放大器(Ch7) ←──────┘
                                        ↓
                                  頻率響應(Ch8)
                                        ↓
                                  回授與穩定性(Ch9)
                                        ↓
                              CMOS數位 + OPA設計(Ch10)
```

恭喜你完成了電子學的完整學習旅程！從最基礎的半導體物理出發，經過二極體、電晶體（BJT 和 MOSFET）的直流和小信號分析，到差動放大器、頻率響應、回授理論，最後整合到 CMOS 數位電路和運算放大器設計。

> **下一步建議**：回頭做更多練習題，特別是 MOSFET 相關章節（業界面試重點）和回授/穩定性（考試常考難題）。
