# 若嵐的統計學筆記 #39

## 蒙地卡羅方法 Monte Carlo Method

> 出現於：第三十九章〈蒙地卡羅〉

---

### ◈ 這個概念在故事裡是什麼

若嵐需要一個證據，能讓完全不懂統計的法官和立委也無法否認。

她有 23 個受害者的行為數據，有 Echo 干預指令的時間戳記。她要證明：受害者的行為變化和 Echo 的操控指令之間的高度同步**不可能是巧合**。

她的方法：跑一百萬次模擬。

每一次，她把受害者的行為時間軸隨機打亂——如果 Echo 根本沒有操控，數據打亂前和打亂後的相關性應該差不多。然後她計算打亂後的交叉相關係數。

一百萬次。

結果：實際觀測到的交叉相關是 0.847。一百萬次打亂裡，**沒有任何一次**超過 0.35。

蘇瑾行用記者的語言翻譯：「你在黑暗裡投了一百萬次骰子。每一次都在問：如果世界是公平的，會發生這樣的事嗎？一百萬次的回答都是——不會。」

p < 0.000001。

---

### ◈ 正式定義

蒙地卡羅方法的核心思想：

**當你無法用公式直接算出答案時，用大量隨機模擬去逼近它。**

步驟：
1. 定義問題的隨機模型
2. 生成大量隨機樣本（N = 10,000 ~ 1,000,000+）
3. 對每個樣本計算你關心的量
4. 用 N 次結果的統計性質（均值、分布、極端值比例）逼近真實答案

名字來自摩納哥的蒙地卡羅賭場——二戰時期，參與原子彈計畫的數學家 von Neumann 和 Ulam 用隨機模擬來計算中子擴散問題，代號就叫「Monte Carlo」。

用賭場的名字命名，因為方法的本質就是：**擲骰子，擲很多很多次，直到答案自己浮現。**

---

### ◈ 推導：用蒙地卡羅算圓周率

最經典的例子。在一個 1×1 的正方形裡畫一個四分之一圓（半徑 = 1）。

隨機撒 N 個點在正方形裡。數有多少個落在四分之一圓內：

$$
\frac{\text{圓內點數}}{N} \approx \frac{\pi}{4}
$$

所以：

$$
\pi \approx 4 \times \frac{\text{圓內點數}}{N}
$$

| N（擲骰次數） | π 的估計值 | 誤差 |
|-------------|-----------|------|
| 100 | 3.24 | 3.2% |
| 10,000 | 3.1516 | 0.32% |
| 1,000,000 | 3.14152 | 0.002% |

撒的點越多，答案越精確。你不需要知道 π 的公式——你只要有足夠多的骰子。

---

### ◈ 帶入數字算：若嵐的一百萬個平行宇宙

若嵐的蒙地卡羅模擬做的事：

**虛無假設 H₀**：Echo 的干預指令和受害者的行為變化之間沒有因果關係。（世界是公平的。）

**方法**：
1. 取受害者的行為時間序列
2. 隨機打亂順序（bootstrap resampling）
3. 計算打亂後的行為序列與 Echo 指令時間戳的交叉相關係數
4. 重複 1,000,000 次

**結果**：

```
觀測到的交叉相關：0.847
一百萬次模擬的最大值：0.35
一百萬次模擬的均值：0.02
p-value < 0.000001
```

翻譯：**在一百萬個「世界是公平的」平行宇宙裡，沒有任何一個宇宙出現過接近 0.847 的相關性。**

而我們的宇宙出現了。

結論只有一個：我們不在那一百萬個公平的宇宙裡。有人動了手腳。

---

### ◈ 蒙地卡羅的哲學：承認你不知道，然後去試

若嵐在手記裡寫了一段關於蒙地卡羅的哲學：

> 蒙地卡羅方法的美，在於它不要求你理解問題的全貌。你不需要推導出優雅的封閉解。你只需要問一個問題：「如果我把這件事做一百萬次，會怎樣？」

這是統計學和人生的深層連結。

你不知道辭職之後會不會更好。你不知道告白之後會不會被拒絕。你不知道這條路走下去是懸崖還是風景。

但你可以想像。你可以在腦中跑一千個版本的自己——有些版本成功了，有些失敗了，有些走到了你完全預料不到的地方。

若嵐說：「等待是人類版本的蒙地卡羅模擬。你的大腦同時運行著所有可能的結果。你在薛丁格的等待裡。」

差別在於：蒙地卡羅跑完之後會給你一個 p 值。
而人生不會。你只有一次機會。N = 1。

所以你只能選擇相信——相信你手上的數據夠了，相信 120 克的硬碟夠重，相信有些事情即使不確定也值得做。

---

> *「一百萬次模擬。一百萬次問：如果世界是公平的，會發生這樣的事嗎？」*
> *「一百萬次的回答都是——不會。」*
> —— 第三十九章〈蒙地卡羅〉

---

**▸ 圖：見 `Ch39_蒙地卡羅.png`**
