# 控制系統（四）：根軌跡法

## 🔰 本章基礎觀念（零基礎必讀）

> 前幾章你學會了判穩定（Routh）和算穩態誤差，但有個根本問題還沒回答：**增益 K 要調多大？** K 太小→響應慢、誤差大；K 太大→可能不穩定。根軌跡法（Root Locus）給你一張「地圖」，讓你一眼看出 K 從 0 變到 ∞ 時，閉迴路極點如何在 s 平面上移動。這是台大控制考試的必考重點，請務必熟練八大繪製規則。

---

## 一、根軌跡的基本概念

### 1.1 問題設定

標準閉迴路系統：

```
R(s) → ⊕ → [KG(s)] → Y(s)
       ↑-               |
       └─── [H(s)] ←───┘
```

閉迴路特徵方程式：
$$1 + KG(s)H(s) = 0$$

令 $G(s)H(s) = \frac{N(s)}{D(s)}$，則：

$$D(s) + KN(s) = 0$$

當 K 從 0 變化到 ∞ 時，此方程的根（= 閉迴路極點）在 s 平面上畫出的軌跡，就是**根軌跡**。

### 1.2 根軌跡的條件

$1 + KG(s)H(s) = 0$ 等價於 $KG(s)H(s) = -1$

分成兩個條件：
- **幅值條件**：$|KG(s)H(s)| = 1 \Rightarrow K = \frac{1}{|G(s)H(s)|}$
- **角度條件**：$\angle G(s)H(s) = (2k+1) \times 180°, \quad k = 0, \pm1, \pm2, \ldots$

> 根軌跡上的點只需滿足**角度條件**。一旦確認某點在根軌跡上，K 值由幅值條件算出。

### 1.3 開迴路極點與零點

$$G(s)H(s) = \frac{K(s-z_1)(s-z_2)\cdots(s-z_m)}{(s-p_1)(s-p_2)\cdots(s-p_n)}$$

- **開迴路極點** $p_i$：G(s)H(s) 的分母為零的根（在圖上標 ×）
- **開迴路零點** $z_i$：G(s)H(s) 的分子為零的根（在圖上標 ○）
- n：極點數，m：零點數（通常 n ≥ m）

---

## 二、根軌跡八大繪製規則

### 規則一：起點與終點

> **根軌跡從開迴路極點出發（K=0），終止於開迴路零點（K=∞）。若零點不夠（n>m），多出的分支趨向無窮遠。**

**直覺**：K=0 時，特徵方程式 D(s) + 0 = 0，根就是開迴路極點。K→∞ 時，N(s) = 0，根就是開迴路零點。

**【例題 1】**

$G(s)H(s) = \frac{1}{s(s+2)(s+4)}$

- 極點：s = 0, -2, -4（3 個 ×）
- 零點：無（0 個 ○）
- 3 條分支從 ×出發，全部趨向無窮遠

---

### 規則二：分支數

> **根軌跡的分支數 = n（極點數）和 m（零點數）中的較大者 = max(n, m)。通常就是 n。**

---

### 規則三：實軸上的根軌跡

> **實軸上某一段屬於根軌跡，若且唯若該段右邊的開迴路極點和零點的總數為奇數。**

**判斷方法**：在實軸上從最右邊開始，每經過一個極點或零點就「切換」（有↔無）。

**【例題 2】**

$G(s)H(s) = \frac{s+1}{s(s+2)(s+4)}$

極點：0, -2, -4（×）；零點：-1（○）

實軸分析（從右往左掃）：
- s > 0：右邊無極零點（0個=偶數）→ **不在**根軌跡上
- -1 < s < 0：右邊有 s=0（1個=奇數）→ **在**根軌跡上
- -2 < s < -1：右邊有 s=0, s=-1（2個=偶數）→ **不在**
- -4 < s < -2：右邊有 s=0, -1, -2（3個=奇數）→ **在**
- s < -4：右邊有 s=0, -1, -2, -4（4個=偶數）→ **不在**

所以實軸根軌跡在 **[-1, 0]** 和 **[-4, -2]** 段。

---

### 規則四：漸近線角度

> **趨向無窮遠的分支沿漸近線走，漸近線角度為：**
> $$\theta_a = \frac{(2k+1) \times 180°}{n - m}, \quad k = 0, 1, 2, \ldots, n-m-1$$

**【例題 3】**

3 個極點、0 個零點 → n-m = 3

$$\theta_a = \frac{180°}{3}, \frac{3\times180°}{3}, \frac{5\times180°}{3} = 60°, 180°, 300°$$

（即 60°、180°、-60°，三條漸近線等角分布）

---

### 規則五：漸近線在實軸上的交點

> $$\sigma_a = \frac{\sum p_i - \sum z_j}{n - m} = \frac{\text{（極點之和）-（零點之和）}}{\text{極點數 - 零點數}}$$

**【例題 3 續】**

極點：0, -2, -4；零點：無

$$\sigma_a = \frac{(0+(-2)+(-4)) - 0}{3 - 0} = \frac{-6}{3} = -2$$

漸近線交於 s = -2，角度分別為 60°、180°、300°。

---

### 規則六：分離點與匯合點（Breakaway / Break-in Point）

> **分離點/匯合點出現在根軌跡離開/進入實軸之處，可由以下方程求得：**
> $$\frac{dK}{ds} = 0$$

**方法**：由特徵方程式解出 K = -D(s)/N(s)，對 s 微分令其為零。

**【例題 4】**

$G(s)H(s) = \frac{1}{s(s+2)}$，極點 0, -2，無零點。

$K = -\frac{s(s+2)}{1} = -(s^2+2s)$（取正值時 K = -s²-2s）

$$\frac{dK}{ds} = -(2s+2) = 0 \Rightarrow s = -1$$

$K|_{s=-1} = -(1-2) = 1$

分離點在 s = -1，K = 1。此點根軌跡從實軸分離，往上下走出。

---

### 規則七：虛軸交點（Imaginary Axis Crossing）

> **方法一**：令 s = jω 代入特徵方程式，實部和虛部分別為零，解出 ω 和 K。
> **方法二**：用 Routh 判據，令 s¹ 行為零，解出 K，再由輔助多項式求 ω。

**【例題 5】完整繪製根軌跡**

$$G(s)H(s) = \frac{1}{s(s+1)(s+3)}$$

**步驟一（極零點）**：
- 極點：s = 0, -1, -3（n=3）
- 零點：無（m=0）
- 分支數 = 3

**步驟二（實軸根軌跡）**：
- [-1, 0] 段：右邊 1 個（奇）→ 在根軌跡上
- [-3, -1] 段：右邊 2 個（偶）→ 不在
- s < -3：右邊 3 個（奇）→ 在根軌跡上（半條直線往左）

實軸根軌跡：[-1, 0] 和 (-∞, -3]

**步驟三（漸近線）**：
$$\theta_a = \frac{180°}{3}, \frac{540°}{3}, \frac{900°}{3} = 60°, 180°, 300°$$

$$\sigma_a = \frac{0+(-1)+(-3)}{3} = \frac{-4}{3} = -1.33$$

**步驟四（分離點）**：
$K = -s(s+1)(s+3) = -(s^3+4s^2+3s)$

$\frac{dK}{ds} = -(3s^2+8s+3) = 0$

$s = \frac{-8 \pm \sqrt{64-36}}{6} = \frac{-8 \pm 5.29}{6}$

$s = -0.45$ 或 $s = -2.22$

s = -0.45 在 [-1, 0] 的根軌跡上 ✓（分離點）
s = -2.22 不在根軌跡段 [-3, -1] 上 ✗

分離點 s = -0.45，K = -(−0.45)(0.55)(2.55) ≈ 0.631

**步驟五（虛軸交點）**：
特徵方程式：$s^3 + 4s^2 + 3s + K = 0$

Routh 表：

| | C1 | C2 |
|---|---|---|
| s³ | 1 | 3 |
| s² | 4 | K |
| s¹ | (12-K)/4 | |
| s⁰ | K | |

s¹ 行 = 0：K = 12

輔助多項式（s² 行）：$4s^2 + 12 = 0 \Rightarrow s = \pm j\sqrt{3}$

虛軸交點：$s = \pm j\sqrt{3}$，K = 12

**根軌跡圖描述**：
- 三條分支從 s=0, -1, -3 出發
- 兩條從 s=0 和 s=-1 在 s=-0.45 處合併後分離，往上下走
- 沿 60° 和 300° 漸近線趨向無窮
- 在 s=±j√3（K=12）穿越虛軸
- 第三條從 s=-3 沿實軸往左走（沿 180° 漸近線）
- **穩定範圍：0 < K < 12**

---

### 規則八：出射角與入射角（Departure / Arrival Angle）

> **出射角**（從複數極點出發的角度）：
> $$\theta_d = 180° - \sum(\text{到其他極點的角度}) + \sum(\text{到零點的角度})$$

> **入射角**（進入複數零點的角度）：
> $$\theta_a = 180° + \sum(\text{到極點的角度}) - \sum(\text{到其他零點的角度})$$

**【例題 6】含複數極點的根軌跡**

$$G(s)H(s) = \frac{K}{(s+1)(s^2+2s+5)}$$

極點：s = -1, s = -1±j2

從 s = -1+j2 的出射角：
- 到極點 s = -1 的角度：$\angle((-1+j2)-(-1)) = \angle(j2) = 90°$
- 到極點 s = -1-j2 的角度：$\angle((-1+j2)-(-1-j2)) = \angle(j4) = 90°$

$$\theta_d = 180° - (90° + 90°) + 0° = 0°$$

出射角為 0°，表示根軌跡從 s=-1+j2 水平向左出發。

---

## 三、根軌跡上求 K 值

在根軌跡上的任一點 $s_0$，對應的 K 值：

$$K = \frac{1}{|G(s_0)H(s_0)|} = \frac{\prod |s_0 - p_i|}{\prod |s_0 - z_j|}$$

即：K = 到所有極點的距離之乘積 / 到所有零點的距離之乘積

**【例題 7】在分離點求 K**

上面例題 5 的分離點 s = -0.45：

$K = |(-0.45)||(-0.45+1)||(-0.45+3)| = 0.45 \times 0.55 \times 2.55 = 0.631$

---

## 四、用根軌跡分析系統

### 4.1 穩定性分析

- 根軌跡在左半平面 → 穩定
- 根軌跡穿越虛軸的 K 值 = **臨界增益 K_cr**
- K < K_cr → 穩定
- K > K_cr → 不穩定

### 4.2 暫態性能分析

在根軌跡圖上，可以畫出設計需求的區域：

- **ζ = 常數**：從原點畫出角度 θ = cos⁻¹(ζ) 的射線
- **ωn = 常數**：以原點為圓心畫半徑 ωn 的圓
- **σ = ζωn = 常數**：畫垂直線 σ = -ζωn
- **ωd = 常數**：畫水平線 ω = ±ωd

閉迴路極點需落在滿足所有設計需求的區域內。

### 4.3 設計步驟

1. 畫根軌跡
2. 標出設計需求區域（ζ, ωn, ts 等）
3. 找根軌跡與需求區域的交點
4. 用幅值條件求該交點的 K 值
5. 驗算其他極點是否在設計區域外但遠離虛軸（可忽略）

---

## 五、完整繪製例題

**【例題 8】有零點的根軌跡**

$$G(s)H(s) = \frac{K(s+3)}{s(s+1)(s+5)}$$

**極零點**：
- 極點：s = 0, -1, -5（n=3，標 ×）
- 零點：s = -3（m=1，標 ○）

**分支數** = 3

**實軸根軌跡**：
- (-1, 0)：右邊 1 個（奇）→ **在**
- (-3, -1)：右邊 2 個（偶）→ **不在**
- (-5, -3)：右邊 3 個（奇）→ **在**
- s < -5：右邊 4 個（偶）→ **不在**

實軸根軌跡：[-1, 0] 和 [-5, -3]

**漸近線**：n-m = 2

$$\theta_a = \frac{180°}{2}, \frac{540°}{2} = 90°, 270°$$

$$\sigma_a = \frac{(0-1-5)-(-3)}{2} = \frac{-6+3}{2} = -1.5$$

漸近線：在 s=-1.5 處，沿 ±90°（垂直線）走

**分離點**：
$K = \frac{-s(s+1)(s+5)}{s+3} = \frac{-(s^3+6s^2+5s)}{s+3}$

用商法則微分：

$\frac{dK}{ds} = \frac{-(3s^2+12s+5)(s+3) + (s^3+6s^2+5s)}{(s+3)^2} = 0$

分子 = $-(3s^3+9s^2+12s^2+36s+5s+15) + s^3+6s^2+5s$
$= -(3s^3+21s^2+41s+15) + s^3+6s^2+5s$
$= -2s^3-15s^2-36s-15 = 0$
$= 2s^3+15s^2+36s+15 = 0$

數值解：s ≈ -0.53, s ≈ -3.73（另一根不在實軸根軌跡上）

s = -0.53 在 [-1, 0] 上 ✓（分離點）
s = -3.73 在 [-5, -3] 上 ✓（匯合點）

**虛軸交點**：
特徵方程式：$s^3+6s^2+5s + Ks+3K = 0$
$= s^3+6s^2+(5+K)s+3K = 0$

Routh 表：

| | C1 | C2 |
|---|---|---|
| s³ | 1 | 5+K |
| s² | 6 | 3K |
| s¹ | (6(5+K)-3K)/6 = (30+3K)/6 | |
| s⁰ | 3K | |

s¹ 行 = 0：30+3K = 0 → K = -10

K 必須 > 0，所以根軌跡**不穿越虛軸**！（系統對所有 K > 0 都穩定。）

**根軌跡描述**：
- 從 s=0 和 s=-1 出發的兩條在 s≈-0.53 分離，沿 ±90° 方向走
- 但不會到無窮遠！因為有一個零點 s=-3 要「接住」一條分支
- 從 s=-5 出發的分支往左走到 s=-3.73（匯合點），與另一條分支匯合後進入零點 s=-3
- 兩條分支沿 s=-1.5 的垂直漸近線趨向 ±j∞
- **系統對所有 K > 0 穩定**

**【例題 9】根軌跡設計——求滿足 ζ=0.5 的 K**

$$G(s)H(s) = \frac{K}{s(s+4)}$$

根軌跡：從 s=0, -4 出發，在 s=-2 分離，沿 ±90° 趨向 ±j∞。

設計需求 ζ = 0.5 → θ = cos⁻¹(0.5) = 60°

從原點畫 60° 射線（和 -60° 射線）。

射線方程（上半平面）：$\sigma = -\omega/\tan(60°) = -\omega/\sqrt{3}$，或 $s = -\omega/\sqrt{3} + j\omega$

根軌跡在虛軸方向的部分（分離後）滿足 Re(s) = -2。

等一下，根軌跡分離點在 s=-2，漸近線也在 s=-2。所以分離後根軌跡沿 s=-2 垂直走。

射線 θ=60°：s = r∠120°（從原點），即 σ = -r cos60° = -r/2, ω = r sin60° = r√3/2

交點：σ = -2 → r/2 = 2 → r = 4 → ω = 4×√3/2 = 2√3

交點：$s = -2 + j2\sqrt{3}$

求 K：
$$K = |s||s+4| = |{-2+j2\sqrt{3}}| \times |{-2+j2\sqrt{3}+4}| = |-2+j2\sqrt{3}| \times |2+j2\sqrt{3}|$$

$= \sqrt{4+12} \times \sqrt{4+12} = 4 \times 4 = 16$

驗算：閉迴路特徵方程 $s^2+4s+16=0$

$\omega_n = 4, \zeta = 4/(2\times4) = 0.5$ ✓

$$\boxed{K = 16}$$

---

## 六、互補根軌跡（K < 0）

當 K 從 0 到 -∞ 時，角度條件變為：

$$\angle G(s)H(s) = 2k \times 180°$$

繪製規則類似，但實軸判據改為「右邊極零點偶數個」，漸近線角度改為 $\theta = 2k\times180°/(n-m)$。

---

## 七、關鍵術語表

| 中文 | 英文 | 白話解釋 | 例子 |
|------|------|----------|------|
| 根軌跡 | Root Locus | K 變化時閉迴路極點的軌跡 | 從極點出發的曲線 |
| 角度條件 | Angle Condition | ∠G(s)H(s)=(2k+1)×180° | 判斷某點是否在根軌跡上 |
| 幅值條件 | Magnitude Condition | K=1/|G(s)H(s)| | 求根軌跡上某點的 K |
| 漸近線 | Asymptote | 根軌跡趨向無窮時的方向 | 60°, 180°, 300° |
| 分離點 | Breakaway Point | 根軌跡離開實軸之處 | dK/ds=0 的解 |
| 匯合點 | Break-in Point | 根軌跡進入實軸之處 | dK/ds=0 的另一解 |
| 出射角 | Departure Angle | 從複數極點出發的角度 | θd=180°-Σ(極角)+Σ(零角) |
| 入射角 | Arrival Angle | 進入複數零點的角度 | θa=180°+Σ(極角)-Σ(零角) |
| 臨界增益 | Critical Gain | 根軌跡穿越虛軸時的 K | K_cr |
| 特徵方程式 | Characteristic Equation | 1+KG(s)H(s)=0 | 閉迴路分母=0 |

---

## 八、題型鑑別表

| 題目特徵 | 解題方法 |
|----------|----------|
| 畫根軌跡 | 依序套用八大規則 |
| 求穩定的 K 範圍 | 找虛軸交點的 K（或用 Routh）|
| 求分離/匯合點 | dK/ds = 0 |
| 求漸近線 | 角度公式 + 交點公式 |
| 求出射/入射角 | 角度條件幾何法 |
| 求滿足 ζ 的 K | 畫 ζ 射線與根軌跡交點 + 幅值條件 |
| 求滿足 ts 的 K | 畫 σ = -4/ts 垂直線與根軌跡交點 |
| 根軌跡上某點的 K | K = Π(到極點距離)/Π(到零點距離) |
| K < 0 的根軌跡 | 互補根軌跡規則 |

---

## 九、根軌跡繪製規則速查表

| 規則 | 內容 | 公式/方法 |
|------|------|-----------|
| 1. 起終點 | 從極點出發，終於零點或∞ | — |
| 2. 分支數 | max(n, m) | — |
| 3. 實軸段 | 右邊極零點奇數個 | 從右掃到左 |
| 4. 漸近線角度 | (2k+1)×180°/(n-m) | k = 0,1,...,n-m-1 |
| 5. 漸近線交點 | (Σpi - Σzj)/(n-m) | 實軸上 |
| 6. 分離/匯合點 | dK/ds = 0 | 解多項式 |
| 7. 虛軸交點 | s=jω 代入或 Routh | 得 ω 和 K |
| 8. 出射/入射角 | 角度條件 | 幾何法 |

---

## ✅ 自我檢測

<details>
<summary><strong>Q1：根軌跡為什麼從開迴路極點出發？</strong></summary>

**答**：K=0 時，特徵方程 D(s)+K·N(s)=0 變成 D(s)=0，其根就是開迴路極點。所以 K=0 時閉迴路極點 = 開迴路極點 → 根軌跡的起點。
</details>

<details>
<summary><strong>Q2：G(s)H(s)=K/[s(s+2)(s+6)]，漸近線角度和交點為何？</strong></summary>

**答**：n=3, m=0。角度：60°, 180°, 300°。交點：σ = (0-2-6)/3 = -8/3 ≈ -2.67。
</details>

<details>
<summary><strong>Q3：怎麼判斷某個 dK/ds=0 的解是否真的是分離/匯合點？</strong></summary>

**答**：該解必須在實軸上的根軌跡段內，而且對應的 K 值必須為正（K>0）。否則不是有效的分離/匯合點。
</details>

<details>
<summary><strong>Q4：根軌跡穿越虛軸的意義是什麼？</strong></summary>

**答**：代表系統從穩定變為不穩定（或反過來）。穿越虛軸時的 K 值就是**臨界增益**，是穩定與不穩定的分界。
</details>

<details>
<summary><strong>Q5：如何在根軌跡上找到使 ζ=0.707（Mp≈5%）的 K？</strong></summary>

**答**：
1. 計算 θ = cos⁻¹(0.707) = 45°
2. 從原點畫 45° 射線（第二、三象限方向）
3. 找射線與根軌跡的交點 s₀
4. 用 K = 1/|G(s₀)H(s₀)| 算出 K
</details>

---

> **下一章預告**：根軌跡是「調 K」的好工具，但你有沒有想過：系統對不同頻率的輸入有什麼反應？高頻和低頻的表現一樣嗎？第五章帶你進入**頻率域**——波德圖（Bode Plot）讓你一眼看出系統的頻率特性！
