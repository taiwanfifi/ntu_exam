# 信號與系統 第五章：拉普拉斯轉換

---

## 🔰 本章基礎觀念（零基礎必讀）

### 為什麼需要拉普拉斯轉換？

傅立葉轉換很強大，但有一個限制：信號必須「夠乖」——絕對可積，也就是能量有限。

但很多重要情況下：
- **增長的指數信號** e^(2t)u(t) 的傅立葉轉換不存在
- **不穩定系統** 的分析需要處理發散信號
- 我們想直接從**微分方程**求解系統響應

> **拉普拉斯轉換 = 傅立葉轉換的「加強版」**

核心想法：先給信號乘一個衰減因子 e^(-σt) 讓它「變乖」，然後再做傅立葉轉換。

$$\underbrace{x(t)}_{\text{可能不收斂}} \cdot \underbrace{e^{-\sigma t}}_{\text{衰減因子}} \to \text{可能收斂了！}$$

### 白話理解 s = σ + jω

- 傅立葉轉換的變數是 jω（純虛數，只描述頻率）
- 拉普拉斯轉換的變數是 s = σ + jω（複數）
  - σ = 實部：控制「衰減/增長」
  - ω = 虛部：控制「振盪頻率」

> 當 σ = 0 時，拉普拉斯轉換就退化成傅立葉轉換！

---

## 關鍵術語表

| 中文 | 英文 | 白話解釋 | 例子 |
|------|------|----------|------|
| 拉普拉斯轉換 | Laplace Transform | 把時域信號轉到 s 域的工具 | x(t) → X(s) |
| 收斂區域 | Region of Convergence (ROC) | s 平面上積分收斂的區域 | Re(s) > -2 |
| 轉移函數 | Transfer function H(s) | 系統輸入輸出的 s 域比值 | Y(s)/X(s) |
| 極點 | Pole | 使 H(s) 趨向無限大的 s 值 | 分母 = 0 的根 |
| 零點 | Zero | 使 H(s) = 0 的 s 值 | 分子 = 0 的根 |
| 極零圖 | Pole-Zero plot | 在 s 平面標出極零點位置 | × 表極點，○ 表零點 |
| 部分分式 | Partial fraction expansion | 把複雜分式拆成簡單分式的和 | 反拉氏的核心手法 |
| 初值定理 | Initial value theorem | 由 X(s) 直接求 x(0⁺) | |
| 終值定理 | Final value theorem | 由 X(s) 直接求 x(∞) | |
| 單邊拉氏 | Unilateral Laplace | 積分下限為 0⁻ 的拉普拉斯轉換 | 適合初值問題 |
| 雙邊拉氏 | Bilateral Laplace | 積分範圍為 -∞ 到 ∞ | 一般定義 |

---

## 一、拉普拉斯轉換的定義

### 1.1 雙邊拉普拉斯轉換（Bilateral）

$$X(s) = \int_{-\infty}^{\infty} x(t) \, e^{-st} \, dt, \quad s = \sigma + j\omega$$

### 1.2 反拉普拉斯轉換

$$x(t) = \frac{1}{2\pi j} \int_{\sigma - j\infty}^{\sigma + j\infty} X(s) \, e^{st} \, ds$$

> 反轉換的積分是沿 s 平面上一條垂直線進行。實際上我們幾乎不用這個積分公式，而是用**部分分式展開 + 查表**。

### 1.3 單邊拉普拉斯轉換（Unilateral）

$$X(s) = \int_{0^-}^{\infty} x(t) \, e^{-st} \, dt$$

> 工程上最常用的是單邊版本，因為大多數因果系統的信號在 t < 0 時為零。

---

## 二、收斂區域（ROC）

### 2.1 為什麼 ROC 很重要？

同一個 X(s) = 1/(s+1) 可以對應不同的時域信號：
- 如果 ROC 是 Re(s) > -1 → x(t) = e^(-t)u(t)（右邊信號，因果）
- 如果 ROC 是 Re(s) < -1 → x(t) = -e^(-t)u(-t)（左邊信號，非因果）

> **沒有 ROC，X(s) 的反轉換就不唯一！** 所以寫拉氏轉換一定要附 ROC。

### 2.2 ROC 的基本規則

| 信號類型 | ROC 形狀 |
|----------|----------|
| **右邊信號** x(t) = 0 for t < 0 | ROC 在最右邊極點的右邊（半平面）|
| **左邊信號** x(t) = 0 for t > 0 | ROC 在最左邊極點的左邊（半平面）|
| **雙邊信號** | ROC 是兩個極點之間的帶狀區域 |
| **有限持續信號** | ROC 是整個 s 平面（可能除了某些點）|

### 2.3 因果 + 穩定的 ROC 條件

| 性質 | ROC 條件 |
|------|----------|
| **因果** | ROC 在最右邊極點的右邊（右半平面類型）|
| **穩定** | ROC 包含 jω 軸 |
| **因果且穩定** | 所有極點都在 jω 軸的左邊（左半平面）|

> **超重要結論**：因果且穩定的系統 ↔ 所有極點都在左半平面 (Re(s) < 0)。

### 數值例題 2.1：ROC 判斷

> **問題**：X(s) = 1/((s+1)(s-2))，分別寫出三種可能的 ROC 和對應的 x(t)。

**解答**：

極點在 s = -1 和 s = 2。

部分分式：X(s) = (1/3)/(s+1) - (1/3)/(s-2)（經計算 A=1/3, B=-1/3）

先計算部分分式：
$$X(s) = \frac{1}{(s+1)(s-2)} = \frac{A}{s+1} + \frac{B}{s-2}$$
$$1 = A(s-2) + B(s+1)$$
- s=2: 1 = 3B → B = 1/3
- s=-1: 1 = -3A → A = -1/3

所以 X(s) = (-1/3)/(s+1) + (1/3)/(s-2)

**ROC 1：Re(s) > 2**（右邊信號）
$$x(t) = \left[-\frac{1}{3}e^{-t} + \frac{1}{3}e^{2t}\right]u(t)$$

**ROC 2：-1 < Re(s) < 2**（雙邊信號）
$$x(t) = -\frac{1}{3}e^{-t}u(t) - \frac{1}{3}e^{2t}u(-t)$$

**ROC 3：Re(s) < -1**（左邊信號）
$$x(t) = \left[\frac{1}{3}e^{-t} - \frac{1}{3}e^{2t}\right]u(-t)$$

> 只有 ROC 2 包含 jω 軸 → 只有這個是**穩定**的。
> 只有 ROC 1 是右邊信號 → 只有這個是**因果**的。
> **沒有同時因果且穩定的解**（因為有一個極點在右半平面 s=2）。

---

## 三、常見拉普拉斯轉換對

| x(t) | X(s) | ROC |
|-------|-------|-----|
| δ(t) | 1 | 全 s 平面 |
| u(t) | 1/s | Re(s) > 0 |
| tu(t) | 1/s² | Re(s) > 0 |
| tⁿu(t) | n!/s^(n+1) | Re(s) > 0 |
| e^(-at)u(t) | 1/(s+a) | Re(s) > -a |
| te^(-at)u(t) | 1/(s+a)² | Re(s) > -a |
| cos(ω₀t)u(t) | s/(s²+ω₀²) | Re(s) > 0 |
| sin(ω₀t)u(t) | ω₀/(s²+ω₀²) | Re(s) > 0 |
| e^(-at)cos(ω₀t)u(t) | (s+a)/[(s+a)²+ω₀²] | Re(s) > -a |
| e^(-at)sin(ω₀t)u(t) | ω₀/[(s+a)²+ω₀²] | Re(s) > -a |

---

## 四、重要性質

### 4.1 線性

$$ax_1(t) + bx_2(t) \longleftrightarrow aX_1(s) + bX_2(s)$$

ROC 至少是 ROC₁ ∩ ROC₂。

### 4.2 時移

$$x(t - t_0)u(t-t_0) \longleftrightarrow e^{-st_0} X(s)$$

（單邊拉氏，t₀ > 0）

### 4.3 s 域平移

$$e^{-at}x(t) \longleftrightarrow X(s + a)$$

> s 域平移 = 頻移 + 衰減。ROC 整體往左移 a 個單位。

### 4.4 時域微分

$$\frac{dx}{dt} \longleftrightarrow sX(s) - x(0^-)$$

$$\frac{d^2x}{dt^2} \longleftrightarrow s^2X(s) - sx(0^-) - x'(0^-)$$

> **這是拉普拉斯轉換最強大的地方！** 微分方程在 s 域變成代數方程。

### 4.5 時域積分

$$\int_{0^-}^{t} x(\tau)d\tau \longleftrightarrow \frac{X(s)}{s}$$

### 4.6 卷積

$$x(t) * h(t) \longleftrightarrow X(s) \cdot H(s)$$

### 4.7 初值定理

$$x(0^+) = \lim_{s \to \infty} sX(s)$$

條件：x(t) 在 t=0 沒有脈衝。

### 4.8 終值定理

$$\lim_{t \to \infty} x(t) = \lim_{s \to 0} sX(s)$$

條件：sX(s) 的所有極點都在左半平面（即 x(t) 確實有極限值）。

### 數值例題 4.1：初值和終值定理

> **問題**：X(s) = (3s+7)/((s+1)(s+2))，ROC: Re(s) > -1，求 x(0⁺) 和 x(∞)。

**解答**：

**初值定理**：
$$x(0^+) = \lim_{s \to \infty} s \cdot \frac{3s+7}{(s+1)(s+2)} = \lim_{s \to \infty} \frac{3s^2+7s}{s^2+3s+2} = 3$$

**終值定理**（先確認 sX(s) 的極點在左半平面：極點 s=-1, s=-2 ✓）：
$$x(\infty) = \lim_{s \to 0} s \cdot \frac{3s+7}{(s+1)(s+2)} = \frac{7}{2} = 3.5$$

**驗證**：用部分分式求 x(t)。
$$X(s) = \frac{3s+7}{(s+1)(s+2)} = \frac{A}{s+1} + \frac{B}{s+2}$$
- s = -1: 3(-1)+7 = A(1) → A = 4
- s = -2: 3(-2)+7 = B(-1) → B = -1

x(t) = (4e^(-t) - e^(-2t))u(t)

x(0⁺) = 4-1 = 3 ✓，x(∞) = 0+0 = 0 ...?

等等，讓我重新檢查。x(∞) = 4·0 - 1·0 = 0，但終值定理算出 3.5？

原因：這裡 x(t) 不含常數項，終值確實是 0。讓我重新用終值定理：

$$\lim_{s \to 0} sX(s) = \lim_{s \to 0} \frac{s(3s+7)}{(s+1)(s+2)} = \frac{0}{2} = 0$$

我之前計算有誤。

**更正**：x(0⁺) = 3，x(∞) = 0。✓

### 數值例題 4.2：微分性質解微分方程

> **問題**：求解 y''(t) + 3y'(t) + 2y(t) = δ(t)，初始條件 y(0⁻) = 0, y'(0⁻) = 0。

**解答**：

**步驟 1：取拉普拉斯轉換**

$$s^2Y(s) + 3sY(s) + 2Y(s) = 1$$

（初始條件為零，所以沒有額外項）

**步驟 2：解 Y(s)**

$$Y(s)(s^2 + 3s + 2) = 1$$

$$Y(s) = \frac{1}{s^2 + 3s + 2} = \frac{1}{(s+1)(s+2)}$$

**步驟 3：部分分式展開**

$$Y(s) = \frac{1}{s+1} - \frac{1}{s+2}$$

**步驟 4：反轉換**

$$y(t) = (e^{-t} - e^{-2t})u(t)$$

> 注意這就是系統的脈衝響應 h(t)！（因為輸入是 δ(t)、初始條件為零。）

### 數值例題 4.3：有初始條件的微分方程

> **問題**：y'(t) + 2y(t) = e^(-t)u(t)，y(0⁻) = 3。

**解答**：

**取拉氏**：
$$sY(s) - y(0^-) + 2Y(s) = \frac{1}{s+1}$$

$$sY(s) - 3 + 2Y(s) = \frac{1}{s+1}$$

$$(s+2)Y(s) = 3 + \frac{1}{s+1} = \frac{3(s+1) + 1}{s+1} = \frac{3s+4}{s+1}$$

$$Y(s) = \frac{3s+4}{(s+1)(s+2)}$$

**部分分式**：
$$\frac{3s+4}{(s+1)(s+2)} = \frac{A}{s+1} + \frac{B}{s+2}$$
- s = -1: 3(-1)+4 = A(1) → A = 1
- s = -2: 3(-2)+4 = B(-1) → B = -2... 讓我重算
- s = -2: -6+4 = B(-2+1) = B(-1) → -2 = -B → B = 2

$$Y(s) = \frac{1}{s+1} + \frac{2}{s+2}$$

$$y(t) = (e^{-t} + 2e^{-2t})u(t)$$

**驗證**：y(0⁺) = 1 + 2 = 3 ✓

---

## 五、轉移函數 H(s) 與系統分析

### 5.1 定義

$$H(s) = \frac{Y(s)}{X(s)} \bigg|_{\text{零初始條件}}$$

對一個以微分方程描述的系統：

$$a_n \frac{d^n y}{dt^n} + \cdots + a_1 \frac{dy}{dt} + a_0 y = b_m \frac{d^m x}{dt^m} + \cdots + b_1 \frac{dx}{dt} + b_0 x$$

轉移函數為：

$$H(s) = \frac{b_m s^m + \cdots + b_1 s + b_0}{a_n s^n + \cdots + a_1 s + a_0}$$

### 5.2 與脈衝響應的關係

$$H(s) = \mathcal{L}\{h(t)\}$$

轉移函數就是脈衝響應的拉普拉斯轉換。

### 5.3 與頻率響應的關係

$$H(j\omega) = H(s)\big|_{s=j\omega}$$

把 s = jω 代入轉移函數就得到頻率響應（前提是 ROC 包含 jω 軸）。

---

## 六、極零圖（Pole-Zero Plot）

### 6.1 定義

將 H(s) 寫成：

$$H(s) = K \cdot \frac{(s-z_1)(s-z_2)\cdots(s-z_m)}{(s-p_1)(s-p_2)\cdots(s-p_n)}$$

- z₁, z₂, ..., zₘ：**零點**（在 s 平面上用 ○ 表示）
- p₁, p₂, ..., pₙ：**極點**（在 s 平面上用 × 表示）

### 6.2 極零圖告訴我們什麼？

| 極點位置 | 系統行為 |
|----------|----------|
| 左半平面（σ < 0）| 衰減模態 → 穩定 |
| 右半平面（σ > 0）| 增長模態 → 不穩定 |
| jω 軸上（σ = 0）| 等幅振盪 → 邊界穩定 |
| 實軸上 | 純指數衰減/增長 |
| 共軛複數對 | 振盪型衰減/增長 |

### 數值例題 6.1：極零圖分析

> **問題**：H(s) = (s+3)/((s+1)(s²+2s+5))，畫極零圖並判斷穩定性。

**解答**：

**零點**：s = -3 → ○ 在實軸 -3

**極點**：
- s+1 = 0 → s = -1 → × 在實軸 -1
- s²+2s+5 = 0 → s = (-2±√(4-20))/2 = -1±j2 → × 在 -1±j2

所有極點實部為負（在左半平面）→ **系統穩定** ✓

脈衝響應會包含 e^(-t) 和 e^(-t)cos(2t)、e^(-t)sin(2t) 的組合，都是衰減的。

---

## 七、系統串聯 / 並聯 / 回授

### 7.1 串聯

$$H(s) = H_1(s) \cdot H_2(s)$$

### 7.2 並聯

$$H(s) = H_1(s) + H_2(s)$$

### 7.3 負回授（Negative Feedback）

```
X(s) →(+)→ [H₁(s)] → Y(s)
       ↑(-)         |
       └── [H₂(s)] ←┘
```

$$H(s) = \frac{H_1(s)}{1 + H_1(s)H_2(s)}$$

### 數值例題 7.1：回授系統

> **問題**：前向路徑 H₁(s) = 10/(s+1)，回授路徑 H₂(s) = 1（單位回授）。求閉迴路轉移函數和穩定性。

**解答**：

$$H(s) = \frac{H_1(s)}{1+H_1(s)} = \frac{10/(s+1)}{1+10/(s+1)} = \frac{10}{s+1+10} = \frac{10}{s+11}$$

極點在 s = -11（左半平面）→ **穩定** ✓

> 開迴路極點 s = -1，閉迴路極點 s = -11。回授讓極點往左移，系統更穩定、響應更快。

---

## 八、題型鑑別

| 看到什麼 | 用什麼方法 |
|----------|-----------|
| 「求 X(s) 和 ROC」 | 定義積分或查轉換對表 |
| 「求反拉氏轉換 x(t)」 | 部分分式 → 查表，注意 ROC 決定方向 |
| 「解微分方程 (零初始條件)」 | 取拉氏 → 代數解 Y(s) → 反轉換 |
| 「解微分方程 (非零初始條件)」 | 用單邊拉氏，微分性質帶入初值 |
| 「求 H(s)」 | Y(s)/X(s) 或由微分方程讀出 |
| 「判斷穩定性」 | 看極點是否都在左半平面 |
| 「求 x(0⁺) 或 x(∞)」 | 初值/終值定理 |
| 「極零圖 → 系統行為」 | 左半面極點→穩定，虛軸→振盪 |
| 「回授系統」 | H = H₁/(1+H₁H₂) |

---

## ✅ 自我檢測

### 問題 1
e^(3t)u(t) 的拉普拉斯轉換和 ROC 是什麼？

<details>
<summary>點擊查看答案</summary>

$$X(s) = \frac{1}{s-3}, \quad \text{ROC: } \text{Re}(s) > 3$$

注意：這個信號的傅立葉轉換不存在（因為 ROC 不包含 jω 軸），但拉普拉斯轉換存在！

</details>

### 問題 2
H(s) = (s+5)/((s+2)(s+3))，系統是否因果且穩定？求 h(t)。

<details>
<summary>點擊查看答案</summary>

因果 → ROC 在最右極點右邊 → Re(s) > -2。
此 ROC 包含 jω 軸 → **穩定** ✓。

部分分式：
$$\frac{s+5}{(s+2)(s+3)} = \frac{A}{s+2} + \frac{B}{s+3}$$
- s=-2: 3 = A(1) → A = 3
- s=-3: 2 = B(-1) → B = -2

$$h(t) = (3e^{-2t} - 2e^{-3t})u(t)$$

驗證：h(0⁺) = 3-2 = 1，由初值定理 lim_{s→∞} s·(s+5)/((s+2)(s+3)) = 1 ✓

</details>

### 問題 3
利用拉氏轉換解：y'(t) + 5y(t) = 10u(t)，y(0⁻) = 2。

<details>
<summary>點擊查看答案</summary>

取拉氏：sY(s) - 2 + 5Y(s) = 10/s

(s+5)Y(s) = 2 + 10/s = (2s+10)/s

$$Y(s) = \frac{2s+10}{s(s+5)} = \frac{2(s+5)}{s(s+5)} = \frac{2}{s}$$

$$y(t) = 2u(t)$$

有趣！因為初始值 y(0) = 2 恰好等於穩態值 10/5 = 2，所以沒有暫態項。

</details>

### 問題 4
H(s) = 1/(s²+s+1) 的極點位置在哪？系統穩定嗎？脈衝響應是什麼形式？

<details>
<summary>點擊查看答案</summary>

極點：s = (-1±√(1-4))/2 = -1/2 ± j√3/2

極點實部 = -1/2 < 0 → **穩定** ✓

脈衝響應形式：e^(-t/2) 乘以頻率 √3/2 的正弦振盪。

$$h(t) = \frac{2}{\sqrt{3}} e^{-t/2} \sin\left(\frac{\sqrt{3}}{2}t\right) u(t)$$

</details>

### 問題 5
為什麼終值定理不能用在 H(s) = 1/(s-1) 對應的脈衝響應上？

<details>
<summary>點擊查看答案</summary>

h(t) = e^(t)u(t)（假設因果），當 t→∞ 時 h(t)→∞，根本沒有極限值。

終值定理的使用條件是 sX(s) 的所有極點都在左半平面（即 x(t) 確實收斂到一個有限值）。

sH(s) = s/(s-1) 的極點在 s=1（右半平面），不滿足條件。

如果硬套終值定理：lim_{s→0} s·1/(s-1) = 0/(-1) = 0，但 h(∞) = ∞，結果完全錯誤。

**教訓：使用終值定理前一定要先檢查條件！**

</details>

---

> **下一章預告**：拉普拉斯轉換處理的是連續時間系統。對於離散時間系統，我們需要它的「離散版本」——**Z 轉換**。
